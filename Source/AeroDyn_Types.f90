!STARTOFREGISTRYGENERATEDFILE './AeroDyn_Types.f90'

! WARNING This file is generated automatically by the FAST registry
! Do not edit.  Your changes to this file will be lost.
!
!*********************************************************************************************************************************
! AeroDyn_Types
!.................................................................................................................................
! This file is part of AeroDyn.
!
! Copyright (C) 2012, 2013 National Renewable Energy Laboratory
!
! Licensed under the Apache License, Version 2.0 (the "License");
! you may not use this file except in compliance with the License.
! You may obtain a copy of the License at
!
!     http://www.apache.org/licenses/LICENSE-2.0
!
! Unless required by applicable law or agreed to in writing, software
! distributed under the License is distributed on an "AS IS" BASIS,
! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
! See the License for the specific language governing permissions and
! limitations under the License.
!
!
! W A R N I N G : This file was automatically generated from the FAST registry.  Changes made to this file may be lost.
!
!*********************************************************************************************************************************
MODULE AeroDyn_Types
! This module contains all of the user-defined types needed in AeroDyn. It also contains copy, destroy, pack, and
! unpack routines associated with each defined data type. This code will be generated by the FAST Registry.
!---------------------------------------------------------------------------------------------------------------------------------
USE IfW_FFWind_Types
USE IfW_HHWind_Types
USE InflowWind_Types
USE NWTC_Library
IMPLICIT NONE
! =========  Marker  =======
  TYPE, PUBLIC :: Marker
    REAL(ReKi) , DIMENSION(1:3)  :: Position 
    REAL(ReKi) , DIMENSION(1:3,1:3)  :: Orientation 
    REAL(ReKi) , DIMENSION(1:3)  :: TranslationVel 
    REAL(ReKi) , DIMENSION(1:3)  :: RotationVel 
  END TYPE Marker
! =======================
! =========  AeroConfig  =======
  TYPE, PUBLIC :: AeroConfig
    TYPE(Marker) , DIMENSION(:), ALLOCATABLE  :: Blade 
    TYPE(Marker)  :: Hub 
    TYPE(Marker)  :: RotorFurl 
    TYPE(Marker)  :: Nacelle 
    TYPE(Marker)  :: TailFin 
    TYPE(Marker)  :: Tower 
    TYPE(Marker)  :: SubStructure 
    TYPE(Marker)  :: Foundation 
    REAL(ReKi)  :: BladeLength 
  END TYPE AeroConfig
! =======================
! =========  AirFoil  =======
  TYPE, PUBLIC :: AirFoil
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CD 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CL 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: CM 
    REAL(ReKi)  :: PMC 
    REAL(ReKi)  :: MulTabLoc 
  END TYPE AirFoil
! =======================
! =========  AirFoilParms  =======
  TYPE, PUBLIC :: AirFoilParms
    INTEGER(IntKi)  :: MaxTable = 20 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NTables 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NLift 
    INTEGER(IntKi)  :: NumCL 
    INTEGER(IntKi)  :: NumFoil 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NFoil 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MulTabMet 
    CHARACTER(1024) , DIMENSION(:), ALLOCATABLE  :: FoilNm 
  END TYPE AirFoilParms
! =======================
! =========  Beddoes  =======
  TYPE, PUBLIC :: Beddoes
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ADOT 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ADOT1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AFE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AFE1 
    REAL(ReKi)  :: AN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ANE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ANE1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AOD 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AOL 
    LOGICAL , DIMENSION(:,:), ALLOCATABLE  :: BEDSEP 
    LOGICAL , DIMENSION(:,:), ALLOCATABLE  :: OLDSEP 
    REAL(ReKi)  :: CC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CDO 
    REAL(ReKi)  :: CMI 
    REAL(ReKi)  :: CMQ 
    REAL(ReKi)  :: CN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNA 
    REAL(ReKi)  :: CNCP 
    REAL(ReKi)  :: CNIQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNP1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPD 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPD1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPOT 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNPOT1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNSL 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CNV 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CVN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: CVN1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFAFE 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFAFE1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DFC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DPP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: DQP1 
    REAL(ReKi)  :: DS 
    REAL(ReKi)  :: FK 
    REAL(ReKi)  :: FP 
    REAL(ReKi)  :: FPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSP1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSPC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: FSPC1 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FTB 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: FTBC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDCNV 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDF 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDFC 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDPP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDDQ 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDTAU 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDXN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLDYN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: QX 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: QX1 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TAU 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: XN 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: YN 
    LOGICAL  :: SHIFT 
    LOGICAL  :: VOR 
  END TYPE Beddoes
! =======================
! =========  BeddoesParms  =======
  TYPE, PUBLIC :: BeddoesParms
    REAL(ReKi)  :: AS 
    REAL(ReKi)  :: TF 
    REAL(ReKi)  :: TP 
    REAL(ReKi)  :: TV 
    REAL(ReKi)  :: TVL 
  END TYPE BeddoesParms
! =======================
! =========  BladeParms  =======
  TYPE, PUBLIC :: BladeParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: C 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DR 
    REAL(ReKi)  :: R 
    REAL(ReKi)  :: BladeLength 
    INTEGER(IntKi)  :: NB 
  END TYPE BladeParms
! =======================
! =========  DynInflow  =======
  TYPE, PUBLIC :: DynInflow
    REAL(ReKi) , DIMENSION(1:6,1:4)  :: dAlph_dt 
    REAL(ReKi) , DIMENSION(3:6,1:4)  :: dBeta_dt 
    REAL(ReKi)  :: DTO 
    REAL(ReKi) , DIMENSION(1:6)  :: old_Alph 
    REAL(ReKi) , DIMENSION(3:6)  :: old_Beta 
    REAL(ReKi)  :: old_LmdM 
    REAL(ReKi)  :: oldKai 
    REAL(ReKi) , DIMENSION(1:6)  :: PhiLqC 
    REAL(ReKi) , DIMENSION(3:6)  :: PhiLqS 
    REAL(ReKi)  :: Pzero 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: RMC_SAVE 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: RMS_SAVE 
    REAL(ReKi)  :: TipSpeed 
    REAL(ReKi)  :: totalInf 
    REAL(ReKi)  :: Vparam 
    REAL(ReKi)  :: Vtotal 
    REAL(ReKi) , DIMENSION(1:6)  :: xAlpha 
    REAL(ReKi) , DIMENSION(3:6)  :: xBeta 
    REAL(ReKi)  :: xKai 
    REAL(ReKi)  :: XLAMBDA_M 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: xLcos 
    REAL(ReKi) , DIMENSION(3:6,3:6)  :: xLsin 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MminR 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MminusR 
    INTEGER(IntKi) , DIMENSION(1:6,1:6)  :: MplusR 
    REAL(ReKi) , DIMENSION(1:6,1:6)  :: GAMMA 
  END TYPE DynInflow
! =======================
! =========  DynInflowParms  =======
  TYPE, PUBLIC :: DynInflowParms
    INTEGER(IntKi)  :: MAXINFLO = 2 
    REAL(ReKi) , DIMENSION(1:6)  :: xMinv 
  END TYPE DynInflowParms
! =======================
! =========  Element  =======
  TYPE, PUBLIC :: Element
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: A 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: AP 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: ALPHA 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: W2 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLD_A_NS 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: OLD_AP_NS 
    REAL(ReKi)  :: PITNOW 
  END TYPE Element
! =======================
! =========  ElementParms  =======
  TYPE, PUBLIC :: ElementParms
    INTEGER(IntKi)  :: NELM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TWIST 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: RELM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: HLCNST 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TLCNST 
  END TYPE ElementParms
! =======================
! =========  ElOutParms  =======
  TYPE, PUBLIC :: ElOutParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AAA 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: AAP 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: ALF 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CDD 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CLL 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CMM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CNN 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: CTT 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DFNSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DFTSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: DynPres 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PMM 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: PITSAV 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: ReyNum 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVX 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVY 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: SaveVZ 
    REAL(ReKi)  :: VXSAV 
    REAL(ReKi)  :: VYSAV 
    REAL(ReKi)  :: VZSAV 
    INTEGER(IntKi)  :: NumWndElOut 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: WndElPrList 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: WndElPrNum 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrList 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrNum 
    INTEGER(IntKi)  :: NumElOut 
  END TYPE ElOutParms
! =======================
! =========  InducedVel  =======
  TYPE, PUBLIC :: InducedVel
    REAL(ReKi)  :: SumInFl = 0 
  END TYPE InducedVel
! =======================
! =========  InducedVelParms  =======
  TYPE, PUBLIC :: InducedVelParms
    REAL(ReKi)  :: AToler 
    REAL(ReKi)  :: EqAIDmult 
    LOGICAL  :: EquilDA 
    LOGICAL  :: EquilDT 
    LOGICAL  :: TLoss 
    LOGICAL  :: GTech 
    LOGICAL  :: HLoss 
  END TYPE InducedVelParms
! =======================
! =========  Rotor  =======
  TYPE, PUBLIC :: Rotor
    REAL(ReKi)  :: AVGINFL 
    REAL(ReKi)  :: CTILT 
    REAL(ReKi)  :: CYaw 
    REAL(ReKi)  :: REVS 
    REAL(ReKi)  :: STILT 
    REAL(ReKi)  :: SYaw 
    REAL(ReKi)  :: TILT 
    REAL(ReKi)  :: YawAng 
    REAL(ReKi)  :: YawVEL 
  END TYPE Rotor
! =======================
! =========  RotorParms  =======
  TYPE, PUBLIC :: RotorParms
    REAL(ReKi)  :: HH 
  END TYPE RotorParms
! =======================
! =========  TwrPropsParms  =======
  TYPE, PUBLIC :: TwrPropsParms
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrHtFr 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrWid 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TwrCD 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrRe 
    REAL(ReKi) , DIMENSION(1:3)  :: VTwr 
    REAL(ReKi)  :: Tower_Wake_Constant 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: NTwrCDCol 
    INTEGER(IntKi)  :: NTwrHT 
    INTEGER(IntKi)  :: NTwrRe 
    INTEGER(IntKi)  :: NTwrCD 
    LOGICAL  :: TwrPotent 
    LOGICAL  :: TwrShadow 
    REAL(ReKi)  :: ShadHWid 
    REAL(ReKi)  :: TShadC1 
    REAL(ReKi)  :: TShadC2 
    REAL(ReKi)  :: TwrShad 
    LOGICAL  :: PJM_Version 
    CHARACTER(1024)  :: TwrFile 
    REAL(ReKi)  :: T_Shad_Refpt 
    LOGICAL  :: CalcTwrAero 
    INTEGER(IntKi)  :: NumTwrNodes 
    REAL(ReKi) , DIMENSION(:), ALLOCATABLE  :: TwrNodeWidth 
  END TYPE TwrPropsParms
! =======================
! =========  Wind  =======
  TYPE, PUBLIC :: Wind
    REAL(ReKi)  :: ANGFLW 
    REAL(ReKi)  :: CDEL 
    REAL(ReKi)  :: VROTORX 
    REAL(ReKi)  :: VROTORY 
    REAL(ReKi)  :: VROTORZ 
    REAL(ReKi)  :: SDEL 
  END TYPE Wind
! =======================
! =========  WindParms  =======
  TYPE, PUBLIC :: WindParms
    REAL(ReKi)  :: Rho 
    REAL(ReKi)  :: KinVisc 
  END TYPE WindParms
! =======================
! =========  PositionType  =======
  TYPE, PUBLIC :: PositionType
    REAL(ReKi) , DIMENSION(1:3)  :: Pos 
  END TYPE PositionType
! =======================
! =========  OrientationType  =======
  TYPE, PUBLIC :: OrientationType
    REAL(ReKi) , DIMENSION(1:3,1:3)  :: Orient 
  END TYPE OrientationType
! =======================
! =========  AD_InitInputType  =======
  TYPE, PUBLIC :: AD_InitInputType
    CHARACTER(1024)  :: Title 
    CHARACTER(1024)  :: OutRootName 
    CHARACTER(1024)  :: ADFileName 
    CHARACTER(1024)  :: WindFileName 
    LOGICAL  :: WrSumFile 
    INTEGER(IntKi)  :: NumBl 
    REAL(ReKi)  :: BladeLength 
    LOGICAL  :: LinearizeFlag 
    TYPE(AeroConfig)  :: TurbineComponents 
    INTEGER(IntKi)  :: NumTwrNodes 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: TwrNodeLocs 
    TYPE(IfW_InitInputType)  :: IfW_InitInputs 
  END TYPE AD_InitInputType
! =======================
! =========  AD_InitOutputType  =======
  TYPE, PUBLIC :: AD_InitOutputType
    TYPE(ProgDesc)  :: Ver 
    TYPE(IfW_InitOutputType)  :: IfW_InitOutput 
  END TYPE AD_InitOutputType
! =======================
! =========  AD_ContinuousStateType  =======
  TYPE, PUBLIC :: AD_ContinuousStateType
    REAL(ReKi)  :: DummyDiscState 
    TYPE(IfW_ContinuousStateType)  :: IfW_ContStates 
  END TYPE AD_ContinuousStateType
! =======================
! =========  AD_DiscreteStateType  =======
  TYPE, PUBLIC :: AD_DiscreteStateType
    REAL(ReKi)  :: DummyDiscState 
    TYPE(IfW_DiscreteStateType)  :: IfW_DiscStates 
  END TYPE AD_DiscreteStateType
! =======================
! =========  AD_ConstraintStateType  =======
  TYPE, PUBLIC :: AD_ConstraintStateType
    REAL(ReKi)  :: DummyConstrState 
    TYPE(IfW_ConstraintStateType)  :: IfW_ConstrStates 
  END TYPE AD_ConstraintStateType
! =======================
! =========  AD_OtherStateType  =======
  TYPE, PUBLIC :: AD_OtherStateType
    INTEGER(IntKi)  :: DummyOtherState 
    REAL(DbKi)  :: DT 
    INTEGER(IntKi) , DIMENSION(:), ALLOCATABLE  :: ElPrNum 
    REAL(DbKi)  :: Time 
    REAL(DbKi)  :: OldTime 
    REAL(ReKi)  :: HubLoss = 1 
    REAL(ReKi)  :: Loss = 1 
    REAL(ReKi)  :: TipLoss = 1 
    REAL(ReKi)  :: TLpt7 
    LOGICAL  :: FirstPassGTL = .TRUE. 
    LOGICAL  :: SuperSonic = .FALSE. 
    LOGICAL  :: AFLAGVinderr = .FALSE. 
    LOGICAL  :: AFLAGTwrInflu = .FALSE. 
    LOGICAL  :: OnePassDynDbg = .TRUE. 
    LOGICAL  :: NoLoadsCalculated = .TRUE. 
    INTEGER(IntKi)  :: NERRORS = 0 
    TYPE(IfW_OtherStateType)  :: IfW_OtherStates 
    TYPE(AirFoil)  :: AirFoil 
    TYPE(Beddoes)  :: Beddoes 
    TYPE(DynInflow)  :: DynInflow 
    TYPE(Element)  :: Element 
    TYPE(Rotor)  :: Rotor 
    TYPE(Wind)  :: Wind 
    TYPE(InducedVel)  :: InducedVel 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: StoredForces 
    REAL(ReKi) , DIMENSION(:,:,:), ALLOCATABLE  :: StoredMoments 
    LOGICAL  :: FirstWarn 
    TYPE(ElOutParms)  :: ElOut 
    LOGICAL  :: Skew 
    LOGICAL  :: DynInit 
  END TYPE AD_OtherStateType
! =======================
! =========  AD_ParameterType  =======
  TYPE, PUBLIC :: AD_ParameterType
    CHARACTER(1024)  :: Title 
    CHARACTER(1024)  :: WindFileName 
    LOGICAL  :: SIUnit 
    LOGICAL  :: Echo = .FALSE. 
    LOGICAL  :: MultiTab 
    LOGICAL  :: LinearizeFlag 
    LOGICAL  :: OutputPlottingInfo = .FALSE. 
    LOGICAL  :: Initialized = .FALSE. 
    REAL(ReKi)  :: TwoPiNB 
    INTEGER(IntKi)  :: NumBl 
    INTEGER(IntKi)  :: NBlInpSt 
    LOGICAL  :: ElemPrn 
    LOGICAL  :: DStall 
    LOGICAL  :: PMoment 
    LOGICAL  :: Reynolds 
    LOGICAL  :: DynInfl 
    LOGICAL  :: Wake 
    LOGICAL  :: Swirl 
    REAL(DbKi)  :: DtAero 
    REAL(ReKi)  :: HubRad 
    INTEGER(IntKi)  :: UnEc = 19 
    INTEGER(IntKi)  :: UnElem = -1 
    INTEGER(IntKi)  :: UnADPlt = 70 
    INTEGER(IntKi)  :: UnADin = 90 
    INTEGER(IntKi)  :: UnWind = 91 
    INTEGER(IntKi)  :: UnADopt = 92 
    INTEGER(IntKi)  :: UnAirfl = 93 
    INTEGER(IntKi)  :: UnWndOut = -1 
    INTEGER(IntKi)  :: MAXICOUNT = 1000 
    LOGICAL  :: WrOptFile = .TRUE. 
    INTEGER(IntKi)  :: DEFAULT_Wind = -1 
    TYPE(AirFoilParms)  :: AirFoil 
    TYPE(BladeParms)  :: Blade 
    TYPE(BeddoesParms)  :: Beddoes 
    TYPE(DynInflowParms)  :: DynInflow 
    TYPE(ElementParms)  :: Element 
    TYPE(TwrPropsParms)  :: TwrProps 
    TYPE(InducedVelParms)  :: InducedVel 
    TYPE(WindParms)  :: Wind 
    TYPE(RotorParms)  :: Rotor 
    TYPE(IfW_ParameterType)  :: IfW_Params 
  END TYPE AD_ParameterType
! =======================
! =========  AD_InputType  =======
  TYPE, PUBLIC :: AD_InputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: InputMarkers 
    TYPE(MeshType)  :: Twr_InputMarkers 
    TYPE(AeroConfig)  :: TurbineComponents 
    TYPE(IfW_InputType)  :: IfW_Inputs 
    REAL(ReKi) , DIMENSION(:,:), ALLOCATABLE  :: MulTabLoc 
  END TYPE AD_InputType
! =======================
! =========  AD_OutputType  =======
  TYPE, PUBLIC :: AD_OutputType
    TYPE(MeshType) , DIMENSION(:), ALLOCATABLE  :: OutputLoads 
    TYPE(MeshType)  :: Twr_OutputLoads 
    TYPE(IfW_OutputType)  :: IfW_Outputs 
  END TYPE AD_OutputType
! =======================
CONTAINS
 SUBROUTINE AD_Copymarker( SrcmarkerData, DstmarkerData, CtrlCode, ErrStat, ErrMsg )
   TYPE(marker), INTENT(INOUT) :: SrcmarkerData
   TYPE(marker), INTENT(INOUT) :: DstmarkerData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstmarkerData%Position = SrcmarkerData%Position
   DstmarkerData%Orientation = SrcmarkerData%Orientation
   DstmarkerData%TranslationVel = SrcmarkerData%TranslationVel
   DstmarkerData%RotationVel = SrcmarkerData%RotationVel
 END SUBROUTINE AD_Copymarker

 SUBROUTINE AD_Destroymarker( markerData, ErrStat, ErrMsg )
  TYPE(marker), INTENT(INOUT) :: markerData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroymarker

 SUBROUTINE AD_Packmarker( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(marker),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Position )  ! Position 
  Re_BufSz    = Re_BufSz    + SIZE( InData%Orientation )  ! Orientation 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TranslationVel )  ! TranslationVel 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RotationVel )  ! RotationVel 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Position))-1 ) =  PACK(InData%Position ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Position)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Orientation))-1 ) =  PACK(InData%Orientation ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Orientation)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TranslationVel))-1 ) =  PACK(InData%TranslationVel ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%TranslationVel)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RotationVel))-1 ) =  PACK(InData%RotationVel ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%RotationVel)
 END SUBROUTINE AD_Packmarker

 SUBROUTINE AD_UnPackmarker( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(marker), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%Position,1))); mask1 = .TRUE.
  OutData%Position = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Position))-1 ),mask1,OutData%Position)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Position)
  ALLOCATE(mask2(SIZE(OutData%Orientation,1),SIZE(OutData%Orientation,2))); mask2 = .TRUE.
  OutData%Orientation = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Orientation))-1 ),mask2,OutData%Orientation)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Orientation)
  ALLOCATE(mask1(SIZE(OutData%TranslationVel,1))); mask1 = .TRUE.
  OutData%TranslationVel = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TranslationVel))-1 ),mask1,OutData%TranslationVel)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%TranslationVel)
  ALLOCATE(mask1(SIZE(OutData%RotationVel,1))); mask1 = .TRUE.
  OutData%RotationVel = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RotationVel))-1 ),mask1,OutData%RotationVel)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%RotationVel)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackmarker

 SUBROUTINE AD_Copyaeroconfig( SrcaeroconfigData, DstaeroconfigData, CtrlCode, ErrStat, ErrMsg )
   TYPE(aeroconfig), INTENT(INOUT) :: SrcaeroconfigData
   TYPE(aeroconfig), INTENT(INOUT) :: DstaeroconfigData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcaeroconfigData%Blade)) THEN
   i1_l = LBOUND(SrcaeroconfigData%Blade,1)
   i1_u = UBOUND(SrcaeroconfigData%Blade,1)
   IF (.NOT.ALLOCATED(DstaeroconfigData%Blade)) THEN 
      ALLOCATE(DstaeroconfigData%Blade(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyaeroconfig: Error allocating DstaeroconfigData%Blade.'
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcaeroconfigData%Blade,1), UBOUND(SrcaeroconfigData%Blade,1)
      CALL AD_Copymarker( SrcaeroconfigData%Blade(i1), DstaeroconfigData%Blade(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
ENDIF
      CALL AD_Copymarker( SrcaeroconfigData%Hub, DstaeroconfigData%Hub, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copymarker( SrcaeroconfigData%RotorFurl, DstaeroconfigData%RotorFurl, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copymarker( SrcaeroconfigData%Nacelle, DstaeroconfigData%Nacelle, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copymarker( SrcaeroconfigData%TailFin, DstaeroconfigData%TailFin, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copymarker( SrcaeroconfigData%Tower, DstaeroconfigData%Tower, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copymarker( SrcaeroconfigData%SubStructure, DstaeroconfigData%SubStructure, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copymarker( SrcaeroconfigData%Foundation, DstaeroconfigData%Foundation, CtrlCode, ErrStat, ErrMsg )
   DstaeroconfigData%BladeLength = SrcaeroconfigData%BladeLength
 END SUBROUTINE AD_Copyaeroconfig

 SUBROUTINE AD_Destroyaeroconfig( aeroconfigData, ErrStat, ErrMsg )
  TYPE(aeroconfig), INTENT(INOUT) :: aeroconfigData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(aeroconfigData%Blade)) THEN
DO i1 = LBOUND(aeroconfigData%Blade,1), UBOUND(aeroconfigData%Blade,1)
  CALL AD_Destroymarker( aeroconfigData%Blade(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(aeroconfigData%Blade)
ENDIF
  CALL AD_Destroymarker( aeroconfigData%Hub, ErrStat, ErrMsg )
  CALL AD_Destroymarker( aeroconfigData%RotorFurl, ErrStat, ErrMsg )
  CALL AD_Destroymarker( aeroconfigData%Nacelle, ErrStat, ErrMsg )
  CALL AD_Destroymarker( aeroconfigData%TailFin, ErrStat, ErrMsg )
  CALL AD_Destroymarker( aeroconfigData%Tower, ErrStat, ErrMsg )
  CALL AD_Destroymarker( aeroconfigData%SubStructure, ErrStat, ErrMsg )
  CALL AD_Destroymarker( aeroconfigData%Foundation, ErrStat, ErrMsg )
 END SUBROUTINE AD_Destroyaeroconfig

 SUBROUTINE AD_Packaeroconfig( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(aeroconfig),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Hub_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Hub_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Hub_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_RotorFurl_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_RotorFurl_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_RotorFurl_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Nacelle_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Nacelle_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Nacelle_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TailFin_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TailFin_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TailFin_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Tower_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Tower_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Tower_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_SubStructure_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_SubStructure_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_SubStructure_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Foundation_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Foundation_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Foundation_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%Blade,1), UBOUND(InData%Blade,1)
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade(i1), ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Db_Blade_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Int_Blade_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Blade_Buf ) ! Blade
  IF(ALLOCATED(Re_Blade_Buf))  DEALLOCATE(Re_Blade_Buf)
  IF(ALLOCATED(Db_Blade_Buf))  DEALLOCATE(Db_Blade_Buf)
  IF(ALLOCATED(Int_Blade_Buf)) DEALLOCATE(Int_Blade_Buf)
ENDDO
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, InData%Hub, ErrStat, ErrMsg, .TRUE. ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Hub_Buf  ) ! Hub
  IF(ALLOCATED(Db_Hub_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Hub_Buf  ) ! Hub
  IF(ALLOCATED(Int_Hub_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Hub_Buf ) ! Hub
  IF(ALLOCATED(Re_Hub_Buf))  DEALLOCATE(Re_Hub_Buf)
  IF(ALLOCATED(Db_Hub_Buf))  DEALLOCATE(Db_Hub_Buf)
  IF(ALLOCATED(Int_Hub_Buf)) DEALLOCATE(Int_Hub_Buf)
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, InData%RotorFurl, ErrStat, ErrMsg, .TRUE. ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_RotorFurl_Buf  ) ! RotorFurl
  IF(ALLOCATED(Db_RotorFurl_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_RotorFurl_Buf  ) ! RotorFurl
  IF(ALLOCATED(Int_RotorFurl_Buf))Int_BufSz = Int_BufSz + SIZE( Int_RotorFurl_Buf ) ! RotorFurl
  IF(ALLOCATED(Re_RotorFurl_Buf))  DEALLOCATE(Re_RotorFurl_Buf)
  IF(ALLOCATED(Db_RotorFurl_Buf))  DEALLOCATE(Db_RotorFurl_Buf)
  IF(ALLOCATED(Int_RotorFurl_Buf)) DEALLOCATE(Int_RotorFurl_Buf)
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, InData%Nacelle, ErrStat, ErrMsg, .TRUE. ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Nacelle_Buf  ) ! Nacelle
  IF(ALLOCATED(Db_Nacelle_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Nacelle_Buf  ) ! Nacelle
  IF(ALLOCATED(Int_Nacelle_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Nacelle_Buf ) ! Nacelle
  IF(ALLOCATED(Re_Nacelle_Buf))  DEALLOCATE(Re_Nacelle_Buf)
  IF(ALLOCATED(Db_Nacelle_Buf))  DEALLOCATE(Db_Nacelle_Buf)
  IF(ALLOCATED(Int_Nacelle_Buf)) DEALLOCATE(Int_Nacelle_Buf)
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, InData%TailFin, ErrStat, ErrMsg, .TRUE. ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TailFin_Buf  ) ! TailFin
  IF(ALLOCATED(Db_TailFin_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TailFin_Buf  ) ! TailFin
  IF(ALLOCATED(Int_TailFin_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TailFin_Buf ) ! TailFin
  IF(ALLOCATED(Re_TailFin_Buf))  DEALLOCATE(Re_TailFin_Buf)
  IF(ALLOCATED(Db_TailFin_Buf))  DEALLOCATE(Db_TailFin_Buf)
  IF(ALLOCATED(Int_TailFin_Buf)) DEALLOCATE(Int_TailFin_Buf)
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, InData%Tower, ErrStat, ErrMsg, .TRUE. ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Tower_Buf  ) ! Tower
  IF(ALLOCATED(Db_Tower_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Tower_Buf  ) ! Tower
  IF(ALLOCATED(Int_Tower_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Tower_Buf ) ! Tower
  IF(ALLOCATED(Re_Tower_Buf))  DEALLOCATE(Re_Tower_Buf)
  IF(ALLOCATED(Db_Tower_Buf))  DEALLOCATE(Db_Tower_Buf)
  IF(ALLOCATED(Int_Tower_Buf)) DEALLOCATE(Int_Tower_Buf)
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, InData%SubStructure, ErrStat, ErrMsg, .TRUE. ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_SubStructure_Buf  ) ! SubStructure
  IF(ALLOCATED(Db_SubStructure_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_SubStructure_Buf  ) ! SubStructure
  IF(ALLOCATED(Int_SubStructure_Buf))Int_BufSz = Int_BufSz + SIZE( Int_SubStructure_Buf ) ! SubStructure
  IF(ALLOCATED(Re_SubStructure_Buf))  DEALLOCATE(Re_SubStructure_Buf)
  IF(ALLOCATED(Db_SubStructure_Buf))  DEALLOCATE(Db_SubStructure_Buf)
  IF(ALLOCATED(Int_SubStructure_Buf)) DEALLOCATE(Int_SubStructure_Buf)
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, InData%Foundation, ErrStat, ErrMsg, .TRUE. ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Foundation_Buf  ) ! Foundation
  IF(ALLOCATED(Db_Foundation_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Foundation_Buf  ) ! Foundation
  IF(ALLOCATED(Int_Foundation_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Foundation_Buf ) ! Foundation
  IF(ALLOCATED(Re_Foundation_Buf))  DEALLOCATE(Re_Foundation_Buf)
  IF(ALLOCATED(Db_Foundation_Buf))  DEALLOCATE(Db_Foundation_Buf)
  IF(ALLOCATED(Int_Foundation_Buf)) DEALLOCATE(Int_Foundation_Buf)
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%Blade,1), UBOUND(InData%Blade,1)
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade(i1), ErrStat, ErrMsg, OnlySize ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 ) = Re_Blade_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 ) = Db_Blade_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 ) = Int_Blade_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  IF( ALLOCATED(Re_Blade_Buf) )  DEALLOCATE(Re_Blade_Buf)
  IF( ALLOCATED(Db_Blade_Buf) )  DEALLOCATE(Db_Blade_Buf)
  IF( ALLOCATED(Int_Blade_Buf) ) DEALLOCATE(Int_Blade_Buf)
ENDDO
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, InData%Hub, ErrStat, ErrMsg, OnlySize ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Hub_Buf)-1 ) = Re_Hub_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Db_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Hub_Buf)-1 ) = Db_Hub_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Int_Hub_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Hub_Buf)-1 ) = Int_Hub_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Hub_Buf)
  ENDIF
  IF( ALLOCATED(Re_Hub_Buf) )  DEALLOCATE(Re_Hub_Buf)
  IF( ALLOCATED(Db_Hub_Buf) )  DEALLOCATE(Db_Hub_Buf)
  IF( ALLOCATED(Int_Hub_Buf) ) DEALLOCATE(Int_Hub_Buf)
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, InData%RotorFurl, ErrStat, ErrMsg, OnlySize ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurl_Buf)-1 ) = Re_RotorFurl_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurl_Buf)-1 ) = Db_RotorFurl_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurl_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurl_Buf)-1 ) = Int_RotorFurl_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurl_Buf)
  ENDIF
  IF( ALLOCATED(Re_RotorFurl_Buf) )  DEALLOCATE(Re_RotorFurl_Buf)
  IF( ALLOCATED(Db_RotorFurl_Buf) )  DEALLOCATE(Db_RotorFurl_Buf)
  IF( ALLOCATED(Int_RotorFurl_Buf) ) DEALLOCATE(Int_RotorFurl_Buf)
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, InData%Nacelle, ErrStat, ErrMsg, OnlySize ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Nacelle_Buf)-1 ) = Re_Nacelle_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Db_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Nacelle_Buf)-1 ) = Db_Nacelle_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Int_Nacelle_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Nacelle_Buf)-1 ) = Int_Nacelle_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Nacelle_Buf)
  ENDIF
  IF( ALLOCATED(Re_Nacelle_Buf) )  DEALLOCATE(Re_Nacelle_Buf)
  IF( ALLOCATED(Db_Nacelle_Buf) )  DEALLOCATE(Db_Nacelle_Buf)
  IF( ALLOCATED(Int_Nacelle_Buf) ) DEALLOCATE(Int_Nacelle_Buf)
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, InData%TailFin, ErrStat, ErrMsg, OnlySize ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TailFin_Buf)-1 ) = Re_TailFin_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Db_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TailFin_Buf)-1 ) = Db_TailFin_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Int_TailFin_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TailFin_Buf)-1 ) = Int_TailFin_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TailFin_Buf)
  ENDIF
  IF( ALLOCATED(Re_TailFin_Buf) )  DEALLOCATE(Re_TailFin_Buf)
  IF( ALLOCATED(Db_TailFin_Buf) )  DEALLOCATE(Db_TailFin_Buf)
  IF( ALLOCATED(Int_TailFin_Buf) ) DEALLOCATE(Int_TailFin_Buf)
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, InData%Tower, ErrStat, ErrMsg, OnlySize ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tower_Buf)-1 ) = Re_Tower_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tower_Buf)-1 ) = Db_Tower_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tower_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tower_Buf)-1 ) = Int_Tower_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Tower_Buf)
  ENDIF
  IF( ALLOCATED(Re_Tower_Buf) )  DEALLOCATE(Re_Tower_Buf)
  IF( ALLOCATED(Db_Tower_Buf) )  DEALLOCATE(Db_Tower_Buf)
  IF( ALLOCATED(Int_Tower_Buf) ) DEALLOCATE(Int_Tower_Buf)
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, InData%SubStructure, ErrStat, ErrMsg, OnlySize ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SubStructure_Buf)-1 ) = Re_SubStructure_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Db_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SubStructure_Buf)-1 ) = Db_SubStructure_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Int_SubStructure_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SubStructure_Buf)-1 ) = Int_SubStructure_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_SubStructure_Buf)
  ENDIF
  IF( ALLOCATED(Re_SubStructure_Buf) )  DEALLOCATE(Re_SubStructure_Buf)
  IF( ALLOCATED(Db_SubStructure_Buf) )  DEALLOCATE(Db_SubStructure_Buf)
  IF( ALLOCATED(Int_SubStructure_Buf) ) DEALLOCATE(Int_SubStructure_Buf)
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, InData%Foundation, ErrStat, ErrMsg, OnlySize ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Foundation_Buf)-1 ) = Re_Foundation_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Db_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Foundation_Buf)-1 ) = Db_Foundation_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Int_Foundation_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Foundation_Buf)-1 ) = Int_Foundation_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Foundation_Buf)
  ENDIF
  IF( ALLOCATED(Re_Foundation_Buf) )  DEALLOCATE(Re_Foundation_Buf)
  IF( ALLOCATED(Db_Foundation_Buf) )  DEALLOCATE(Db_Foundation_Buf)
  IF( ALLOCATED(Int_Foundation_Buf) ) DEALLOCATE(Int_Foundation_Buf)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packaeroconfig

 SUBROUTINE AD_UnPackaeroconfig( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(aeroconfig), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Hub_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Hub_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Hub_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_RotorFurl_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_RotorFurl_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_RotorFurl_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Nacelle_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Nacelle_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Nacelle_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TailFin_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TailFin_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TailFin_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Tower_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Tower_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Tower_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_SubStructure_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_SubStructure_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_SubStructure_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Foundation_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Foundation_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Foundation_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%Blade,1), UBOUND(OutData%Blade,1)
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade(i1), ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    Re_Blade_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    Db_Blade_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    Int_Blade_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade(i1), ErrStat, ErrMsg ) ! Blade 
ENDDO
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, OutData%Hub, ErrStat, ErrMsg, .TRUE. ) ! Hub 
  IF(ALLOCATED(Re_Hub_Buf)) THEN
    Re_Hub_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Hub_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Db_Hub_Buf)) THEN
    Db_Hub_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Hub_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Hub_Buf)
  ENDIF
  IF(ALLOCATED(Int_Hub_Buf)) THEN
    Int_Hub_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Hub_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Hub_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Hub_Buf, Db_Hub_Buf, Int_Hub_Buf, OutData%Hub, ErrStat, ErrMsg ) ! Hub 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, OutData%RotorFurl, ErrStat, ErrMsg, .TRUE. ) ! RotorFurl 
  IF(ALLOCATED(Re_RotorFurl_Buf)) THEN
    Re_RotorFurl_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_RotorFurl_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Db_RotorFurl_Buf)) THEN
    Db_RotorFurl_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_RotorFurl_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_RotorFurl_Buf)
  ENDIF
  IF(ALLOCATED(Int_RotorFurl_Buf)) THEN
    Int_RotorFurl_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_RotorFurl_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_RotorFurl_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_RotorFurl_Buf, Db_RotorFurl_Buf, Int_RotorFurl_Buf, OutData%RotorFurl, ErrStat, ErrMsg ) ! RotorFurl 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, OutData%Nacelle, ErrStat, ErrMsg, .TRUE. ) ! Nacelle 
  IF(ALLOCATED(Re_Nacelle_Buf)) THEN
    Re_Nacelle_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Nacelle_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Db_Nacelle_Buf)) THEN
    Db_Nacelle_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Nacelle_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Nacelle_Buf)
  ENDIF
  IF(ALLOCATED(Int_Nacelle_Buf)) THEN
    Int_Nacelle_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Nacelle_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Nacelle_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Nacelle_Buf, Db_Nacelle_Buf, Int_Nacelle_Buf, OutData%Nacelle, ErrStat, ErrMsg ) ! Nacelle 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, OutData%TailFin, ErrStat, ErrMsg, .TRUE. ) ! TailFin 
  IF(ALLOCATED(Re_TailFin_Buf)) THEN
    Re_TailFin_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TailFin_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Db_TailFin_Buf)) THEN
    Db_TailFin_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TailFin_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TailFin_Buf)
  ENDIF
  IF(ALLOCATED(Int_TailFin_Buf)) THEN
    Int_TailFin_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TailFin_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TailFin_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_TailFin_Buf, Db_TailFin_Buf, Int_TailFin_Buf, OutData%TailFin, ErrStat, ErrMsg ) ! TailFin 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, OutData%Tower, ErrStat, ErrMsg, .TRUE. ) ! Tower 
  IF(ALLOCATED(Re_Tower_Buf)) THEN
    Re_Tower_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Tower_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Db_Tower_Buf)) THEN
    Db_Tower_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Tower_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Tower_Buf)
  ENDIF
  IF(ALLOCATED(Int_Tower_Buf)) THEN
    Int_Tower_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Tower_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Tower_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Tower_Buf, Db_Tower_Buf, Int_Tower_Buf, OutData%Tower, ErrStat, ErrMsg ) ! Tower 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, OutData%SubStructure, ErrStat, ErrMsg, .TRUE. ) ! SubStructure 
  IF(ALLOCATED(Re_SubStructure_Buf)) THEN
    Re_SubStructure_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_SubStructure_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Db_SubStructure_Buf)) THEN
    Db_SubStructure_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_SubStructure_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_SubStructure_Buf)
  ENDIF
  IF(ALLOCATED(Int_SubStructure_Buf)) THEN
    Int_SubStructure_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_SubStructure_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_SubStructure_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_SubStructure_Buf, Db_SubStructure_Buf, Int_SubStructure_Buf, OutData%SubStructure, ErrStat, ErrMsg ) ! SubStructure 
 ! first call AD_Packmarker to get correctly sized buffers for unpacking
  CALL AD_Packmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, OutData%Foundation, ErrStat, ErrMsg, .TRUE. ) ! Foundation 
  IF(ALLOCATED(Re_Foundation_Buf)) THEN
    Re_Foundation_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Foundation_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Db_Foundation_Buf)) THEN
    Db_Foundation_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Foundation_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Foundation_Buf)
  ENDIF
  IF(ALLOCATED(Int_Foundation_Buf)) THEN
    Int_Foundation_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Foundation_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Foundation_Buf)
  ENDIF
  CALL AD_UnPackmarker( Re_Foundation_Buf, Db_Foundation_Buf, Int_Foundation_Buf, OutData%Foundation, ErrStat, ErrMsg ) ! Foundation 
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackaeroconfig

 SUBROUTINE AD_Copyairfoil( SrcairfoilData, DstairfoilData, CtrlCode, ErrStat, ErrMsg )
   TYPE(airfoil), INTENT(INOUT) :: SrcairfoilData
   TYPE(airfoil), INTENT(INOUT) :: DstairfoilData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcairfoilData%AL)) THEN
   i1_l = LBOUND(SrcairfoilData%AL,1)
   i1_u = UBOUND(SrcairfoilData%AL,1)
   i2_l = LBOUND(SrcairfoilData%AL,2)
   i2_u = UBOUND(SrcairfoilData%AL,2)
   IF (.NOT.ALLOCATED(DstairfoilData%AL)) THEN 
      ALLOCATE(DstairfoilData%AL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoil: Error allocating DstairfoilData%AL.'
         RETURN
      END IF
   END IF
   DstairfoilData%AL = SrcairfoilData%AL
ENDIF
IF (ALLOCATED(SrcairfoilData%CD)) THEN
   i1_l = LBOUND(SrcairfoilData%CD,1)
   i1_u = UBOUND(SrcairfoilData%CD,1)
   i2_l = LBOUND(SrcairfoilData%CD,2)
   i2_u = UBOUND(SrcairfoilData%CD,2)
   i3_l = LBOUND(SrcairfoilData%CD,3)
   i3_u = UBOUND(SrcairfoilData%CD,3)
   IF (.NOT.ALLOCATED(DstairfoilData%CD)) THEN 
      ALLOCATE(DstairfoilData%CD(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoil: Error allocating DstairfoilData%CD.'
         RETURN
      END IF
   END IF
   DstairfoilData%CD = SrcairfoilData%CD
ENDIF
IF (ALLOCATED(SrcairfoilData%CL)) THEN
   i1_l = LBOUND(SrcairfoilData%CL,1)
   i1_u = UBOUND(SrcairfoilData%CL,1)
   i2_l = LBOUND(SrcairfoilData%CL,2)
   i2_u = UBOUND(SrcairfoilData%CL,2)
   i3_l = LBOUND(SrcairfoilData%CL,3)
   i3_u = UBOUND(SrcairfoilData%CL,3)
   IF (.NOT.ALLOCATED(DstairfoilData%CL)) THEN 
      ALLOCATE(DstairfoilData%CL(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoil: Error allocating DstairfoilData%CL.'
         RETURN
      END IF
   END IF
   DstairfoilData%CL = SrcairfoilData%CL
ENDIF
IF (ALLOCATED(SrcairfoilData%CM)) THEN
   i1_l = LBOUND(SrcairfoilData%CM,1)
   i1_u = UBOUND(SrcairfoilData%CM,1)
   i2_l = LBOUND(SrcairfoilData%CM,2)
   i2_u = UBOUND(SrcairfoilData%CM,2)
   i3_l = LBOUND(SrcairfoilData%CM,3)
   i3_u = UBOUND(SrcairfoilData%CM,3)
   IF (.NOT.ALLOCATED(DstairfoilData%CM)) THEN 
      ALLOCATE(DstairfoilData%CM(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoil: Error allocating DstairfoilData%CM.'
         RETURN
      END IF
   END IF
   DstairfoilData%CM = SrcairfoilData%CM
ENDIF
   DstairfoilData%PMC = SrcairfoilData%PMC
   DstairfoilData%MulTabLoc = SrcairfoilData%MulTabLoc
 END SUBROUTINE AD_Copyairfoil

 SUBROUTINE AD_Destroyairfoil( airfoilData, ErrStat, ErrMsg )
  TYPE(airfoil), INTENT(INOUT) :: airfoilData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(airfoilData%AL)) THEN
   DEALLOCATE(airfoilData%AL)
ENDIF
IF (ALLOCATED(airfoilData%CD)) THEN
   DEALLOCATE(airfoilData%CD)
ENDIF
IF (ALLOCATED(airfoilData%CL)) THEN
   DEALLOCATE(airfoilData%CL)
ENDIF
IF (ALLOCATED(airfoilData%CM)) THEN
   DEALLOCATE(airfoilData%CM)
ENDIF
 END SUBROUTINE AD_Destroyairfoil

 SUBROUTINE AD_Packairfoil( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(airfoil),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%AL )  ! AL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CD )  ! CD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CL )  ! CL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CM )  ! CM 
  Re_BufSz   = Re_BufSz   + 1  ! PMC
  Re_BufSz   = Re_BufSz   + 1  ! MulTabLoc
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%AL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AL))-1 ) =  PACK(InData%AL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AL)
  ENDIF
  IF ( ALLOCATED(InData%CD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CD))-1 ) =  PACK(InData%CD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CD)
  ENDIF
  IF ( ALLOCATED(InData%CL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CL))-1 ) =  PACK(InData%CL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CL)
  ENDIF
  IF ( ALLOCATED(InData%CM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CM))-1 ) =  PACK(InData%CM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CM)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PMC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%MulTabLoc )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packairfoil

 SUBROUTINE AD_UnPackairfoil( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(airfoil), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%AL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AL,1),SIZE(OutData%AL,2))); mask2 = .TRUE.
    OutData%AL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AL))-1 ),mask2,OutData%AL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AL)
  ENDIF
  IF ( ALLOCATED(OutData%CD) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CD,1),SIZE(OutData%CD,2),SIZE(OutData%CD,3))); mask3 = .TRUE.
    OutData%CD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CD))-1 ),mask3,OutData%CD)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CD)
  ENDIF
  IF ( ALLOCATED(OutData%CL) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CL,1),SIZE(OutData%CL,2),SIZE(OutData%CL,3))); mask3 = .TRUE.
    OutData%CL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CL))-1 ),mask3,OutData%CL)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CL)
  ENDIF
  IF ( ALLOCATED(OutData%CM) ) THEN
  ALLOCATE(mask3(SIZE(OutData%CM,1),SIZE(OutData%CM,2),SIZE(OutData%CM,3))); mask3 = .TRUE.
    OutData%CM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CM))-1 ),mask3,OutData%CM)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CM)
  ENDIF
  OutData%PMC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%MulTabLoc = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackairfoil

 SUBROUTINE AD_Copyairfoilparms( SrcairfoilparmsData, DstairfoilparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(airfoilparms), INTENT(INOUT) :: SrcairfoilparmsData
   TYPE(airfoilparms), INTENT(INOUT) :: DstairfoilparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstairfoilparmsData%MaxTable = SrcairfoilparmsData%MaxTable
IF (ALLOCATED(SrcairfoilparmsData%NTables)) THEN
   i1_l = LBOUND(SrcairfoilparmsData%NTables,1)
   i1_u = UBOUND(SrcairfoilparmsData%NTables,1)
   IF (.NOT.ALLOCATED(DstairfoilparmsData%NTables)) THEN 
      ALLOCATE(DstairfoilparmsData%NTables(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoilparms: Error allocating DstairfoilparmsData%NTables.'
         RETURN
      END IF
   END IF
   DstairfoilparmsData%NTables = SrcairfoilparmsData%NTables
ENDIF
IF (ALLOCATED(SrcairfoilparmsData%NLift)) THEN
   i1_l = LBOUND(SrcairfoilparmsData%NLift,1)
   i1_u = UBOUND(SrcairfoilparmsData%NLift,1)
   IF (.NOT.ALLOCATED(DstairfoilparmsData%NLift)) THEN 
      ALLOCATE(DstairfoilparmsData%NLift(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoilparms: Error allocating DstairfoilparmsData%NLift.'
         RETURN
      END IF
   END IF
   DstairfoilparmsData%NLift = SrcairfoilparmsData%NLift
ENDIF
   DstairfoilparmsData%NumCL = SrcairfoilparmsData%NumCL
   DstairfoilparmsData%NumFoil = SrcairfoilparmsData%NumFoil
IF (ALLOCATED(SrcairfoilparmsData%NFoil)) THEN
   i1_l = LBOUND(SrcairfoilparmsData%NFoil,1)
   i1_u = UBOUND(SrcairfoilparmsData%NFoil,1)
   IF (.NOT.ALLOCATED(DstairfoilparmsData%NFoil)) THEN 
      ALLOCATE(DstairfoilparmsData%NFoil(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoilparms: Error allocating DstairfoilparmsData%NFoil.'
         RETURN
      END IF
   END IF
   DstairfoilparmsData%NFoil = SrcairfoilparmsData%NFoil
ENDIF
IF (ALLOCATED(SrcairfoilparmsData%MulTabMet)) THEN
   i1_l = LBOUND(SrcairfoilparmsData%MulTabMet,1)
   i1_u = UBOUND(SrcairfoilparmsData%MulTabMet,1)
   i2_l = LBOUND(SrcairfoilparmsData%MulTabMet,2)
   i2_u = UBOUND(SrcairfoilparmsData%MulTabMet,2)
   IF (.NOT.ALLOCATED(DstairfoilparmsData%MulTabMet)) THEN 
      ALLOCATE(DstairfoilparmsData%MulTabMet(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoilparms: Error allocating DstairfoilparmsData%MulTabMet.'
         RETURN
      END IF
   END IF
   DstairfoilparmsData%MulTabMet = SrcairfoilparmsData%MulTabMet
ENDIF
IF (ALLOCATED(SrcairfoilparmsData%FoilNm)) THEN
   i1_l = LBOUND(SrcairfoilparmsData%FoilNm,1)
   i1_u = UBOUND(SrcairfoilparmsData%FoilNm,1)
   IF (.NOT.ALLOCATED(DstairfoilparmsData%FoilNm)) THEN 
      ALLOCATE(DstairfoilparmsData%FoilNm(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyairfoilparms: Error allocating DstairfoilparmsData%FoilNm.'
         RETURN
      END IF
   END IF
   DstairfoilparmsData%FoilNm = SrcairfoilparmsData%FoilNm
ENDIF
 END SUBROUTINE AD_Copyairfoilparms

 SUBROUTINE AD_Destroyairfoilparms( airfoilparmsData, ErrStat, ErrMsg )
  TYPE(airfoilparms), INTENT(INOUT) :: airfoilparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(airfoilparmsData%NTables)) THEN
   DEALLOCATE(airfoilparmsData%NTables)
ENDIF
IF (ALLOCATED(airfoilparmsData%NLift)) THEN
   DEALLOCATE(airfoilparmsData%NLift)
ENDIF
IF (ALLOCATED(airfoilparmsData%NFoil)) THEN
   DEALLOCATE(airfoilparmsData%NFoil)
ENDIF
IF (ALLOCATED(airfoilparmsData%MulTabMet)) THEN
   DEALLOCATE(airfoilparmsData%MulTabMet)
ENDIF
IF (ALLOCATED(airfoilparmsData%FoilNm)) THEN
   DEALLOCATE(airfoilparmsData%FoilNm)
ENDIF
 END SUBROUTINE AD_Destroyairfoilparms

 SUBROUTINE AD_Packairfoilparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(airfoilparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! MaxTable
  Int_BufSz   = Int_BufSz   + SIZE( InData%NTables )  ! NTables 
  Int_BufSz   = Int_BufSz   + SIZE( InData%NLift )  ! NLift 
  Int_BufSz  = Int_BufSz  + 1  ! NumCL
  Int_BufSz  = Int_BufSz  + 1  ! NumFoil
  Int_BufSz   = Int_BufSz   + SIZE( InData%NFoil )  ! NFoil 
  Re_BufSz    = Re_BufSz    + SIZE( InData%MulTabMet )  ! MulTabMet 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MaxTable )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NTables) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NTables))-1 ) = PACK(InData%NTables ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NTables)
  ENDIF
  IF ( ALLOCATED(InData%NLift) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NLift))-1 ) = PACK(InData%NLift ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NLift)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumCL )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumFoil )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%NFoil) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NFoil))-1 ) = PACK(InData%NFoil ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NFoil)
  ENDIF
  IF ( ALLOCATED(InData%MulTabMet) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MulTabMet))-1 ) =  PACK(InData%MulTabMet ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MulTabMet)
  ENDIF
 END SUBROUTINE AD_Packairfoilparms

 SUBROUTINE AD_UnPackairfoilparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(airfoilparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%MaxTable = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NTables) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NTables,1))); mask1 = .TRUE.
    OutData%NTables = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NTables))-1 ),mask1,OutData%NTables)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NTables)
  ENDIF
  IF ( ALLOCATED(OutData%NLift) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NLift,1))); mask1 = .TRUE.
    OutData%NLift = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NLift))-1 ),mask1,OutData%NLift)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NLift)
  ENDIF
  OutData%NumCL = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NumFoil = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%NFoil) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NFoil,1))); mask1 = .TRUE.
    OutData%NFoil = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NFoil))-1 ),mask1,OutData%NFoil)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NFoil)
  ENDIF
  IF ( ALLOCATED(OutData%MulTabMet) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MulTabMet,1),SIZE(OutData%MulTabMet,2))); mask2 = .TRUE.
    OutData%MulTabMet = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MulTabMet))-1 ),mask2,OutData%MulTabMet)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MulTabMet)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackairfoilparms

 SUBROUTINE AD_Copybeddoes( SrcbeddoesData, DstbeddoesData, CtrlCode, ErrStat, ErrMsg )
   TYPE(beddoes), INTENT(INOUT) :: SrcbeddoesData
   TYPE(beddoes), INTENT(INOUT) :: DstbeddoesData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcbeddoesData%ADOT)) THEN
   i1_l = LBOUND(SrcbeddoesData%ADOT,1)
   i1_u = UBOUND(SrcbeddoesData%ADOT,1)
   i2_l = LBOUND(SrcbeddoesData%ADOT,2)
   i2_u = UBOUND(SrcbeddoesData%ADOT,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%ADOT)) THEN 
      ALLOCATE(DstbeddoesData%ADOT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%ADOT.'
         RETURN
      END IF
   END IF
   DstbeddoesData%ADOT = SrcbeddoesData%ADOT
ENDIF
IF (ALLOCATED(SrcbeddoesData%ADOT1)) THEN
   i1_l = LBOUND(SrcbeddoesData%ADOT1,1)
   i1_u = UBOUND(SrcbeddoesData%ADOT1,1)
   i2_l = LBOUND(SrcbeddoesData%ADOT1,2)
   i2_u = UBOUND(SrcbeddoesData%ADOT1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%ADOT1)) THEN 
      ALLOCATE(DstbeddoesData%ADOT1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%ADOT1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%ADOT1 = SrcbeddoesData%ADOT1
ENDIF
IF (ALLOCATED(SrcbeddoesData%AFE)) THEN
   i1_l = LBOUND(SrcbeddoesData%AFE,1)
   i1_u = UBOUND(SrcbeddoesData%AFE,1)
   i2_l = LBOUND(SrcbeddoesData%AFE,2)
   i2_u = UBOUND(SrcbeddoesData%AFE,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%AFE)) THEN 
      ALLOCATE(DstbeddoesData%AFE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%AFE.'
         RETURN
      END IF
   END IF
   DstbeddoesData%AFE = SrcbeddoesData%AFE
ENDIF
IF (ALLOCATED(SrcbeddoesData%AFE1)) THEN
   i1_l = LBOUND(SrcbeddoesData%AFE1,1)
   i1_u = UBOUND(SrcbeddoesData%AFE1,1)
   i2_l = LBOUND(SrcbeddoesData%AFE1,2)
   i2_u = UBOUND(SrcbeddoesData%AFE1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%AFE1)) THEN 
      ALLOCATE(DstbeddoesData%AFE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%AFE1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%AFE1 = SrcbeddoesData%AFE1
ENDIF
   DstbeddoesData%AN = SrcbeddoesData%AN
IF (ALLOCATED(SrcbeddoesData%ANE)) THEN
   i1_l = LBOUND(SrcbeddoesData%ANE,1)
   i1_u = UBOUND(SrcbeddoesData%ANE,1)
   i2_l = LBOUND(SrcbeddoesData%ANE,2)
   i2_u = UBOUND(SrcbeddoesData%ANE,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%ANE)) THEN 
      ALLOCATE(DstbeddoesData%ANE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%ANE.'
         RETURN
      END IF
   END IF
   DstbeddoesData%ANE = SrcbeddoesData%ANE
ENDIF
IF (ALLOCATED(SrcbeddoesData%ANE1)) THEN
   i1_l = LBOUND(SrcbeddoesData%ANE1,1)
   i1_u = UBOUND(SrcbeddoesData%ANE1,1)
   i2_l = LBOUND(SrcbeddoesData%ANE1,2)
   i2_u = UBOUND(SrcbeddoesData%ANE1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%ANE1)) THEN 
      ALLOCATE(DstbeddoesData%ANE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%ANE1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%ANE1 = SrcbeddoesData%ANE1
ENDIF
IF (ALLOCATED(SrcbeddoesData%AOD)) THEN
   i1_l = LBOUND(SrcbeddoesData%AOD,1)
   i1_u = UBOUND(SrcbeddoesData%AOD,1)
   i2_l = LBOUND(SrcbeddoesData%AOD,2)
   i2_u = UBOUND(SrcbeddoesData%AOD,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%AOD)) THEN 
      ALLOCATE(DstbeddoesData%AOD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%AOD.'
         RETURN
      END IF
   END IF
   DstbeddoesData%AOD = SrcbeddoesData%AOD
ENDIF
IF (ALLOCATED(SrcbeddoesData%AOL)) THEN
   i1_l = LBOUND(SrcbeddoesData%AOL,1)
   i1_u = UBOUND(SrcbeddoesData%AOL,1)
   i2_l = LBOUND(SrcbeddoesData%AOL,2)
   i2_u = UBOUND(SrcbeddoesData%AOL,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%AOL)) THEN 
      ALLOCATE(DstbeddoesData%AOL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%AOL.'
         RETURN
      END IF
   END IF
   DstbeddoesData%AOL = SrcbeddoesData%AOL
ENDIF
IF (ALLOCATED(SrcbeddoesData%BEDSEP)) THEN
   i1_l = LBOUND(SrcbeddoesData%BEDSEP,1)
   i1_u = UBOUND(SrcbeddoesData%BEDSEP,1)
   i2_l = LBOUND(SrcbeddoesData%BEDSEP,2)
   i2_u = UBOUND(SrcbeddoesData%BEDSEP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%BEDSEP)) THEN 
      ALLOCATE(DstbeddoesData%BEDSEP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%BEDSEP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%BEDSEP = SrcbeddoesData%BEDSEP
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDSEP)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDSEP,1)
   i1_u = UBOUND(SrcbeddoesData%OLDSEP,1)
   i2_l = LBOUND(SrcbeddoesData%OLDSEP,2)
   i2_u = UBOUND(SrcbeddoesData%OLDSEP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDSEP)) THEN 
      ALLOCATE(DstbeddoesData%OLDSEP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDSEP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDSEP = SrcbeddoesData%OLDSEP
ENDIF
   DstbeddoesData%CC = SrcbeddoesData%CC
IF (ALLOCATED(SrcbeddoesData%CDO)) THEN
   i1_l = LBOUND(SrcbeddoesData%CDO,1)
   i1_u = UBOUND(SrcbeddoesData%CDO,1)
   i2_l = LBOUND(SrcbeddoesData%CDO,2)
   i2_u = UBOUND(SrcbeddoesData%CDO,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CDO)) THEN 
      ALLOCATE(DstbeddoesData%CDO(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CDO.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CDO = SrcbeddoesData%CDO
ENDIF
   DstbeddoesData%CMI = SrcbeddoesData%CMI
   DstbeddoesData%CMQ = SrcbeddoesData%CMQ
   DstbeddoesData%CN = SrcbeddoesData%CN
IF (ALLOCATED(SrcbeddoesData%CNA)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNA,1)
   i1_u = UBOUND(SrcbeddoesData%CNA,1)
   i2_l = LBOUND(SrcbeddoesData%CNA,2)
   i2_u = UBOUND(SrcbeddoesData%CNA,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNA)) THEN 
      ALLOCATE(DstbeddoesData%CNA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNA.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNA = SrcbeddoesData%CNA
ENDIF
   DstbeddoesData%CNCP = SrcbeddoesData%CNCP
   DstbeddoesData%CNIQ = SrcbeddoesData%CNIQ
IF (ALLOCATED(SrcbeddoesData%CNP)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNP,1)
   i1_u = UBOUND(SrcbeddoesData%CNP,1)
   i2_l = LBOUND(SrcbeddoesData%CNP,2)
   i2_u = UBOUND(SrcbeddoesData%CNP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNP)) THEN 
      ALLOCATE(DstbeddoesData%CNP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNP = SrcbeddoesData%CNP
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNP1)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNP1,1)
   i1_u = UBOUND(SrcbeddoesData%CNP1,1)
   i2_l = LBOUND(SrcbeddoesData%CNP1,2)
   i2_u = UBOUND(SrcbeddoesData%CNP1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNP1)) THEN 
      ALLOCATE(DstbeddoesData%CNP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNP1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNP1 = SrcbeddoesData%CNP1
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNPD)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNPD,1)
   i1_u = UBOUND(SrcbeddoesData%CNPD,1)
   i2_l = LBOUND(SrcbeddoesData%CNPD,2)
   i2_u = UBOUND(SrcbeddoesData%CNPD,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNPD)) THEN 
      ALLOCATE(DstbeddoesData%CNPD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNPD.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNPD = SrcbeddoesData%CNPD
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNPD1)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNPD1,1)
   i1_u = UBOUND(SrcbeddoesData%CNPD1,1)
   i2_l = LBOUND(SrcbeddoesData%CNPD1,2)
   i2_u = UBOUND(SrcbeddoesData%CNPD1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNPD1)) THEN 
      ALLOCATE(DstbeddoesData%CNPD1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNPD1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNPD1 = SrcbeddoesData%CNPD1
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNPOT)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNPOT,1)
   i1_u = UBOUND(SrcbeddoesData%CNPOT,1)
   i2_l = LBOUND(SrcbeddoesData%CNPOT,2)
   i2_u = UBOUND(SrcbeddoesData%CNPOT,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNPOT)) THEN 
      ALLOCATE(DstbeddoesData%CNPOT(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNPOT.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNPOT = SrcbeddoesData%CNPOT
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNPOT1)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNPOT1,1)
   i1_u = UBOUND(SrcbeddoesData%CNPOT1,1)
   i2_l = LBOUND(SrcbeddoesData%CNPOT1,2)
   i2_u = UBOUND(SrcbeddoesData%CNPOT1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNPOT1)) THEN 
      ALLOCATE(DstbeddoesData%CNPOT1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNPOT1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNPOT1 = SrcbeddoesData%CNPOT1
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNS)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNS,1)
   i1_u = UBOUND(SrcbeddoesData%CNS,1)
   i2_l = LBOUND(SrcbeddoesData%CNS,2)
   i2_u = UBOUND(SrcbeddoesData%CNS,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNS)) THEN 
      ALLOCATE(DstbeddoesData%CNS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNS.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNS = SrcbeddoesData%CNS
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNSL)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNSL,1)
   i1_u = UBOUND(SrcbeddoesData%CNSL,1)
   i2_l = LBOUND(SrcbeddoesData%CNSL,2)
   i2_u = UBOUND(SrcbeddoesData%CNSL,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNSL)) THEN 
      ALLOCATE(DstbeddoesData%CNSL(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNSL.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNSL = SrcbeddoesData%CNSL
ENDIF
IF (ALLOCATED(SrcbeddoesData%CNV)) THEN
   i1_l = LBOUND(SrcbeddoesData%CNV,1)
   i1_u = UBOUND(SrcbeddoesData%CNV,1)
   i2_l = LBOUND(SrcbeddoesData%CNV,2)
   i2_u = UBOUND(SrcbeddoesData%CNV,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CNV)) THEN 
      ALLOCATE(DstbeddoesData%CNV(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CNV.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CNV = SrcbeddoesData%CNV
ENDIF
IF (ALLOCATED(SrcbeddoesData%CVN)) THEN
   i1_l = LBOUND(SrcbeddoesData%CVN,1)
   i1_u = UBOUND(SrcbeddoesData%CVN,1)
   i2_l = LBOUND(SrcbeddoesData%CVN,2)
   i2_u = UBOUND(SrcbeddoesData%CVN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CVN)) THEN 
      ALLOCATE(DstbeddoesData%CVN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CVN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CVN = SrcbeddoesData%CVN
ENDIF
IF (ALLOCATED(SrcbeddoesData%CVN1)) THEN
   i1_l = LBOUND(SrcbeddoesData%CVN1,1)
   i1_u = UBOUND(SrcbeddoesData%CVN1,1)
   i2_l = LBOUND(SrcbeddoesData%CVN1,2)
   i2_u = UBOUND(SrcbeddoesData%CVN1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%CVN1)) THEN 
      ALLOCATE(DstbeddoesData%CVN1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%CVN1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%CVN1 = SrcbeddoesData%CVN1
ENDIF
IF (ALLOCATED(SrcbeddoesData%DF)) THEN
   i1_l = LBOUND(SrcbeddoesData%DF,1)
   i1_u = UBOUND(SrcbeddoesData%DF,1)
   i2_l = LBOUND(SrcbeddoesData%DF,2)
   i2_u = UBOUND(SrcbeddoesData%DF,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DF)) THEN 
      ALLOCATE(DstbeddoesData%DF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DF.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DF = SrcbeddoesData%DF
ENDIF
IF (ALLOCATED(SrcbeddoesData%DFAFE)) THEN
   i1_l = LBOUND(SrcbeddoesData%DFAFE,1)
   i1_u = UBOUND(SrcbeddoesData%DFAFE,1)
   i2_l = LBOUND(SrcbeddoesData%DFAFE,2)
   i2_u = UBOUND(SrcbeddoesData%DFAFE,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DFAFE)) THEN 
      ALLOCATE(DstbeddoesData%DFAFE(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DFAFE.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DFAFE = SrcbeddoesData%DFAFE
ENDIF
IF (ALLOCATED(SrcbeddoesData%DFAFE1)) THEN
   i1_l = LBOUND(SrcbeddoesData%DFAFE1,1)
   i1_u = UBOUND(SrcbeddoesData%DFAFE1,1)
   i2_l = LBOUND(SrcbeddoesData%DFAFE1,2)
   i2_u = UBOUND(SrcbeddoesData%DFAFE1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DFAFE1)) THEN 
      ALLOCATE(DstbeddoesData%DFAFE1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DFAFE1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DFAFE1 = SrcbeddoesData%DFAFE1
ENDIF
IF (ALLOCATED(SrcbeddoesData%DFC)) THEN
   i1_l = LBOUND(SrcbeddoesData%DFC,1)
   i1_u = UBOUND(SrcbeddoesData%DFC,1)
   i2_l = LBOUND(SrcbeddoesData%DFC,2)
   i2_u = UBOUND(SrcbeddoesData%DFC,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DFC)) THEN 
      ALLOCATE(DstbeddoesData%DFC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DFC.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DFC = SrcbeddoesData%DFC
ENDIF
IF (ALLOCATED(SrcbeddoesData%DN)) THEN
   i1_l = LBOUND(SrcbeddoesData%DN,1)
   i1_u = UBOUND(SrcbeddoesData%DN,1)
   i2_l = LBOUND(SrcbeddoesData%DN,2)
   i2_u = UBOUND(SrcbeddoesData%DN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DN)) THEN 
      ALLOCATE(DstbeddoesData%DN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DN = SrcbeddoesData%DN
ENDIF
IF (ALLOCATED(SrcbeddoesData%DPP)) THEN
   i1_l = LBOUND(SrcbeddoesData%DPP,1)
   i1_u = UBOUND(SrcbeddoesData%DPP,1)
   i2_l = LBOUND(SrcbeddoesData%DPP,2)
   i2_u = UBOUND(SrcbeddoesData%DPP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DPP)) THEN 
      ALLOCATE(DstbeddoesData%DPP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DPP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DPP = SrcbeddoesData%DPP
ENDIF
IF (ALLOCATED(SrcbeddoesData%DQ)) THEN
   i1_l = LBOUND(SrcbeddoesData%DQ,1)
   i1_u = UBOUND(SrcbeddoesData%DQ,1)
   i2_l = LBOUND(SrcbeddoesData%DQ,2)
   i2_u = UBOUND(SrcbeddoesData%DQ,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DQ)) THEN 
      ALLOCATE(DstbeddoesData%DQ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DQ.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DQ = SrcbeddoesData%DQ
ENDIF
IF (ALLOCATED(SrcbeddoesData%DQP)) THEN
   i1_l = LBOUND(SrcbeddoesData%DQP,1)
   i1_u = UBOUND(SrcbeddoesData%DQP,1)
   i2_l = LBOUND(SrcbeddoesData%DQP,2)
   i2_u = UBOUND(SrcbeddoesData%DQP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DQP)) THEN 
      ALLOCATE(DstbeddoesData%DQP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DQP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DQP = SrcbeddoesData%DQP
ENDIF
IF (ALLOCATED(SrcbeddoesData%DQP1)) THEN
   i1_l = LBOUND(SrcbeddoesData%DQP1,1)
   i1_u = UBOUND(SrcbeddoesData%DQP1,1)
   i2_l = LBOUND(SrcbeddoesData%DQP1,2)
   i2_u = UBOUND(SrcbeddoesData%DQP1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%DQP1)) THEN 
      ALLOCATE(DstbeddoesData%DQP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%DQP1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%DQP1 = SrcbeddoesData%DQP1
ENDIF
   DstbeddoesData%DS = SrcbeddoesData%DS
   DstbeddoesData%FK = SrcbeddoesData%FK
   DstbeddoesData%FP = SrcbeddoesData%FP
   DstbeddoesData%FPC = SrcbeddoesData%FPC
IF (ALLOCATED(SrcbeddoesData%FSP)) THEN
   i1_l = LBOUND(SrcbeddoesData%FSP,1)
   i1_u = UBOUND(SrcbeddoesData%FSP,1)
   i2_l = LBOUND(SrcbeddoesData%FSP,2)
   i2_u = UBOUND(SrcbeddoesData%FSP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%FSP)) THEN 
      ALLOCATE(DstbeddoesData%FSP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%FSP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%FSP = SrcbeddoesData%FSP
ENDIF
IF (ALLOCATED(SrcbeddoesData%FSP1)) THEN
   i1_l = LBOUND(SrcbeddoesData%FSP1,1)
   i1_u = UBOUND(SrcbeddoesData%FSP1,1)
   i2_l = LBOUND(SrcbeddoesData%FSP1,2)
   i2_u = UBOUND(SrcbeddoesData%FSP1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%FSP1)) THEN 
      ALLOCATE(DstbeddoesData%FSP1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%FSP1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%FSP1 = SrcbeddoesData%FSP1
ENDIF
IF (ALLOCATED(SrcbeddoesData%FSPC)) THEN
   i1_l = LBOUND(SrcbeddoesData%FSPC,1)
   i1_u = UBOUND(SrcbeddoesData%FSPC,1)
   i2_l = LBOUND(SrcbeddoesData%FSPC,2)
   i2_u = UBOUND(SrcbeddoesData%FSPC,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%FSPC)) THEN 
      ALLOCATE(DstbeddoesData%FSPC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%FSPC.'
         RETURN
      END IF
   END IF
   DstbeddoesData%FSPC = SrcbeddoesData%FSPC
ENDIF
IF (ALLOCATED(SrcbeddoesData%FSPC1)) THEN
   i1_l = LBOUND(SrcbeddoesData%FSPC1,1)
   i1_u = UBOUND(SrcbeddoesData%FSPC1,1)
   i2_l = LBOUND(SrcbeddoesData%FSPC1,2)
   i2_u = UBOUND(SrcbeddoesData%FSPC1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%FSPC1)) THEN 
      ALLOCATE(DstbeddoesData%FSPC1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%FSPC1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%FSPC1 = SrcbeddoesData%FSPC1
ENDIF
IF (ALLOCATED(SrcbeddoesData%FTB)) THEN
   i1_l = LBOUND(SrcbeddoesData%FTB,1)
   i1_u = UBOUND(SrcbeddoesData%FTB,1)
   i2_l = LBOUND(SrcbeddoesData%FTB,2)
   i2_u = UBOUND(SrcbeddoesData%FTB,2)
   i3_l = LBOUND(SrcbeddoesData%FTB,3)
   i3_u = UBOUND(SrcbeddoesData%FTB,3)
   IF (.NOT.ALLOCATED(DstbeddoesData%FTB)) THEN 
      ALLOCATE(DstbeddoesData%FTB(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%FTB.'
         RETURN
      END IF
   END IF
   DstbeddoesData%FTB = SrcbeddoesData%FTB
ENDIF
IF (ALLOCATED(SrcbeddoesData%FTBC)) THEN
   i1_l = LBOUND(SrcbeddoesData%FTBC,1)
   i1_u = UBOUND(SrcbeddoesData%FTBC,1)
   i2_l = LBOUND(SrcbeddoesData%FTBC,2)
   i2_u = UBOUND(SrcbeddoesData%FTBC,2)
   i3_l = LBOUND(SrcbeddoesData%FTBC,3)
   i3_u = UBOUND(SrcbeddoesData%FTBC,3)
   IF (.NOT.ALLOCATED(DstbeddoesData%FTBC)) THEN 
      ALLOCATE(DstbeddoesData%FTBC(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%FTBC.'
         RETURN
      END IF
   END IF
   DstbeddoesData%FTBC = SrcbeddoesData%FTBC
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDCNV)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDCNV,1)
   i1_u = UBOUND(SrcbeddoesData%OLDCNV,1)
   i2_l = LBOUND(SrcbeddoesData%OLDCNV,2)
   i2_u = UBOUND(SrcbeddoesData%OLDCNV,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDCNV)) THEN 
      ALLOCATE(DstbeddoesData%OLDCNV(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDCNV.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDCNV = SrcbeddoesData%OLDCNV
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDDF)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDDF,1)
   i1_u = UBOUND(SrcbeddoesData%OLDDF,1)
   i2_l = LBOUND(SrcbeddoesData%OLDDF,2)
   i2_u = UBOUND(SrcbeddoesData%OLDDF,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDDF)) THEN 
      ALLOCATE(DstbeddoesData%OLDDF(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDDF.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDDF = SrcbeddoesData%OLDDF
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDDFC)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDDFC,1)
   i1_u = UBOUND(SrcbeddoesData%OLDDFC,1)
   i2_l = LBOUND(SrcbeddoesData%OLDDFC,2)
   i2_u = UBOUND(SrcbeddoesData%OLDDFC,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDDFC)) THEN 
      ALLOCATE(DstbeddoesData%OLDDFC(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDDFC.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDDFC = SrcbeddoesData%OLDDFC
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDDN)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDDN,1)
   i1_u = UBOUND(SrcbeddoesData%OLDDN,1)
   i2_l = LBOUND(SrcbeddoesData%OLDDN,2)
   i2_u = UBOUND(SrcbeddoesData%OLDDN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDDN)) THEN 
      ALLOCATE(DstbeddoesData%OLDDN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDDN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDDN = SrcbeddoesData%OLDDN
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDDPP)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDDPP,1)
   i1_u = UBOUND(SrcbeddoesData%OLDDPP,1)
   i2_l = LBOUND(SrcbeddoesData%OLDDPP,2)
   i2_u = UBOUND(SrcbeddoesData%OLDDPP,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDDPP)) THEN 
      ALLOCATE(DstbeddoesData%OLDDPP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDDPP.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDDPP = SrcbeddoesData%OLDDPP
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDDQ)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDDQ,1)
   i1_u = UBOUND(SrcbeddoesData%OLDDQ,1)
   i2_l = LBOUND(SrcbeddoesData%OLDDQ,2)
   i2_u = UBOUND(SrcbeddoesData%OLDDQ,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDDQ)) THEN 
      ALLOCATE(DstbeddoesData%OLDDQ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDDQ.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDDQ = SrcbeddoesData%OLDDQ
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDTAU)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDTAU,1)
   i1_u = UBOUND(SrcbeddoesData%OLDTAU,1)
   i2_l = LBOUND(SrcbeddoesData%OLDTAU,2)
   i2_u = UBOUND(SrcbeddoesData%OLDTAU,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDTAU)) THEN 
      ALLOCATE(DstbeddoesData%OLDTAU(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDTAU.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDTAU = SrcbeddoesData%OLDTAU
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDXN)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDXN,1)
   i1_u = UBOUND(SrcbeddoesData%OLDXN,1)
   i2_l = LBOUND(SrcbeddoesData%OLDXN,2)
   i2_u = UBOUND(SrcbeddoesData%OLDXN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDXN)) THEN 
      ALLOCATE(DstbeddoesData%OLDXN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDXN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDXN = SrcbeddoesData%OLDXN
ENDIF
IF (ALLOCATED(SrcbeddoesData%OLDYN)) THEN
   i1_l = LBOUND(SrcbeddoesData%OLDYN,1)
   i1_u = UBOUND(SrcbeddoesData%OLDYN,1)
   i2_l = LBOUND(SrcbeddoesData%OLDYN,2)
   i2_u = UBOUND(SrcbeddoesData%OLDYN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%OLDYN)) THEN 
      ALLOCATE(DstbeddoesData%OLDYN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%OLDYN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%OLDYN = SrcbeddoesData%OLDYN
ENDIF
IF (ALLOCATED(SrcbeddoesData%QX)) THEN
   i1_l = LBOUND(SrcbeddoesData%QX,1)
   i1_u = UBOUND(SrcbeddoesData%QX,1)
   i2_l = LBOUND(SrcbeddoesData%QX,2)
   i2_u = UBOUND(SrcbeddoesData%QX,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%QX)) THEN 
      ALLOCATE(DstbeddoesData%QX(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%QX.'
         RETURN
      END IF
   END IF
   DstbeddoesData%QX = SrcbeddoesData%QX
ENDIF
IF (ALLOCATED(SrcbeddoesData%QX1)) THEN
   i1_l = LBOUND(SrcbeddoesData%QX1,1)
   i1_u = UBOUND(SrcbeddoesData%QX1,1)
   i2_l = LBOUND(SrcbeddoesData%QX1,2)
   i2_u = UBOUND(SrcbeddoesData%QX1,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%QX1)) THEN 
      ALLOCATE(DstbeddoesData%QX1(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%QX1.'
         RETURN
      END IF
   END IF
   DstbeddoesData%QX1 = SrcbeddoesData%QX1
ENDIF
IF (ALLOCATED(SrcbeddoesData%TAU)) THEN
   i1_l = LBOUND(SrcbeddoesData%TAU,1)
   i1_u = UBOUND(SrcbeddoesData%TAU,1)
   i2_l = LBOUND(SrcbeddoesData%TAU,2)
   i2_u = UBOUND(SrcbeddoesData%TAU,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%TAU)) THEN 
      ALLOCATE(DstbeddoesData%TAU(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%TAU.'
         RETURN
      END IF
   END IF
   DstbeddoesData%TAU = SrcbeddoesData%TAU
ENDIF
IF (ALLOCATED(SrcbeddoesData%XN)) THEN
   i1_l = LBOUND(SrcbeddoesData%XN,1)
   i1_u = UBOUND(SrcbeddoesData%XN,1)
   i2_l = LBOUND(SrcbeddoesData%XN,2)
   i2_u = UBOUND(SrcbeddoesData%XN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%XN)) THEN 
      ALLOCATE(DstbeddoesData%XN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%XN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%XN = SrcbeddoesData%XN
ENDIF
IF (ALLOCATED(SrcbeddoesData%YN)) THEN
   i1_l = LBOUND(SrcbeddoesData%YN,1)
   i1_u = UBOUND(SrcbeddoesData%YN,1)
   i2_l = LBOUND(SrcbeddoesData%YN,2)
   i2_u = UBOUND(SrcbeddoesData%YN,2)
   IF (.NOT.ALLOCATED(DstbeddoesData%YN)) THEN 
      ALLOCATE(DstbeddoesData%YN(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybeddoes: Error allocating DstbeddoesData%YN.'
         RETURN
      END IF
   END IF
   DstbeddoesData%YN = SrcbeddoesData%YN
ENDIF
   DstbeddoesData%SHIFT = SrcbeddoesData%SHIFT
   DstbeddoesData%VOR = SrcbeddoesData%VOR
 END SUBROUTINE AD_Copybeddoes

 SUBROUTINE AD_Destroybeddoes( beddoesData, ErrStat, ErrMsg )
  TYPE(beddoes), INTENT(INOUT) :: beddoesData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(beddoesData%ADOT)) THEN
   DEALLOCATE(beddoesData%ADOT)
ENDIF
IF (ALLOCATED(beddoesData%ADOT1)) THEN
   DEALLOCATE(beddoesData%ADOT1)
ENDIF
IF (ALLOCATED(beddoesData%AFE)) THEN
   DEALLOCATE(beddoesData%AFE)
ENDIF
IF (ALLOCATED(beddoesData%AFE1)) THEN
   DEALLOCATE(beddoesData%AFE1)
ENDIF
IF (ALLOCATED(beddoesData%ANE)) THEN
   DEALLOCATE(beddoesData%ANE)
ENDIF
IF (ALLOCATED(beddoesData%ANE1)) THEN
   DEALLOCATE(beddoesData%ANE1)
ENDIF
IF (ALLOCATED(beddoesData%AOD)) THEN
   DEALLOCATE(beddoesData%AOD)
ENDIF
IF (ALLOCATED(beddoesData%AOL)) THEN
   DEALLOCATE(beddoesData%AOL)
ENDIF
IF (ALLOCATED(beddoesData%BEDSEP)) THEN
   DEALLOCATE(beddoesData%BEDSEP)
ENDIF
IF (ALLOCATED(beddoesData%OLDSEP)) THEN
   DEALLOCATE(beddoesData%OLDSEP)
ENDIF
IF (ALLOCATED(beddoesData%CDO)) THEN
   DEALLOCATE(beddoesData%CDO)
ENDIF
IF (ALLOCATED(beddoesData%CNA)) THEN
   DEALLOCATE(beddoesData%CNA)
ENDIF
IF (ALLOCATED(beddoesData%CNP)) THEN
   DEALLOCATE(beddoesData%CNP)
ENDIF
IF (ALLOCATED(beddoesData%CNP1)) THEN
   DEALLOCATE(beddoesData%CNP1)
ENDIF
IF (ALLOCATED(beddoesData%CNPD)) THEN
   DEALLOCATE(beddoesData%CNPD)
ENDIF
IF (ALLOCATED(beddoesData%CNPD1)) THEN
   DEALLOCATE(beddoesData%CNPD1)
ENDIF
IF (ALLOCATED(beddoesData%CNPOT)) THEN
   DEALLOCATE(beddoesData%CNPOT)
ENDIF
IF (ALLOCATED(beddoesData%CNPOT1)) THEN
   DEALLOCATE(beddoesData%CNPOT1)
ENDIF
IF (ALLOCATED(beddoesData%CNS)) THEN
   DEALLOCATE(beddoesData%CNS)
ENDIF
IF (ALLOCATED(beddoesData%CNSL)) THEN
   DEALLOCATE(beddoesData%CNSL)
ENDIF
IF (ALLOCATED(beddoesData%CNV)) THEN
   DEALLOCATE(beddoesData%CNV)
ENDIF
IF (ALLOCATED(beddoesData%CVN)) THEN
   DEALLOCATE(beddoesData%CVN)
ENDIF
IF (ALLOCATED(beddoesData%CVN1)) THEN
   DEALLOCATE(beddoesData%CVN1)
ENDIF
IF (ALLOCATED(beddoesData%DF)) THEN
   DEALLOCATE(beddoesData%DF)
ENDIF
IF (ALLOCATED(beddoesData%DFAFE)) THEN
   DEALLOCATE(beddoesData%DFAFE)
ENDIF
IF (ALLOCATED(beddoesData%DFAFE1)) THEN
   DEALLOCATE(beddoesData%DFAFE1)
ENDIF
IF (ALLOCATED(beddoesData%DFC)) THEN
   DEALLOCATE(beddoesData%DFC)
ENDIF
IF (ALLOCATED(beddoesData%DN)) THEN
   DEALLOCATE(beddoesData%DN)
ENDIF
IF (ALLOCATED(beddoesData%DPP)) THEN
   DEALLOCATE(beddoesData%DPP)
ENDIF
IF (ALLOCATED(beddoesData%DQ)) THEN
   DEALLOCATE(beddoesData%DQ)
ENDIF
IF (ALLOCATED(beddoesData%DQP)) THEN
   DEALLOCATE(beddoesData%DQP)
ENDIF
IF (ALLOCATED(beddoesData%DQP1)) THEN
   DEALLOCATE(beddoesData%DQP1)
ENDIF
IF (ALLOCATED(beddoesData%FSP)) THEN
   DEALLOCATE(beddoesData%FSP)
ENDIF
IF (ALLOCATED(beddoesData%FSP1)) THEN
   DEALLOCATE(beddoesData%FSP1)
ENDIF
IF (ALLOCATED(beddoesData%FSPC)) THEN
   DEALLOCATE(beddoesData%FSPC)
ENDIF
IF (ALLOCATED(beddoesData%FSPC1)) THEN
   DEALLOCATE(beddoesData%FSPC1)
ENDIF
IF (ALLOCATED(beddoesData%FTB)) THEN
   DEALLOCATE(beddoesData%FTB)
ENDIF
IF (ALLOCATED(beddoesData%FTBC)) THEN
   DEALLOCATE(beddoesData%FTBC)
ENDIF
IF (ALLOCATED(beddoesData%OLDCNV)) THEN
   DEALLOCATE(beddoesData%OLDCNV)
ENDIF
IF (ALLOCATED(beddoesData%OLDDF)) THEN
   DEALLOCATE(beddoesData%OLDDF)
ENDIF
IF (ALLOCATED(beddoesData%OLDDFC)) THEN
   DEALLOCATE(beddoesData%OLDDFC)
ENDIF
IF (ALLOCATED(beddoesData%OLDDN)) THEN
   DEALLOCATE(beddoesData%OLDDN)
ENDIF
IF (ALLOCATED(beddoesData%OLDDPP)) THEN
   DEALLOCATE(beddoesData%OLDDPP)
ENDIF
IF (ALLOCATED(beddoesData%OLDDQ)) THEN
   DEALLOCATE(beddoesData%OLDDQ)
ENDIF
IF (ALLOCATED(beddoesData%OLDTAU)) THEN
   DEALLOCATE(beddoesData%OLDTAU)
ENDIF
IF (ALLOCATED(beddoesData%OLDXN)) THEN
   DEALLOCATE(beddoesData%OLDXN)
ENDIF
IF (ALLOCATED(beddoesData%OLDYN)) THEN
   DEALLOCATE(beddoesData%OLDYN)
ENDIF
IF (ALLOCATED(beddoesData%QX)) THEN
   DEALLOCATE(beddoesData%QX)
ENDIF
IF (ALLOCATED(beddoesData%QX1)) THEN
   DEALLOCATE(beddoesData%QX1)
ENDIF
IF (ALLOCATED(beddoesData%TAU)) THEN
   DEALLOCATE(beddoesData%TAU)
ENDIF
IF (ALLOCATED(beddoesData%XN)) THEN
   DEALLOCATE(beddoesData%XN)
ENDIF
IF (ALLOCATED(beddoesData%YN)) THEN
   DEALLOCATE(beddoesData%YN)
ENDIF
 END SUBROUTINE AD_Destroybeddoes

 SUBROUTINE AD_Packbeddoes( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(beddoes),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%ADOT )  ! ADOT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%ADOT1 )  ! ADOT1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AFE )  ! AFE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AFE1 )  ! AFE1 
  Re_BufSz   = Re_BufSz   + 1  ! AN
  Re_BufSz    = Re_BufSz    + SIZE( InData%ANE )  ! ANE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%ANE1 )  ! ANE1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AOD )  ! AOD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AOL )  ! AOL 
  Re_BufSz   = Re_BufSz   + 1  ! CC
  Re_BufSz    = Re_BufSz    + SIZE( InData%CDO )  ! CDO 
  Re_BufSz   = Re_BufSz   + 1  ! CMI
  Re_BufSz   = Re_BufSz   + 1  ! CMQ
  Re_BufSz   = Re_BufSz   + 1  ! CN
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNA )  ! CNA 
  Re_BufSz   = Re_BufSz   + 1  ! CNCP
  Re_BufSz   = Re_BufSz   + 1  ! CNIQ
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNP )  ! CNP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNP1 )  ! CNP1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNPD )  ! CNPD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNPD1 )  ! CNPD1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNPOT )  ! CNPOT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNPOT1 )  ! CNPOT1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNS )  ! CNS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNSL )  ! CNSL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNV )  ! CNV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CVN )  ! CVN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CVN1 )  ! CVN1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DF )  ! DF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DFAFE )  ! DFAFE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DFAFE1 )  ! DFAFE1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DFC )  ! DFC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DN )  ! DN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DPP )  ! DPP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DQ )  ! DQ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DQP )  ! DQP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DQP1 )  ! DQP1 
  Re_BufSz   = Re_BufSz   + 1  ! DS
  Re_BufSz   = Re_BufSz   + 1  ! FK
  Re_BufSz   = Re_BufSz   + 1  ! FP
  Re_BufSz   = Re_BufSz   + 1  ! FPC
  Re_BufSz    = Re_BufSz    + SIZE( InData%FSP )  ! FSP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FSP1 )  ! FSP1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FSPC )  ! FSPC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FSPC1 )  ! FSPC1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FTB )  ! FTB 
  Re_BufSz    = Re_BufSz    + SIZE( InData%FTBC )  ! FTBC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDCNV )  ! OLDCNV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDF )  ! OLDDF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDFC )  ! OLDDFC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDN )  ! OLDDN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDPP )  ! OLDDPP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDDQ )  ! OLDDQ 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDTAU )  ! OLDTAU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDXN )  ! OLDXN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLDYN )  ! OLDYN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%QX )  ! QX 
  Re_BufSz    = Re_BufSz    + SIZE( InData%QX1 )  ! QX1 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TAU )  ! TAU 
  Re_BufSz    = Re_BufSz    + SIZE( InData%XN )  ! XN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%YN )  ! YN 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%ADOT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ADOT))-1 ) =  PACK(InData%ADOT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ADOT)
  ENDIF
  IF ( ALLOCATED(InData%ADOT1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ADOT1))-1 ) =  PACK(InData%ADOT1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ADOT1)
  ENDIF
  IF ( ALLOCATED(InData%AFE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AFE))-1 ) =  PACK(InData%AFE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AFE)
  ENDIF
  IF ( ALLOCATED(InData%AFE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AFE1))-1 ) =  PACK(InData%AFE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AFE1)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AN )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%ANE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ANE))-1 ) =  PACK(InData%ANE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ANE)
  ENDIF
  IF ( ALLOCATED(InData%ANE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ANE1))-1 ) =  PACK(InData%ANE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ANE1)
  ENDIF
  IF ( ALLOCATED(InData%AOD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AOD))-1 ) =  PACK(InData%AOD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AOD)
  ENDIF
  IF ( ALLOCATED(InData%AOL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AOL))-1 ) =  PACK(InData%AOL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AOL)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CDO) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CDO))-1 ) =  PACK(InData%CDO ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CDO)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CMI )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CMQ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CN )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CNA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNA))-1 ) =  PACK(InData%CNA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNA)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CNCP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CNIQ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%CNP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNP))-1 ) =  PACK(InData%CNP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNP)
  ENDIF
  IF ( ALLOCATED(InData%CNP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNP1))-1 ) =  PACK(InData%CNP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNP1)
  ENDIF
  IF ( ALLOCATED(InData%CNPD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPD))-1 ) =  PACK(InData%CNPD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPD)
  ENDIF
  IF ( ALLOCATED(InData%CNPD1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPD1))-1 ) =  PACK(InData%CNPD1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPD1)
  ENDIF
  IF ( ALLOCATED(InData%CNPOT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPOT))-1 ) =  PACK(InData%CNPOT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPOT)
  ENDIF
  IF ( ALLOCATED(InData%CNPOT1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNPOT1))-1 ) =  PACK(InData%CNPOT1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNPOT1)
  ENDIF
  IF ( ALLOCATED(InData%CNS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNS))-1 ) =  PACK(InData%CNS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNS)
  ENDIF
  IF ( ALLOCATED(InData%CNSL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNSL))-1 ) =  PACK(InData%CNSL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNSL)
  ENDIF
  IF ( ALLOCATED(InData%CNV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNV))-1 ) =  PACK(InData%CNV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNV)
  ENDIF
  IF ( ALLOCATED(InData%CVN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CVN))-1 ) =  PACK(InData%CVN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CVN)
  ENDIF
  IF ( ALLOCATED(InData%CVN1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CVN1))-1 ) =  PACK(InData%CVN1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CVN1)
  ENDIF
  IF ( ALLOCATED(InData%DF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DF))-1 ) =  PACK(InData%DF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DF)
  ENDIF
  IF ( ALLOCATED(InData%DFAFE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFAFE))-1 ) =  PACK(InData%DFAFE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFAFE)
  ENDIF
  IF ( ALLOCATED(InData%DFAFE1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFAFE1))-1 ) =  PACK(InData%DFAFE1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFAFE1)
  ENDIF
  IF ( ALLOCATED(InData%DFC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFC))-1 ) =  PACK(InData%DFC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFC)
  ENDIF
  IF ( ALLOCATED(InData%DN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DN))-1 ) =  PACK(InData%DN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DN)
  ENDIF
  IF ( ALLOCATED(InData%DPP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DPP))-1 ) =  PACK(InData%DPP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DPP)
  ENDIF
  IF ( ALLOCATED(InData%DQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQ))-1 ) =  PACK(InData%DQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQ)
  ENDIF
  IF ( ALLOCATED(InData%DQP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQP))-1 ) =  PACK(InData%DQP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQP)
  ENDIF
  IF ( ALLOCATED(InData%DQP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DQP1))-1 ) =  PACK(InData%DQP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DQP1)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FK )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%FPC )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%FSP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSP))-1 ) =  PACK(InData%FSP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSP)
  ENDIF
  IF ( ALLOCATED(InData%FSP1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSP1))-1 ) =  PACK(InData%FSP1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSP1)
  ENDIF
  IF ( ALLOCATED(InData%FSPC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSPC))-1 ) =  PACK(InData%FSPC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSPC)
  ENDIF
  IF ( ALLOCATED(InData%FSPC1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FSPC1))-1 ) =  PACK(InData%FSPC1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FSPC1)
  ENDIF
  IF ( ALLOCATED(InData%FTB) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTB))-1 ) =  PACK(InData%FTB ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTB)
  ENDIF
  IF ( ALLOCATED(InData%FTBC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%FTBC))-1 ) =  PACK(InData%FTBC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%FTBC)
  ENDIF
  IF ( ALLOCATED(InData%OLDCNV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDCNV))-1 ) =  PACK(InData%OLDCNV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDCNV)
  ENDIF
  IF ( ALLOCATED(InData%OLDDF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDF))-1 ) =  PACK(InData%OLDDF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDF)
  ENDIF
  IF ( ALLOCATED(InData%OLDDFC) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDFC))-1 ) =  PACK(InData%OLDDFC ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDFC)
  ENDIF
  IF ( ALLOCATED(InData%OLDDN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDN))-1 ) =  PACK(InData%OLDDN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDN)
  ENDIF
  IF ( ALLOCATED(InData%OLDDPP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDPP))-1 ) =  PACK(InData%OLDDPP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDPP)
  ENDIF
  IF ( ALLOCATED(InData%OLDDQ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDDQ))-1 ) =  PACK(InData%OLDDQ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDDQ)
  ENDIF
  IF ( ALLOCATED(InData%OLDTAU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDTAU))-1 ) =  PACK(InData%OLDTAU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDTAU)
  ENDIF
  IF ( ALLOCATED(InData%OLDXN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDXN))-1 ) =  PACK(InData%OLDXN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDXN)
  ENDIF
  IF ( ALLOCATED(InData%OLDYN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLDYN))-1 ) =  PACK(InData%OLDYN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLDYN)
  ENDIF
  IF ( ALLOCATED(InData%QX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QX))-1 ) =  PACK(InData%QX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QX)
  ENDIF
  IF ( ALLOCATED(InData%QX1) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%QX1))-1 ) =  PACK(InData%QX1 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%QX1)
  ENDIF
  IF ( ALLOCATED(InData%TAU) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TAU))-1 ) =  PACK(InData%TAU ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TAU)
  ENDIF
  IF ( ALLOCATED(InData%XN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%XN))-1 ) =  PACK(InData%XN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%XN)
  ENDIF
  IF ( ALLOCATED(InData%YN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%YN))-1 ) =  PACK(InData%YN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%YN)
  ENDIF
 END SUBROUTINE AD_Packbeddoes

 SUBROUTINE AD_UnPackbeddoes( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(beddoes), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%ADOT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ADOT,1),SIZE(OutData%ADOT,2))); mask2 = .TRUE.
    OutData%ADOT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ADOT))-1 ),mask2,OutData%ADOT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ADOT)
  ENDIF
  IF ( ALLOCATED(OutData%ADOT1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ADOT1,1),SIZE(OutData%ADOT1,2))); mask2 = .TRUE.
    OutData%ADOT1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ADOT1))-1 ),mask2,OutData%ADOT1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ADOT1)
  ENDIF
  IF ( ALLOCATED(OutData%AFE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AFE,1),SIZE(OutData%AFE,2))); mask2 = .TRUE.
    OutData%AFE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AFE))-1 ),mask2,OutData%AFE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AFE)
  ENDIF
  IF ( ALLOCATED(OutData%AFE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AFE1,1),SIZE(OutData%AFE1,2))); mask2 = .TRUE.
    OutData%AFE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AFE1))-1 ),mask2,OutData%AFE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AFE1)
  ENDIF
  OutData%AN = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%ANE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ANE,1),SIZE(OutData%ANE,2))); mask2 = .TRUE.
    OutData%ANE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ANE))-1 ),mask2,OutData%ANE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ANE)
  ENDIF
  IF ( ALLOCATED(OutData%ANE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ANE1,1),SIZE(OutData%ANE1,2))); mask2 = .TRUE.
    OutData%ANE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ANE1))-1 ),mask2,OutData%ANE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ANE1)
  ENDIF
  IF ( ALLOCATED(OutData%AOD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AOD,1),SIZE(OutData%AOD,2))); mask2 = .TRUE.
    OutData%AOD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AOD))-1 ),mask2,OutData%AOD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AOD)
  ENDIF
  IF ( ALLOCATED(OutData%AOL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AOL,1),SIZE(OutData%AOL,2))); mask2 = .TRUE.
    OutData%AOL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AOL))-1 ),mask2,OutData%AOL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AOL)
  ENDIF
  OutData%CC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CDO) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CDO,1),SIZE(OutData%CDO,2))); mask2 = .TRUE.
    OutData%CDO = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CDO))-1 ),mask2,OutData%CDO)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CDO)
  ENDIF
  OutData%CMI = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CMQ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CN = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CNA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNA,1),SIZE(OutData%CNA,2))); mask2 = .TRUE.
    OutData%CNA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNA))-1 ),mask2,OutData%CNA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNA)
  ENDIF
  OutData%CNCP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CNIQ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%CNP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNP,1),SIZE(OutData%CNP,2))); mask2 = .TRUE.
    OutData%CNP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNP))-1 ),mask2,OutData%CNP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNP)
  ENDIF
  IF ( ALLOCATED(OutData%CNP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNP1,1),SIZE(OutData%CNP1,2))); mask2 = .TRUE.
    OutData%CNP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNP1))-1 ),mask2,OutData%CNP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNP1)
  ENDIF
  IF ( ALLOCATED(OutData%CNPD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPD,1),SIZE(OutData%CNPD,2))); mask2 = .TRUE.
    OutData%CNPD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPD))-1 ),mask2,OutData%CNPD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPD)
  ENDIF
  IF ( ALLOCATED(OutData%CNPD1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPD1,1),SIZE(OutData%CNPD1,2))); mask2 = .TRUE.
    OutData%CNPD1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPD1))-1 ),mask2,OutData%CNPD1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPD1)
  ENDIF
  IF ( ALLOCATED(OutData%CNPOT) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPOT,1),SIZE(OutData%CNPOT,2))); mask2 = .TRUE.
    OutData%CNPOT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPOT))-1 ),mask2,OutData%CNPOT)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPOT)
  ENDIF
  IF ( ALLOCATED(OutData%CNPOT1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNPOT1,1),SIZE(OutData%CNPOT1,2))); mask2 = .TRUE.
    OutData%CNPOT1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNPOT1))-1 ),mask2,OutData%CNPOT1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNPOT1)
  ENDIF
  IF ( ALLOCATED(OutData%CNS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNS,1),SIZE(OutData%CNS,2))); mask2 = .TRUE.
    OutData%CNS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNS))-1 ),mask2,OutData%CNS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNS)
  ENDIF
  IF ( ALLOCATED(OutData%CNSL) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNSL,1),SIZE(OutData%CNSL,2))); mask2 = .TRUE.
    OutData%CNSL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNSL))-1 ),mask2,OutData%CNSL)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNSL)
  ENDIF
  IF ( ALLOCATED(OutData%CNV) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CNV,1),SIZE(OutData%CNV,2))); mask2 = .TRUE.
    OutData%CNV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNV))-1 ),mask2,OutData%CNV)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNV)
  ENDIF
  IF ( ALLOCATED(OutData%CVN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CVN,1),SIZE(OutData%CVN,2))); mask2 = .TRUE.
    OutData%CVN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CVN))-1 ),mask2,OutData%CVN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CVN)
  ENDIF
  IF ( ALLOCATED(OutData%CVN1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%CVN1,1),SIZE(OutData%CVN1,2))); mask2 = .TRUE.
    OutData%CVN1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CVN1))-1 ),mask2,OutData%CVN1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CVN1)
  ENDIF
  IF ( ALLOCATED(OutData%DF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DF,1),SIZE(OutData%DF,2))); mask2 = .TRUE.
    OutData%DF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DF))-1 ),mask2,OutData%DF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DF)
  ENDIF
  IF ( ALLOCATED(OutData%DFAFE) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFAFE,1),SIZE(OutData%DFAFE,2))); mask2 = .TRUE.
    OutData%DFAFE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFAFE))-1 ),mask2,OutData%DFAFE)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFAFE)
  ENDIF
  IF ( ALLOCATED(OutData%DFAFE1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFAFE1,1),SIZE(OutData%DFAFE1,2))); mask2 = .TRUE.
    OutData%DFAFE1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFAFE1))-1 ),mask2,OutData%DFAFE1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFAFE1)
  ENDIF
  IF ( ALLOCATED(OutData%DFC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DFC,1),SIZE(OutData%DFC,2))); mask2 = .TRUE.
    OutData%DFC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFC))-1 ),mask2,OutData%DFC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFC)
  ENDIF
  IF ( ALLOCATED(OutData%DN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DN,1),SIZE(OutData%DN,2))); mask2 = .TRUE.
    OutData%DN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DN))-1 ),mask2,OutData%DN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DN)
  ENDIF
  IF ( ALLOCATED(OutData%DPP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DPP,1),SIZE(OutData%DPP,2))); mask2 = .TRUE.
    OutData%DPP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DPP))-1 ),mask2,OutData%DPP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DPP)
  ENDIF
  IF ( ALLOCATED(OutData%DQ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQ,1),SIZE(OutData%DQ,2))); mask2 = .TRUE.
    OutData%DQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQ))-1 ),mask2,OutData%DQ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQ)
  ENDIF
  IF ( ALLOCATED(OutData%DQP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQP,1),SIZE(OutData%DQP,2))); mask2 = .TRUE.
    OutData%DQP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQP))-1 ),mask2,OutData%DQP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQP)
  ENDIF
  IF ( ALLOCATED(OutData%DQP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%DQP1,1),SIZE(OutData%DQP1,2))); mask2 = .TRUE.
    OutData%DQP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DQP1))-1 ),mask2,OutData%DQP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DQP1)
  ENDIF
  OutData%DS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FK = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%FPC = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%FSP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSP,1),SIZE(OutData%FSP,2))); mask2 = .TRUE.
    OutData%FSP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSP))-1 ),mask2,OutData%FSP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSP)
  ENDIF
  IF ( ALLOCATED(OutData%FSP1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSP1,1),SIZE(OutData%FSP1,2))); mask2 = .TRUE.
    OutData%FSP1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSP1))-1 ),mask2,OutData%FSP1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSP1)
  ENDIF
  IF ( ALLOCATED(OutData%FSPC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSPC,1),SIZE(OutData%FSPC,2))); mask2 = .TRUE.
    OutData%FSPC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSPC))-1 ),mask2,OutData%FSPC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSPC)
  ENDIF
  IF ( ALLOCATED(OutData%FSPC1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%FSPC1,1),SIZE(OutData%FSPC1,2))); mask2 = .TRUE.
    OutData%FSPC1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FSPC1))-1 ),mask2,OutData%FSPC1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FSPC1)
  ENDIF
  IF ( ALLOCATED(OutData%FTB) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FTB,1),SIZE(OutData%FTB,2),SIZE(OutData%FTB,3))); mask3 = .TRUE.
    OutData%FTB = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTB))-1 ),mask3,OutData%FTB)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTB)
  ENDIF
  IF ( ALLOCATED(OutData%FTBC) ) THEN
  ALLOCATE(mask3(SIZE(OutData%FTBC,1),SIZE(OutData%FTBC,2),SIZE(OutData%FTBC,3))); mask3 = .TRUE.
    OutData%FTBC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%FTBC))-1 ),mask3,OutData%FTBC)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%FTBC)
  ENDIF
  IF ( ALLOCATED(OutData%OLDCNV) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDCNV,1),SIZE(OutData%OLDCNV,2))); mask2 = .TRUE.
    OutData%OLDCNV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDCNV))-1 ),mask2,OutData%OLDCNV)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDCNV)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDF) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDF,1),SIZE(OutData%OLDDF,2))); mask2 = .TRUE.
    OutData%OLDDF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDF))-1 ),mask2,OutData%OLDDF)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDF)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDFC) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDFC,1),SIZE(OutData%OLDDFC,2))); mask2 = .TRUE.
    OutData%OLDDFC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDFC))-1 ),mask2,OutData%OLDDFC)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDFC)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDN,1),SIZE(OutData%OLDDN,2))); mask2 = .TRUE.
    OutData%OLDDN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDN))-1 ),mask2,OutData%OLDDN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDN)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDPP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDPP,1),SIZE(OutData%OLDDPP,2))); mask2 = .TRUE.
    OutData%OLDDPP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDPP))-1 ),mask2,OutData%OLDDPP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDPP)
  ENDIF
  IF ( ALLOCATED(OutData%OLDDQ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDDQ,1),SIZE(OutData%OLDDQ,2))); mask2 = .TRUE.
    OutData%OLDDQ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDDQ))-1 ),mask2,OutData%OLDDQ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDDQ)
  ENDIF
  IF ( ALLOCATED(OutData%OLDTAU) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDTAU,1),SIZE(OutData%OLDTAU,2))); mask2 = .TRUE.
    OutData%OLDTAU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDTAU))-1 ),mask2,OutData%OLDTAU)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDTAU)
  ENDIF
  IF ( ALLOCATED(OutData%OLDXN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDXN,1),SIZE(OutData%OLDXN,2))); mask2 = .TRUE.
    OutData%OLDXN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDXN))-1 ),mask2,OutData%OLDXN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDXN)
  ENDIF
  IF ( ALLOCATED(OutData%OLDYN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLDYN,1),SIZE(OutData%OLDYN,2))); mask2 = .TRUE.
    OutData%OLDYN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLDYN))-1 ),mask2,OutData%OLDYN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLDYN)
  ENDIF
  IF ( ALLOCATED(OutData%QX) ) THEN
  ALLOCATE(mask2(SIZE(OutData%QX,1),SIZE(OutData%QX,2))); mask2 = .TRUE.
    OutData%QX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QX))-1 ),mask2,OutData%QX)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QX)
  ENDIF
  IF ( ALLOCATED(OutData%QX1) ) THEN
  ALLOCATE(mask2(SIZE(OutData%QX1,1),SIZE(OutData%QX1,2))); mask2 = .TRUE.
    OutData%QX1 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%QX1))-1 ),mask2,OutData%QX1)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%QX1)
  ENDIF
  IF ( ALLOCATED(OutData%TAU) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TAU,1),SIZE(OutData%TAU,2))); mask2 = .TRUE.
    OutData%TAU = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TAU))-1 ),mask2,OutData%TAU)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TAU)
  ENDIF
  IF ( ALLOCATED(OutData%XN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%XN,1),SIZE(OutData%XN,2))); mask2 = .TRUE.
    OutData%XN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%XN))-1 ),mask2,OutData%XN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%XN)
  ENDIF
  IF ( ALLOCATED(OutData%YN) ) THEN
  ALLOCATE(mask2(SIZE(OutData%YN,1),SIZE(OutData%YN,2))); mask2 = .TRUE.
    OutData%YN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%YN))-1 ),mask2,OutData%YN)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%YN)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackbeddoes

 SUBROUTINE AD_Copybeddoesparms( SrcbeddoesparmsData, DstbeddoesparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(beddoesparms), INTENT(INOUT) :: SrcbeddoesparmsData
   TYPE(beddoesparms), INTENT(INOUT) :: DstbeddoesparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstbeddoesparmsData%AS = SrcbeddoesparmsData%AS
   DstbeddoesparmsData%TF = SrcbeddoesparmsData%TF
   DstbeddoesparmsData%TP = SrcbeddoesparmsData%TP
   DstbeddoesparmsData%TV = SrcbeddoesparmsData%TV
   DstbeddoesparmsData%TVL = SrcbeddoesparmsData%TVL
 END SUBROUTINE AD_Copybeddoesparms

 SUBROUTINE AD_Destroybeddoesparms( beddoesparmsData, ErrStat, ErrMsg )
  TYPE(beddoesparms), INTENT(INOUT) :: beddoesparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroybeddoesparms

 SUBROUTINE AD_Packbeddoesparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(beddoesparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AS
  Re_BufSz   = Re_BufSz   + 1  ! TF
  Re_BufSz   = Re_BufSz   + 1  ! TP
  Re_BufSz   = Re_BufSz   + 1  ! TV
  Re_BufSz   = Re_BufSz   + 1  ! TVL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TF )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TP )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TVL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packbeddoesparms

 SUBROUTINE AD_UnPackbeddoesparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(beddoesparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TF = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TP = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TVL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackbeddoesparms

 SUBROUTINE AD_Copybladeparms( SrcbladeparmsData, DstbladeparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(bladeparms), INTENT(INOUT) :: SrcbladeparmsData
   TYPE(bladeparms), INTENT(INOUT) :: DstbladeparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcbladeparmsData%C)) THEN
   i1_l = LBOUND(SrcbladeparmsData%C,1)
   i1_u = UBOUND(SrcbladeparmsData%C,1)
   IF (.NOT.ALLOCATED(DstbladeparmsData%C)) THEN 
      ALLOCATE(DstbladeparmsData%C(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybladeparms: Error allocating DstbladeparmsData%C.'
         RETURN
      END IF
   END IF
   DstbladeparmsData%C = SrcbladeparmsData%C
ENDIF
IF (ALLOCATED(SrcbladeparmsData%DR)) THEN
   i1_l = LBOUND(SrcbladeparmsData%DR,1)
   i1_u = UBOUND(SrcbladeparmsData%DR,1)
   IF (.NOT.ALLOCATED(DstbladeparmsData%DR)) THEN 
      ALLOCATE(DstbladeparmsData%DR(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copybladeparms: Error allocating DstbladeparmsData%DR.'
         RETURN
      END IF
   END IF
   DstbladeparmsData%DR = SrcbladeparmsData%DR
ENDIF
   DstbladeparmsData%R = SrcbladeparmsData%R
   DstbladeparmsData%BladeLength = SrcbladeparmsData%BladeLength
   DstbladeparmsData%NB = SrcbladeparmsData%NB
 END SUBROUTINE AD_Copybladeparms

 SUBROUTINE AD_Destroybladeparms( bladeparmsData, ErrStat, ErrMsg )
  TYPE(bladeparms), INTENT(INOUT) :: bladeparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(bladeparmsData%C)) THEN
   DEALLOCATE(bladeparmsData%C)
ENDIF
IF (ALLOCATED(bladeparmsData%DR)) THEN
   DEALLOCATE(bladeparmsData%DR)
ENDIF
 END SUBROUTINE AD_Destroybladeparms

 SUBROUTINE AD_Packbladeparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(bladeparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%C )  ! C 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DR )  ! DR 
  Re_BufSz   = Re_BufSz   + 1  ! R
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  Int_BufSz  = Int_BufSz  + 1  ! NB
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%C) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%C))-1 ) =  PACK(InData%C ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%C)
  ENDIF
  IF ( ALLOCATED(InData%DR) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DR))-1 ) =  PACK(InData%DR ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DR)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%R )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NB )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_Packbladeparms

 SUBROUTINE AD_UnPackbladeparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(bladeparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%C) ) THEN
  ALLOCATE(mask1(SIZE(OutData%C,1))); mask1 = .TRUE.
    OutData%C = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%C))-1 ),mask1,OutData%C)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%C)
  ENDIF
  IF ( ALLOCATED(OutData%DR) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DR,1))); mask1 = .TRUE.
    OutData%DR = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DR))-1 ),mask1,OutData%DR)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DR)
  ENDIF
  OutData%R = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NB = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackbladeparms

 SUBROUTINE AD_Copydyninflow( SrcdyninflowData, DstdyninflowData, CtrlCode, ErrStat, ErrMsg )
   TYPE(dyninflow), INTENT(INOUT) :: SrcdyninflowData
   TYPE(dyninflow), INTENT(INOUT) :: DstdyninflowData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstdyninflowData%dAlph_dt = SrcdyninflowData%dAlph_dt
   DstdyninflowData%dBeta_dt = SrcdyninflowData%dBeta_dt
   DstdyninflowData%DTO = SrcdyninflowData%DTO
   DstdyninflowData%old_Alph = SrcdyninflowData%old_Alph
   DstdyninflowData%old_Beta = SrcdyninflowData%old_Beta
   DstdyninflowData%old_LmdM = SrcdyninflowData%old_LmdM
   DstdyninflowData%oldKai = SrcdyninflowData%oldKai
   DstdyninflowData%PhiLqC = SrcdyninflowData%PhiLqC
   DstdyninflowData%PhiLqS = SrcdyninflowData%PhiLqS
   DstdyninflowData%Pzero = SrcdyninflowData%Pzero
IF (ALLOCATED(SrcdyninflowData%RMC_SAVE)) THEN
   i1_l = LBOUND(SrcdyninflowData%RMC_SAVE,1)
   i1_u = UBOUND(SrcdyninflowData%RMC_SAVE,1)
   i2_l = LBOUND(SrcdyninflowData%RMC_SAVE,2)
   i2_u = UBOUND(SrcdyninflowData%RMC_SAVE,2)
   i3_l = LBOUND(SrcdyninflowData%RMC_SAVE,3)
   i3_u = UBOUND(SrcdyninflowData%RMC_SAVE,3)
   IF (.NOT.ALLOCATED(DstdyninflowData%RMC_SAVE)) THEN 
      ALLOCATE(DstdyninflowData%RMC_SAVE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copydyninflow: Error allocating DstdyninflowData%RMC_SAVE.'
         RETURN
      END IF
   END IF
   DstdyninflowData%RMC_SAVE = SrcdyninflowData%RMC_SAVE
ENDIF
IF (ALLOCATED(SrcdyninflowData%RMS_SAVE)) THEN
   i1_l = LBOUND(SrcdyninflowData%RMS_SAVE,1)
   i1_u = UBOUND(SrcdyninflowData%RMS_SAVE,1)
   i2_l = LBOUND(SrcdyninflowData%RMS_SAVE,2)
   i2_u = UBOUND(SrcdyninflowData%RMS_SAVE,2)
   i3_l = LBOUND(SrcdyninflowData%RMS_SAVE,3)
   i3_u = UBOUND(SrcdyninflowData%RMS_SAVE,3)
   IF (.NOT.ALLOCATED(DstdyninflowData%RMS_SAVE)) THEN 
      ALLOCATE(DstdyninflowData%RMS_SAVE(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copydyninflow: Error allocating DstdyninflowData%RMS_SAVE.'
         RETURN
      END IF
   END IF
   DstdyninflowData%RMS_SAVE = SrcdyninflowData%RMS_SAVE
ENDIF
   DstdyninflowData%TipSpeed = SrcdyninflowData%TipSpeed
   DstdyninflowData%totalInf = SrcdyninflowData%totalInf
   DstdyninflowData%Vparam = SrcdyninflowData%Vparam
   DstdyninflowData%Vtotal = SrcdyninflowData%Vtotal
   DstdyninflowData%xAlpha = SrcdyninflowData%xAlpha
   DstdyninflowData%xBeta = SrcdyninflowData%xBeta
   DstdyninflowData%xKai = SrcdyninflowData%xKai
   DstdyninflowData%XLAMBDA_M = SrcdyninflowData%XLAMBDA_M
   DstdyninflowData%xLcos = SrcdyninflowData%xLcos
   DstdyninflowData%xLsin = SrcdyninflowData%xLsin
   DstdyninflowData%MminR = SrcdyninflowData%MminR
   DstdyninflowData%MminusR = SrcdyninflowData%MminusR
   DstdyninflowData%MplusR = SrcdyninflowData%MplusR
   DstdyninflowData%GAMMA = SrcdyninflowData%GAMMA
 END SUBROUTINE AD_Copydyninflow

 SUBROUTINE AD_Destroydyninflow( dyninflowData, ErrStat, ErrMsg )
  TYPE(dyninflow), INTENT(INOUT) :: dyninflowData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(dyninflowData%RMC_SAVE)) THEN
   DEALLOCATE(dyninflowData%RMC_SAVE)
ENDIF
IF (ALLOCATED(dyninflowData%RMS_SAVE)) THEN
   DEALLOCATE(dyninflowData%RMS_SAVE)
ENDIF
 END SUBROUTINE AD_Destroydyninflow

 SUBROUTINE AD_Packdyninflow( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(dyninflow),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%dAlph_dt )  ! dAlph_dt 
  Re_BufSz    = Re_BufSz    + SIZE( InData%dBeta_dt )  ! dBeta_dt 
  Re_BufSz   = Re_BufSz   + 1  ! DTO
  Re_BufSz    = Re_BufSz    + SIZE( InData%old_Alph )  ! old_Alph 
  Re_BufSz    = Re_BufSz    + SIZE( InData%old_Beta )  ! old_Beta 
  Re_BufSz   = Re_BufSz   + 1  ! old_LmdM
  Re_BufSz   = Re_BufSz   + 1  ! oldKai
  Re_BufSz    = Re_BufSz    + SIZE( InData%PhiLqC )  ! PhiLqC 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PhiLqS )  ! PhiLqS 
  Re_BufSz   = Re_BufSz   + 1  ! Pzero
  Re_BufSz    = Re_BufSz    + SIZE( InData%RMC_SAVE )  ! RMC_SAVE 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RMS_SAVE )  ! RMS_SAVE 
  Re_BufSz   = Re_BufSz   + 1  ! TipSpeed
  Re_BufSz   = Re_BufSz   + 1  ! totalInf
  Re_BufSz   = Re_BufSz   + 1  ! Vparam
  Re_BufSz   = Re_BufSz   + 1  ! Vtotal
  Re_BufSz    = Re_BufSz    + SIZE( InData%xAlpha )  ! xAlpha 
  Re_BufSz    = Re_BufSz    + SIZE( InData%xBeta )  ! xBeta 
  Re_BufSz   = Re_BufSz   + 1  ! xKai
  Re_BufSz   = Re_BufSz   + 1  ! XLAMBDA_M
  Re_BufSz    = Re_BufSz    + SIZE( InData%xLcos )  ! xLcos 
  Re_BufSz    = Re_BufSz    + SIZE( InData%xLsin )  ! xLsin 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MminR )  ! MminR 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MminusR )  ! MminusR 
  Int_BufSz   = Int_BufSz   + SIZE( InData%MplusR )  ! MplusR 
  Re_BufSz    = Re_BufSz    + SIZE( InData%GAMMA )  ! GAMMA 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%dAlph_dt))-1 ) =  PACK(InData%dAlph_dt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%dAlph_dt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%dBeta_dt))-1 ) =  PACK(InData%dBeta_dt ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%dBeta_dt)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DTO )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%old_Alph))-1 ) =  PACK(InData%old_Alph ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%old_Alph)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%old_Beta))-1 ) =  PACK(InData%old_Beta ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%old_Beta)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%old_LmdM )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%oldKai )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PhiLqC))-1 ) =  PACK(InData%PhiLqC ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PhiLqC)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PhiLqS))-1 ) =  PACK(InData%PhiLqS ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%PhiLqS)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Pzero )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%RMC_SAVE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RMC_SAVE))-1 ) =  PACK(InData%RMC_SAVE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RMC_SAVE)
  ENDIF
  IF ( ALLOCATED(InData%RMS_SAVE) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RMS_SAVE))-1 ) =  PACK(InData%RMS_SAVE ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RMS_SAVE)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipSpeed )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%totalInf )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Vparam )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Vtotal )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xAlpha))-1 ) =  PACK(InData%xAlpha ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xAlpha)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xBeta))-1 ) =  PACK(InData%xBeta ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xBeta)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%xKai )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%XLAMBDA_M )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xLcos))-1 ) =  PACK(InData%xLcos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xLcos)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xLsin))-1 ) =  PACK(InData%xLsin ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xLsin)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MminR))-1 ) = PACK(InData%MminR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MminR)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MminusR))-1 ) = PACK(InData%MminusR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MminusR)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%MplusR))-1 ) = PACK(InData%MplusR ,.TRUE.)
  Int_Xferred   = Int_Xferred   + SIZE(InData%MplusR)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%GAMMA))-1 ) =  PACK(InData%GAMMA ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%GAMMA)
 END SUBROUTINE AD_Packdyninflow

 SUBROUTINE AD_UnPackdyninflow( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(dyninflow), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask2(SIZE(OutData%dAlph_dt,1),SIZE(OutData%dAlph_dt,2))); mask2 = .TRUE.
  OutData%dAlph_dt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%dAlph_dt))-1 ),mask2,OutData%dAlph_dt)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%dAlph_dt)
  ALLOCATE(mask2(SIZE(OutData%dBeta_dt,1),SIZE(OutData%dBeta_dt,2))); mask2 = .TRUE.
  OutData%dBeta_dt = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%dBeta_dt))-1 ),mask2,OutData%dBeta_dt)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%dBeta_dt)
  OutData%DTO = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%old_Alph,1))); mask1 = .TRUE.
  OutData%old_Alph = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%old_Alph))-1 ),mask1,OutData%old_Alph)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%old_Alph)
  ALLOCATE(mask1(SIZE(OutData%old_Beta,1))); mask1 = .TRUE.
  OutData%old_Beta = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%old_Beta))-1 ),mask1,OutData%old_Beta)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%old_Beta)
  OutData%old_LmdM = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%oldKai = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%PhiLqC,1))); mask1 = .TRUE.
  OutData%PhiLqC = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PhiLqC))-1 ),mask1,OutData%PhiLqC)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PhiLqC)
  ALLOCATE(mask1(SIZE(OutData%PhiLqS,1))); mask1 = .TRUE.
  OutData%PhiLqS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PhiLqS))-1 ),mask1,OutData%PhiLqS)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%PhiLqS)
  OutData%Pzero = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%RMC_SAVE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%RMC_SAVE,1),SIZE(OutData%RMC_SAVE,2),SIZE(OutData%RMC_SAVE,3))); mask3 = .TRUE.
    OutData%RMC_SAVE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RMC_SAVE))-1 ),mask3,OutData%RMC_SAVE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RMC_SAVE)
  ENDIF
  IF ( ALLOCATED(OutData%RMS_SAVE) ) THEN
  ALLOCATE(mask3(SIZE(OutData%RMS_SAVE,1),SIZE(OutData%RMS_SAVE,2),SIZE(OutData%RMS_SAVE,3))); mask3 = .TRUE.
    OutData%RMS_SAVE = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RMS_SAVE))-1 ),mask3,OutData%RMS_SAVE)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RMS_SAVE)
  ENDIF
  OutData%TipSpeed = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%totalInf = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Vparam = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Vtotal = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%xAlpha,1))); mask1 = .TRUE.
  OutData%xAlpha = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xAlpha))-1 ),mask1,OutData%xAlpha)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xAlpha)
  ALLOCATE(mask1(SIZE(OutData%xBeta,1))); mask1 = .TRUE.
  OutData%xBeta = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xBeta))-1 ),mask1,OutData%xBeta)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xBeta)
  OutData%xKai = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%XLAMBDA_M = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  ALLOCATE(mask2(SIZE(OutData%xLcos,1),SIZE(OutData%xLcos,2))); mask2 = .TRUE.
  OutData%xLcos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xLcos))-1 ),mask2,OutData%xLcos)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xLcos)
  ALLOCATE(mask2(SIZE(OutData%xLsin,1),SIZE(OutData%xLsin,2))); mask2 = .TRUE.
  OutData%xLsin = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xLsin))-1 ),mask2,OutData%xLsin)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xLsin)
  ALLOCATE(mask2(SIZE(OutData%MminR,1),SIZE(OutData%MminR,2))); mask2 = .TRUE.
  OutData%MminR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MminR))-1 ),mask2,OutData%MminR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MminR)
  ALLOCATE(mask2(SIZE(OutData%MminusR,1),SIZE(OutData%MminusR,2))); mask2 = .TRUE.
  OutData%MminusR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MminusR))-1 ),mask2,OutData%MminusR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MminusR)
  ALLOCATE(mask2(SIZE(OutData%MplusR,1),SIZE(OutData%MplusR,2))); mask2 = .TRUE.
  OutData%MplusR = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%MplusR))-1 ),mask2,OutData%MplusR)
  DEALLOCATE(mask2)
  Int_Xferred   = Int_Xferred   + SIZE(OutData%MplusR)
  ALLOCATE(mask2(SIZE(OutData%GAMMA,1),SIZE(OutData%GAMMA,2))); mask2 = .TRUE.
  OutData%GAMMA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%GAMMA))-1 ),mask2,OutData%GAMMA)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%GAMMA)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackdyninflow

 SUBROUTINE AD_Copydyninflowparms( SrcdyninflowparmsData, DstdyninflowparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(dyninflowparms), INTENT(INOUT) :: SrcdyninflowparmsData
   TYPE(dyninflowparms), INTENT(INOUT) :: DstdyninflowparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstdyninflowparmsData%MAXINFLO = SrcdyninflowparmsData%MAXINFLO
   DstdyninflowparmsData%xMinv = SrcdyninflowparmsData%xMinv
 END SUBROUTINE AD_Copydyninflowparms

 SUBROUTINE AD_Destroydyninflowparms( dyninflowparmsData, ErrStat, ErrMsg )
  TYPE(dyninflowparms), INTENT(INOUT) :: dyninflowparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroydyninflowparms

 SUBROUTINE AD_Packdyninflowparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(dyninflowparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! MAXINFLO
  Re_BufSz    = Re_BufSz    + SIZE( InData%xMinv )  ! xMinv 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXINFLO )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%xMinv))-1 ) =  PACK(InData%xMinv ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%xMinv)
 END SUBROUTINE AD_Packdyninflowparms

 SUBROUTINE AD_UnPackdyninflowparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(dyninflowparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%MAXINFLO = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  ALLOCATE(mask1(SIZE(OutData%xMinv,1))); mask1 = .TRUE.
  OutData%xMinv = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%xMinv))-1 ),mask1,OutData%xMinv)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%xMinv)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackdyninflowparms

 SUBROUTINE AD_Copyelement( SrcelementData, DstelementData, CtrlCode, ErrStat, ErrMsg )
   TYPE(element), INTENT(INOUT) :: SrcelementData
   TYPE(element), INTENT(INOUT) :: DstelementData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcelementData%A)) THEN
   i1_l = LBOUND(SrcelementData%A,1)
   i1_u = UBOUND(SrcelementData%A,1)
   i2_l = LBOUND(SrcelementData%A,2)
   i2_u = UBOUND(SrcelementData%A,2)
   IF (.NOT.ALLOCATED(DstelementData%A)) THEN 
      ALLOCATE(DstelementData%A(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelement: Error allocating DstelementData%A.'
         RETURN
      END IF
   END IF
   DstelementData%A = SrcelementData%A
ENDIF
IF (ALLOCATED(SrcelementData%AP)) THEN
   i1_l = LBOUND(SrcelementData%AP,1)
   i1_u = UBOUND(SrcelementData%AP,1)
   i2_l = LBOUND(SrcelementData%AP,2)
   i2_u = UBOUND(SrcelementData%AP,2)
   IF (.NOT.ALLOCATED(DstelementData%AP)) THEN 
      ALLOCATE(DstelementData%AP(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelement: Error allocating DstelementData%AP.'
         RETURN
      END IF
   END IF
   DstelementData%AP = SrcelementData%AP
ENDIF
IF (ALLOCATED(SrcelementData%ALPHA)) THEN
   i1_l = LBOUND(SrcelementData%ALPHA,1)
   i1_u = UBOUND(SrcelementData%ALPHA,1)
   i2_l = LBOUND(SrcelementData%ALPHA,2)
   i2_u = UBOUND(SrcelementData%ALPHA,2)
   IF (.NOT.ALLOCATED(DstelementData%ALPHA)) THEN 
      ALLOCATE(DstelementData%ALPHA(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelement: Error allocating DstelementData%ALPHA.'
         RETURN
      END IF
   END IF
   DstelementData%ALPHA = SrcelementData%ALPHA
ENDIF
IF (ALLOCATED(SrcelementData%W2)) THEN
   i1_l = LBOUND(SrcelementData%W2,1)
   i1_u = UBOUND(SrcelementData%W2,1)
   i2_l = LBOUND(SrcelementData%W2,2)
   i2_u = UBOUND(SrcelementData%W2,2)
   IF (.NOT.ALLOCATED(DstelementData%W2)) THEN 
      ALLOCATE(DstelementData%W2(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelement: Error allocating DstelementData%W2.'
         RETURN
      END IF
   END IF
   DstelementData%W2 = SrcelementData%W2
ENDIF
IF (ALLOCATED(SrcelementData%OLD_A_NS)) THEN
   i1_l = LBOUND(SrcelementData%OLD_A_NS,1)
   i1_u = UBOUND(SrcelementData%OLD_A_NS,1)
   i2_l = LBOUND(SrcelementData%OLD_A_NS,2)
   i2_u = UBOUND(SrcelementData%OLD_A_NS,2)
   IF (.NOT.ALLOCATED(DstelementData%OLD_A_NS)) THEN 
      ALLOCATE(DstelementData%OLD_A_NS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelement: Error allocating DstelementData%OLD_A_NS.'
         RETURN
      END IF
   END IF
   DstelementData%OLD_A_NS = SrcelementData%OLD_A_NS
ENDIF
IF (ALLOCATED(SrcelementData%OLD_AP_NS)) THEN
   i1_l = LBOUND(SrcelementData%OLD_AP_NS,1)
   i1_u = UBOUND(SrcelementData%OLD_AP_NS,1)
   i2_l = LBOUND(SrcelementData%OLD_AP_NS,2)
   i2_u = UBOUND(SrcelementData%OLD_AP_NS,2)
   IF (.NOT.ALLOCATED(DstelementData%OLD_AP_NS)) THEN 
      ALLOCATE(DstelementData%OLD_AP_NS(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelement: Error allocating DstelementData%OLD_AP_NS.'
         RETURN
      END IF
   END IF
   DstelementData%OLD_AP_NS = SrcelementData%OLD_AP_NS
ENDIF
   DstelementData%PITNOW = SrcelementData%PITNOW
 END SUBROUTINE AD_Copyelement

 SUBROUTINE AD_Destroyelement( elementData, ErrStat, ErrMsg )
  TYPE(element), INTENT(INOUT) :: elementData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(elementData%A)) THEN
   DEALLOCATE(elementData%A)
ENDIF
IF (ALLOCATED(elementData%AP)) THEN
   DEALLOCATE(elementData%AP)
ENDIF
IF (ALLOCATED(elementData%ALPHA)) THEN
   DEALLOCATE(elementData%ALPHA)
ENDIF
IF (ALLOCATED(elementData%W2)) THEN
   DEALLOCATE(elementData%W2)
ENDIF
IF (ALLOCATED(elementData%OLD_A_NS)) THEN
   DEALLOCATE(elementData%OLD_A_NS)
ENDIF
IF (ALLOCATED(elementData%OLD_AP_NS)) THEN
   DEALLOCATE(elementData%OLD_AP_NS)
ENDIF
 END SUBROUTINE AD_Destroyelement

 SUBROUTINE AD_Packelement( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(element),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%A )  ! A 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AP )  ! AP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%ALPHA )  ! ALPHA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%W2 )  ! W2 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLD_A_NS )  ! OLD_A_NS 
  Re_BufSz    = Re_BufSz    + SIZE( InData%OLD_AP_NS )  ! OLD_AP_NS 
  Re_BufSz   = Re_BufSz   + 1  ! PITNOW
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%A) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%A))-1 ) =  PACK(InData%A ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%A)
  ENDIF
  IF ( ALLOCATED(InData%AP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AP))-1 ) =  PACK(InData%AP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AP)
  ENDIF
  IF ( ALLOCATED(InData%ALPHA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ALPHA))-1 ) =  PACK(InData%ALPHA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ALPHA)
  ENDIF
  IF ( ALLOCATED(InData%W2) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%W2))-1 ) =  PACK(InData%W2 ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%W2)
  ENDIF
  IF ( ALLOCATED(InData%OLD_A_NS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLD_A_NS))-1 ) =  PACK(InData%OLD_A_NS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLD_A_NS)
  ENDIF
  IF ( ALLOCATED(InData%OLD_AP_NS) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%OLD_AP_NS))-1 ) =  PACK(InData%OLD_AP_NS ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%OLD_AP_NS)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%PITNOW )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packelement

 SUBROUTINE AD_UnPackelement( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(element), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%A) ) THEN
  ALLOCATE(mask2(SIZE(OutData%A,1),SIZE(OutData%A,2))); mask2 = .TRUE.
    OutData%A = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%A))-1 ),mask2,OutData%A)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%A)
  ENDIF
  IF ( ALLOCATED(OutData%AP) ) THEN
  ALLOCATE(mask2(SIZE(OutData%AP,1),SIZE(OutData%AP,2))); mask2 = .TRUE.
    OutData%AP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AP))-1 ),mask2,OutData%AP)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AP)
  ENDIF
  IF ( ALLOCATED(OutData%ALPHA) ) THEN
  ALLOCATE(mask2(SIZE(OutData%ALPHA,1),SIZE(OutData%ALPHA,2))); mask2 = .TRUE.
    OutData%ALPHA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ALPHA))-1 ),mask2,OutData%ALPHA)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ALPHA)
  ENDIF
  IF ( ALLOCATED(OutData%W2) ) THEN
  ALLOCATE(mask2(SIZE(OutData%W2,1),SIZE(OutData%W2,2))); mask2 = .TRUE.
    OutData%W2 = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%W2))-1 ),mask2,OutData%W2)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%W2)
  ENDIF
  IF ( ALLOCATED(OutData%OLD_A_NS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLD_A_NS,1),SIZE(OutData%OLD_A_NS,2))); mask2 = .TRUE.
    OutData%OLD_A_NS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLD_A_NS))-1 ),mask2,OutData%OLD_A_NS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLD_A_NS)
  ENDIF
  IF ( ALLOCATED(OutData%OLD_AP_NS) ) THEN
  ALLOCATE(mask2(SIZE(OutData%OLD_AP_NS,1),SIZE(OutData%OLD_AP_NS,2))); mask2 = .TRUE.
    OutData%OLD_AP_NS = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%OLD_AP_NS))-1 ),mask2,OutData%OLD_AP_NS)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%OLD_AP_NS)
  ENDIF
  OutData%PITNOW = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackelement

 SUBROUTINE AD_Copyelementparms( SrcelementparmsData, DstelementparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(elementparms), INTENT(INOUT) :: SrcelementparmsData
   TYPE(elementparms), INTENT(INOUT) :: DstelementparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstelementparmsData%NELM = SrcelementparmsData%NELM
IF (ALLOCATED(SrcelementparmsData%TWIST)) THEN
   i1_l = LBOUND(SrcelementparmsData%TWIST,1)
   i1_u = UBOUND(SrcelementparmsData%TWIST,1)
   IF (.NOT.ALLOCATED(DstelementparmsData%TWIST)) THEN 
      ALLOCATE(DstelementparmsData%TWIST(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelementparms: Error allocating DstelementparmsData%TWIST.'
         RETURN
      END IF
   END IF
   DstelementparmsData%TWIST = SrcelementparmsData%TWIST
ENDIF
IF (ALLOCATED(SrcelementparmsData%RELM)) THEN
   i1_l = LBOUND(SrcelementparmsData%RELM,1)
   i1_u = UBOUND(SrcelementparmsData%RELM,1)
   IF (.NOT.ALLOCATED(DstelementparmsData%RELM)) THEN 
      ALLOCATE(DstelementparmsData%RELM(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelementparms: Error allocating DstelementparmsData%RELM.'
         RETURN
      END IF
   END IF
   DstelementparmsData%RELM = SrcelementparmsData%RELM
ENDIF
IF (ALLOCATED(SrcelementparmsData%HLCNST)) THEN
   i1_l = LBOUND(SrcelementparmsData%HLCNST,1)
   i1_u = UBOUND(SrcelementparmsData%HLCNST,1)
   IF (.NOT.ALLOCATED(DstelementparmsData%HLCNST)) THEN 
      ALLOCATE(DstelementparmsData%HLCNST(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelementparms: Error allocating DstelementparmsData%HLCNST.'
         RETURN
      END IF
   END IF
   DstelementparmsData%HLCNST = SrcelementparmsData%HLCNST
ENDIF
IF (ALLOCATED(SrcelementparmsData%TLCNST)) THEN
   i1_l = LBOUND(SrcelementparmsData%TLCNST,1)
   i1_u = UBOUND(SrcelementparmsData%TLCNST,1)
   IF (.NOT.ALLOCATED(DstelementparmsData%TLCNST)) THEN 
      ALLOCATE(DstelementparmsData%TLCNST(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyelementparms: Error allocating DstelementparmsData%TLCNST.'
         RETURN
      END IF
   END IF
   DstelementparmsData%TLCNST = SrcelementparmsData%TLCNST
ENDIF
 END SUBROUTINE AD_Copyelementparms

 SUBROUTINE AD_Destroyelementparms( elementparmsData, ErrStat, ErrMsg )
  TYPE(elementparms), INTENT(INOUT) :: elementparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(elementparmsData%TWIST)) THEN
   DEALLOCATE(elementparmsData%TWIST)
ENDIF
IF (ALLOCATED(elementparmsData%RELM)) THEN
   DEALLOCATE(elementparmsData%RELM)
ENDIF
IF (ALLOCATED(elementparmsData%HLCNST)) THEN
   DEALLOCATE(elementparmsData%HLCNST)
ENDIF
IF (ALLOCATED(elementparmsData%TLCNST)) THEN
   DEALLOCATE(elementparmsData%TLCNST)
ENDIF
 END SUBROUTINE AD_Destroyelementparms

 SUBROUTINE AD_Packelementparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(elementparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NELM
  Re_BufSz    = Re_BufSz    + SIZE( InData%TWIST )  ! TWIST 
  Re_BufSz    = Re_BufSz    + SIZE( InData%RELM )  ! RELM 
  Re_BufSz    = Re_BufSz    + SIZE( InData%HLCNST )  ! HLCNST 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TLCNST )  ! TLCNST 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NELM )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TWIST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TWIST))-1 ) =  PACK(InData%TWIST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TWIST)
  ENDIF
  IF ( ALLOCATED(InData%RELM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%RELM))-1 ) =  PACK(InData%RELM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%RELM)
  ENDIF
  IF ( ALLOCATED(InData%HLCNST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%HLCNST))-1 ) =  PACK(InData%HLCNST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%HLCNST)
  ENDIF
  IF ( ALLOCATED(InData%TLCNST) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TLCNST))-1 ) =  PACK(InData%TLCNST ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TLCNST)
  ENDIF
 END SUBROUTINE AD_Packelementparms

 SUBROUTINE AD_UnPackelementparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(elementparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NELM = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TWIST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TWIST,1))); mask1 = .TRUE.
    OutData%TWIST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TWIST))-1 ),mask1,OutData%TWIST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TWIST)
  ENDIF
  IF ( ALLOCATED(OutData%RELM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%RELM,1))); mask1 = .TRUE.
    OutData%RELM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%RELM))-1 ),mask1,OutData%RELM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%RELM)
  ENDIF
  IF ( ALLOCATED(OutData%HLCNST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%HLCNST,1))); mask1 = .TRUE.
    OutData%HLCNST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%HLCNST))-1 ),mask1,OutData%HLCNST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%HLCNST)
  ENDIF
  IF ( ALLOCATED(OutData%TLCNST) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TLCNST,1))); mask1 = .TRUE.
    OutData%TLCNST = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TLCNST))-1 ),mask1,OutData%TLCNST)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TLCNST)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackelementparms

 SUBROUTINE AD_Copyeloutparms( SrceloutparmsData, DsteloutparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(eloutparms), INTENT(INOUT) :: SrceloutparmsData
   TYPE(eloutparms), INTENT(INOUT) :: DsteloutparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrceloutparmsData%AAA)) THEN
   i1_l = LBOUND(SrceloutparmsData%AAA,1)
   i1_u = UBOUND(SrceloutparmsData%AAA,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%AAA)) THEN 
      ALLOCATE(DsteloutparmsData%AAA(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%AAA.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%AAA = SrceloutparmsData%AAA
ENDIF
IF (ALLOCATED(SrceloutparmsData%AAP)) THEN
   i1_l = LBOUND(SrceloutparmsData%AAP,1)
   i1_u = UBOUND(SrceloutparmsData%AAP,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%AAP)) THEN 
      ALLOCATE(DsteloutparmsData%AAP(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%AAP.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%AAP = SrceloutparmsData%AAP
ENDIF
IF (ALLOCATED(SrceloutparmsData%ALF)) THEN
   i1_l = LBOUND(SrceloutparmsData%ALF,1)
   i1_u = UBOUND(SrceloutparmsData%ALF,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%ALF)) THEN 
      ALLOCATE(DsteloutparmsData%ALF(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%ALF.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%ALF = SrceloutparmsData%ALF
ENDIF
IF (ALLOCATED(SrceloutparmsData%CDD)) THEN
   i1_l = LBOUND(SrceloutparmsData%CDD,1)
   i1_u = UBOUND(SrceloutparmsData%CDD,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%CDD)) THEN 
      ALLOCATE(DsteloutparmsData%CDD(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%CDD.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%CDD = SrceloutparmsData%CDD
ENDIF
IF (ALLOCATED(SrceloutparmsData%CLL)) THEN
   i1_l = LBOUND(SrceloutparmsData%CLL,1)
   i1_u = UBOUND(SrceloutparmsData%CLL,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%CLL)) THEN 
      ALLOCATE(DsteloutparmsData%CLL(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%CLL.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%CLL = SrceloutparmsData%CLL
ENDIF
IF (ALLOCATED(SrceloutparmsData%CMM)) THEN
   i1_l = LBOUND(SrceloutparmsData%CMM,1)
   i1_u = UBOUND(SrceloutparmsData%CMM,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%CMM)) THEN 
      ALLOCATE(DsteloutparmsData%CMM(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%CMM.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%CMM = SrceloutparmsData%CMM
ENDIF
IF (ALLOCATED(SrceloutparmsData%CNN)) THEN
   i1_l = LBOUND(SrceloutparmsData%CNN,1)
   i1_u = UBOUND(SrceloutparmsData%CNN,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%CNN)) THEN 
      ALLOCATE(DsteloutparmsData%CNN(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%CNN.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%CNN = SrceloutparmsData%CNN
ENDIF
IF (ALLOCATED(SrceloutparmsData%CTT)) THEN
   i1_l = LBOUND(SrceloutparmsData%CTT,1)
   i1_u = UBOUND(SrceloutparmsData%CTT,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%CTT)) THEN 
      ALLOCATE(DsteloutparmsData%CTT(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%CTT.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%CTT = SrceloutparmsData%CTT
ENDIF
IF (ALLOCATED(SrceloutparmsData%DFNSAV)) THEN
   i1_l = LBOUND(SrceloutparmsData%DFNSAV,1)
   i1_u = UBOUND(SrceloutparmsData%DFNSAV,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%DFNSAV)) THEN 
      ALLOCATE(DsteloutparmsData%DFNSAV(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%DFNSAV.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%DFNSAV = SrceloutparmsData%DFNSAV
ENDIF
IF (ALLOCATED(SrceloutparmsData%DFTSAV)) THEN
   i1_l = LBOUND(SrceloutparmsData%DFTSAV,1)
   i1_u = UBOUND(SrceloutparmsData%DFTSAV,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%DFTSAV)) THEN 
      ALLOCATE(DsteloutparmsData%DFTSAV(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%DFTSAV.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%DFTSAV = SrceloutparmsData%DFTSAV
ENDIF
IF (ALLOCATED(SrceloutparmsData%DynPres)) THEN
   i1_l = LBOUND(SrceloutparmsData%DynPres,1)
   i1_u = UBOUND(SrceloutparmsData%DynPres,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%DynPres)) THEN 
      ALLOCATE(DsteloutparmsData%DynPres(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%DynPres.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%DynPres = SrceloutparmsData%DynPres
ENDIF
IF (ALLOCATED(SrceloutparmsData%PMM)) THEN
   i1_l = LBOUND(SrceloutparmsData%PMM,1)
   i1_u = UBOUND(SrceloutparmsData%PMM,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%PMM)) THEN 
      ALLOCATE(DsteloutparmsData%PMM(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%PMM.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%PMM = SrceloutparmsData%PMM
ENDIF
IF (ALLOCATED(SrceloutparmsData%PITSAV)) THEN
   i1_l = LBOUND(SrceloutparmsData%PITSAV,1)
   i1_u = UBOUND(SrceloutparmsData%PITSAV,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%PITSAV)) THEN 
      ALLOCATE(DsteloutparmsData%PITSAV(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%PITSAV.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%PITSAV = SrceloutparmsData%PITSAV
ENDIF
IF (ALLOCATED(SrceloutparmsData%ReyNum)) THEN
   i1_l = LBOUND(SrceloutparmsData%ReyNum,1)
   i1_u = UBOUND(SrceloutparmsData%ReyNum,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%ReyNum)) THEN 
      ALLOCATE(DsteloutparmsData%ReyNum(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%ReyNum.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%ReyNum = SrceloutparmsData%ReyNum
ENDIF
IF (ALLOCATED(SrceloutparmsData%SaveVX)) THEN
   i1_l = LBOUND(SrceloutparmsData%SaveVX,1)
   i1_u = UBOUND(SrceloutparmsData%SaveVX,1)
   i2_l = LBOUND(SrceloutparmsData%SaveVX,2)
   i2_u = UBOUND(SrceloutparmsData%SaveVX,2)
   IF (.NOT.ALLOCATED(DsteloutparmsData%SaveVX)) THEN 
      ALLOCATE(DsteloutparmsData%SaveVX(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%SaveVX.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%SaveVX = SrceloutparmsData%SaveVX
ENDIF
IF (ALLOCATED(SrceloutparmsData%SaveVY)) THEN
   i1_l = LBOUND(SrceloutparmsData%SaveVY,1)
   i1_u = UBOUND(SrceloutparmsData%SaveVY,1)
   i2_l = LBOUND(SrceloutparmsData%SaveVY,2)
   i2_u = UBOUND(SrceloutparmsData%SaveVY,2)
   IF (.NOT.ALLOCATED(DsteloutparmsData%SaveVY)) THEN 
      ALLOCATE(DsteloutparmsData%SaveVY(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%SaveVY.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%SaveVY = SrceloutparmsData%SaveVY
ENDIF
IF (ALLOCATED(SrceloutparmsData%SaveVZ)) THEN
   i1_l = LBOUND(SrceloutparmsData%SaveVZ,1)
   i1_u = UBOUND(SrceloutparmsData%SaveVZ,1)
   i2_l = LBOUND(SrceloutparmsData%SaveVZ,2)
   i2_u = UBOUND(SrceloutparmsData%SaveVZ,2)
   IF (.NOT.ALLOCATED(DsteloutparmsData%SaveVZ)) THEN 
      ALLOCATE(DsteloutparmsData%SaveVZ(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%SaveVZ.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%SaveVZ = SrceloutparmsData%SaveVZ
ENDIF
   DsteloutparmsData%VXSAV = SrceloutparmsData%VXSAV
   DsteloutparmsData%VYSAV = SrceloutparmsData%VYSAV
   DsteloutparmsData%VZSAV = SrceloutparmsData%VZSAV
   DsteloutparmsData%NumWndElOut = SrceloutparmsData%NumWndElOut
IF (ALLOCATED(SrceloutparmsData%WndElPrList)) THEN
   i1_l = LBOUND(SrceloutparmsData%WndElPrList,1)
   i1_u = UBOUND(SrceloutparmsData%WndElPrList,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%WndElPrList)) THEN 
      ALLOCATE(DsteloutparmsData%WndElPrList(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%WndElPrList.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%WndElPrList = SrceloutparmsData%WndElPrList
ENDIF
IF (ALLOCATED(SrceloutparmsData%WndElPrNum)) THEN
   i1_l = LBOUND(SrceloutparmsData%WndElPrNum,1)
   i1_u = UBOUND(SrceloutparmsData%WndElPrNum,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%WndElPrNum)) THEN 
      ALLOCATE(DsteloutparmsData%WndElPrNum(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%WndElPrNum.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%WndElPrNum = SrceloutparmsData%WndElPrNum
ENDIF
IF (ALLOCATED(SrceloutparmsData%ElPrList)) THEN
   i1_l = LBOUND(SrceloutparmsData%ElPrList,1)
   i1_u = UBOUND(SrceloutparmsData%ElPrList,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%ElPrList)) THEN 
      ALLOCATE(DsteloutparmsData%ElPrList(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%ElPrList.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%ElPrList = SrceloutparmsData%ElPrList
ENDIF
IF (ALLOCATED(SrceloutparmsData%ElPrNum)) THEN
   i1_l = LBOUND(SrceloutparmsData%ElPrNum,1)
   i1_u = UBOUND(SrceloutparmsData%ElPrNum,1)
   IF (.NOT.ALLOCATED(DsteloutparmsData%ElPrNum)) THEN 
      ALLOCATE(DsteloutparmsData%ElPrNum(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copyeloutparms: Error allocating DsteloutparmsData%ElPrNum.'
         RETURN
      END IF
   END IF
   DsteloutparmsData%ElPrNum = SrceloutparmsData%ElPrNum
ENDIF
   DsteloutparmsData%NumElOut = SrceloutparmsData%NumElOut
 END SUBROUTINE AD_Copyeloutparms

 SUBROUTINE AD_Destroyeloutparms( eloutparmsData, ErrStat, ErrMsg )
  TYPE(eloutparms), INTENT(INOUT) :: eloutparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(eloutparmsData%AAA)) THEN
   DEALLOCATE(eloutparmsData%AAA)
ENDIF
IF (ALLOCATED(eloutparmsData%AAP)) THEN
   DEALLOCATE(eloutparmsData%AAP)
ENDIF
IF (ALLOCATED(eloutparmsData%ALF)) THEN
   DEALLOCATE(eloutparmsData%ALF)
ENDIF
IF (ALLOCATED(eloutparmsData%CDD)) THEN
   DEALLOCATE(eloutparmsData%CDD)
ENDIF
IF (ALLOCATED(eloutparmsData%CLL)) THEN
   DEALLOCATE(eloutparmsData%CLL)
ENDIF
IF (ALLOCATED(eloutparmsData%CMM)) THEN
   DEALLOCATE(eloutparmsData%CMM)
ENDIF
IF (ALLOCATED(eloutparmsData%CNN)) THEN
   DEALLOCATE(eloutparmsData%CNN)
ENDIF
IF (ALLOCATED(eloutparmsData%CTT)) THEN
   DEALLOCATE(eloutparmsData%CTT)
ENDIF
IF (ALLOCATED(eloutparmsData%DFNSAV)) THEN
   DEALLOCATE(eloutparmsData%DFNSAV)
ENDIF
IF (ALLOCATED(eloutparmsData%DFTSAV)) THEN
   DEALLOCATE(eloutparmsData%DFTSAV)
ENDIF
IF (ALLOCATED(eloutparmsData%DynPres)) THEN
   DEALLOCATE(eloutparmsData%DynPres)
ENDIF
IF (ALLOCATED(eloutparmsData%PMM)) THEN
   DEALLOCATE(eloutparmsData%PMM)
ENDIF
IF (ALLOCATED(eloutparmsData%PITSAV)) THEN
   DEALLOCATE(eloutparmsData%PITSAV)
ENDIF
IF (ALLOCATED(eloutparmsData%ReyNum)) THEN
   DEALLOCATE(eloutparmsData%ReyNum)
ENDIF
IF (ALLOCATED(eloutparmsData%SaveVX)) THEN
   DEALLOCATE(eloutparmsData%SaveVX)
ENDIF
IF (ALLOCATED(eloutparmsData%SaveVY)) THEN
   DEALLOCATE(eloutparmsData%SaveVY)
ENDIF
IF (ALLOCATED(eloutparmsData%SaveVZ)) THEN
   DEALLOCATE(eloutparmsData%SaveVZ)
ENDIF
IF (ALLOCATED(eloutparmsData%WndElPrList)) THEN
   DEALLOCATE(eloutparmsData%WndElPrList)
ENDIF
IF (ALLOCATED(eloutparmsData%WndElPrNum)) THEN
   DEALLOCATE(eloutparmsData%WndElPrNum)
ENDIF
IF (ALLOCATED(eloutparmsData%ElPrList)) THEN
   DEALLOCATE(eloutparmsData%ElPrList)
ENDIF
IF (ALLOCATED(eloutparmsData%ElPrNum)) THEN
   DEALLOCATE(eloutparmsData%ElPrNum)
ENDIF
 END SUBROUTINE AD_Destroyeloutparms

 SUBROUTINE AD_Packeloutparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(eloutparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%AAA )  ! AAA 
  Re_BufSz    = Re_BufSz    + SIZE( InData%AAP )  ! AAP 
  Re_BufSz    = Re_BufSz    + SIZE( InData%ALF )  ! ALF 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CDD )  ! CDD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CLL )  ! CLL 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CMM )  ! CMM 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CNN )  ! CNN 
  Re_BufSz    = Re_BufSz    + SIZE( InData%CTT )  ! CTT 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DFNSAV )  ! DFNSAV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DFTSAV )  ! DFTSAV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%DynPres )  ! DynPres 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PMM )  ! PMM 
  Re_BufSz    = Re_BufSz    + SIZE( InData%PITSAV )  ! PITSAV 
  Re_BufSz    = Re_BufSz    + SIZE( InData%ReyNum )  ! ReyNum 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVX )  ! SaveVX 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVY )  ! SaveVY 
  Re_BufSz    = Re_BufSz    + SIZE( InData%SaveVZ )  ! SaveVZ 
  Re_BufSz   = Re_BufSz   + 1  ! VXSAV
  Re_BufSz   = Re_BufSz   + 1  ! VYSAV
  Re_BufSz   = Re_BufSz   + 1  ! VZSAV
  Int_BufSz  = Int_BufSz  + 1  ! NumWndElOut
  Int_BufSz   = Int_BufSz   + SIZE( InData%WndElPrList )  ! WndElPrList 
  Int_BufSz   = Int_BufSz   + SIZE( InData%WndElPrNum )  ! WndElPrNum 
  Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrList )  ! ElPrList 
  Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrNum )  ! ElPrNum 
  Int_BufSz  = Int_BufSz  + 1  ! NumElOut
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%AAA) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AAA))-1 ) =  PACK(InData%AAA ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AAA)
  ENDIF
  IF ( ALLOCATED(InData%AAP) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%AAP))-1 ) =  PACK(InData%AAP ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%AAP)
  ENDIF
  IF ( ALLOCATED(InData%ALF) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ALF))-1 ) =  PACK(InData%ALF ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ALF)
  ENDIF
  IF ( ALLOCATED(InData%CDD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CDD))-1 ) =  PACK(InData%CDD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CDD)
  ENDIF
  IF ( ALLOCATED(InData%CLL) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CLL))-1 ) =  PACK(InData%CLL ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CLL)
  ENDIF
  IF ( ALLOCATED(InData%CMM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CMM))-1 ) =  PACK(InData%CMM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CMM)
  ENDIF
  IF ( ALLOCATED(InData%CNN) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CNN))-1 ) =  PACK(InData%CNN ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CNN)
  ENDIF
  IF ( ALLOCATED(InData%CTT) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%CTT))-1 ) =  PACK(InData%CTT ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%CTT)
  ENDIF
  IF ( ALLOCATED(InData%DFNSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFNSAV))-1 ) =  PACK(InData%DFNSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFNSAV)
  ENDIF
  IF ( ALLOCATED(InData%DFTSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DFTSAV))-1 ) =  PACK(InData%DFTSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DFTSAV)
  ENDIF
  IF ( ALLOCATED(InData%DynPres) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%DynPres))-1 ) =  PACK(InData%DynPres ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%DynPres)
  ENDIF
  IF ( ALLOCATED(InData%PMM) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PMM))-1 ) =  PACK(InData%PMM ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PMM)
  ENDIF
  IF ( ALLOCATED(InData%PITSAV) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%PITSAV))-1 ) =  PACK(InData%PITSAV ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%PITSAV)
  ENDIF
  IF ( ALLOCATED(InData%ReyNum) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%ReyNum))-1 ) =  PACK(InData%ReyNum ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%ReyNum)
  ENDIF
  IF ( ALLOCATED(InData%SaveVX) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVX))-1 ) =  PACK(InData%SaveVX ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVX)
  ENDIF
  IF ( ALLOCATED(InData%SaveVY) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVY))-1 ) =  PACK(InData%SaveVY ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVY)
  ENDIF
  IF ( ALLOCATED(InData%SaveVZ) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%SaveVZ))-1 ) =  PACK(InData%SaveVZ ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%SaveVZ)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VXSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VYSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VZSAV )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumWndElOut )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%WndElPrList) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%WndElPrList))-1 ) = PACK(InData%WndElPrList ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%WndElPrList)
  ENDIF
  IF ( ALLOCATED(InData%WndElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%WndElPrNum))-1 ) = PACK(InData%WndElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%WndElPrNum)
  ENDIF
  IF ( ALLOCATED(InData%ElPrList) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrList))-1 ) = PACK(InData%ElPrList ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrList)
  ENDIF
  IF ( ALLOCATED(InData%ElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrNum))-1 ) = PACK(InData%ElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrNum)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumElOut )
  Int_Xferred   = Int_Xferred   + 1
 END SUBROUTINE AD_Packeloutparms

 SUBROUTINE AD_UnPackeloutparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(eloutparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%AAA) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AAA,1))); mask1 = .TRUE.
    OutData%AAA = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AAA))-1 ),mask1,OutData%AAA)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AAA)
  ENDIF
  IF ( ALLOCATED(OutData%AAP) ) THEN
  ALLOCATE(mask1(SIZE(OutData%AAP,1))); mask1 = .TRUE.
    OutData%AAP = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%AAP))-1 ),mask1,OutData%AAP)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%AAP)
  ENDIF
  IF ( ALLOCATED(OutData%ALF) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ALF,1))); mask1 = .TRUE.
    OutData%ALF = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ALF))-1 ),mask1,OutData%ALF)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ALF)
  ENDIF
  IF ( ALLOCATED(OutData%CDD) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CDD,1))); mask1 = .TRUE.
    OutData%CDD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CDD))-1 ),mask1,OutData%CDD)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CDD)
  ENDIF
  IF ( ALLOCATED(OutData%CLL) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CLL,1))); mask1 = .TRUE.
    OutData%CLL = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CLL))-1 ),mask1,OutData%CLL)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CLL)
  ENDIF
  IF ( ALLOCATED(OutData%CMM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CMM,1))); mask1 = .TRUE.
    OutData%CMM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CMM))-1 ),mask1,OutData%CMM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CMM)
  ENDIF
  IF ( ALLOCATED(OutData%CNN) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CNN,1))); mask1 = .TRUE.
    OutData%CNN = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CNN))-1 ),mask1,OutData%CNN)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CNN)
  ENDIF
  IF ( ALLOCATED(OutData%CTT) ) THEN
  ALLOCATE(mask1(SIZE(OutData%CTT,1))); mask1 = .TRUE.
    OutData%CTT = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%CTT))-1 ),mask1,OutData%CTT)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%CTT)
  ENDIF
  IF ( ALLOCATED(OutData%DFNSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DFNSAV,1))); mask1 = .TRUE.
    OutData%DFNSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFNSAV))-1 ),mask1,OutData%DFNSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFNSAV)
  ENDIF
  IF ( ALLOCATED(OutData%DFTSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DFTSAV,1))); mask1 = .TRUE.
    OutData%DFTSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DFTSAV))-1 ),mask1,OutData%DFTSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DFTSAV)
  ENDIF
  IF ( ALLOCATED(OutData%DynPres) ) THEN
  ALLOCATE(mask1(SIZE(OutData%DynPres,1))); mask1 = .TRUE.
    OutData%DynPres = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%DynPres))-1 ),mask1,OutData%DynPres)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%DynPres)
  ENDIF
  IF ( ALLOCATED(OutData%PMM) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PMM,1))); mask1 = .TRUE.
    OutData%PMM = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PMM))-1 ),mask1,OutData%PMM)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PMM)
  ENDIF
  IF ( ALLOCATED(OutData%PITSAV) ) THEN
  ALLOCATE(mask1(SIZE(OutData%PITSAV,1))); mask1 = .TRUE.
    OutData%PITSAV = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%PITSAV))-1 ),mask1,OutData%PITSAV)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%PITSAV)
  ENDIF
  IF ( ALLOCATED(OutData%ReyNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ReyNum,1))); mask1 = .TRUE.
    OutData%ReyNum = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%ReyNum))-1 ),mask1,OutData%ReyNum)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%ReyNum)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVX) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVX,1),SIZE(OutData%SaveVX,2))); mask2 = .TRUE.
    OutData%SaveVX = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVX))-1 ),mask2,OutData%SaveVX)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVX)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVY) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVY,1),SIZE(OutData%SaveVY,2))); mask2 = .TRUE.
    OutData%SaveVY = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVY))-1 ),mask2,OutData%SaveVY)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVY)
  ENDIF
  IF ( ALLOCATED(OutData%SaveVZ) ) THEN
  ALLOCATE(mask2(SIZE(OutData%SaveVZ,1),SIZE(OutData%SaveVZ,2))); mask2 = .TRUE.
    OutData%SaveVZ = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%SaveVZ))-1 ),mask2,OutData%SaveVZ)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%SaveVZ)
  ENDIF
  OutData%VXSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VYSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VZSAV = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumWndElOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%WndElPrList) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WndElPrList,1))); mask1 = .TRUE.
    OutData%WndElPrList = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%WndElPrList))-1 ),mask1,OutData%WndElPrList)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%WndElPrList)
  ENDIF
  IF ( ALLOCATED(OutData%WndElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%WndElPrNum,1))); mask1 = .TRUE.
    OutData%WndElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%WndElPrNum))-1 ),mask1,OutData%WndElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%WndElPrNum)
  ENDIF
  IF ( ALLOCATED(OutData%ElPrList) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrList,1))); mask1 = .TRUE.
    OutData%ElPrList = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrList))-1 ),mask1,OutData%ElPrList)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrList)
  ENDIF
  IF ( ALLOCATED(OutData%ElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrNum,1))); mask1 = .TRUE.
    OutData%ElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrNum))-1 ),mask1,OutData%ElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrNum)
  ENDIF
  OutData%NumElOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackeloutparms

 SUBROUTINE AD_Copyinducedvel( SrcinducedvelData, DstinducedvelData, CtrlCode, ErrStat, ErrMsg )
   TYPE(inducedvel), INTENT(INOUT) :: SrcinducedvelData
   TYPE(inducedvel), INTENT(INOUT) :: DstinducedvelData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstinducedvelData%SumInFl = SrcinducedvelData%SumInFl
 END SUBROUTINE AD_Copyinducedvel

 SUBROUTINE AD_Destroyinducedvel( inducedvelData, ErrStat, ErrMsg )
  TYPE(inducedvel), INTENT(INOUT) :: inducedvelData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroyinducedvel

 SUBROUTINE AD_Packinducedvel( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(inducedvel),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! SumInFl
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SumInFl )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packinducedvel

 SUBROUTINE AD_UnPackinducedvel( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(inducedvel), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%SumInFl = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackinducedvel

 SUBROUTINE AD_Copyinducedvelparms( SrcinducedvelparmsData, DstinducedvelparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(inducedvelparms), INTENT(INOUT) :: SrcinducedvelparmsData
   TYPE(inducedvelparms), INTENT(INOUT) :: DstinducedvelparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstinducedvelparmsData%AToler = SrcinducedvelparmsData%AToler
   DstinducedvelparmsData%EqAIDmult = SrcinducedvelparmsData%EqAIDmult
   DstinducedvelparmsData%EquilDA = SrcinducedvelparmsData%EquilDA
   DstinducedvelparmsData%EquilDT = SrcinducedvelparmsData%EquilDT
   DstinducedvelparmsData%TLoss = SrcinducedvelparmsData%TLoss
   DstinducedvelparmsData%GTech = SrcinducedvelparmsData%GTech
   DstinducedvelparmsData%HLoss = SrcinducedvelparmsData%HLoss
 END SUBROUTINE AD_Copyinducedvelparms

 SUBROUTINE AD_Destroyinducedvelparms( inducedvelparmsData, ErrStat, ErrMsg )
  TYPE(inducedvelparms), INTENT(INOUT) :: inducedvelparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroyinducedvelparms

 SUBROUTINE AD_Packinducedvelparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(inducedvelparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AToler
  Re_BufSz   = Re_BufSz   + 1  ! EqAIDmult
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AToler )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%EqAIDmult )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packinducedvelparms

 SUBROUTINE AD_UnPackinducedvelparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(inducedvelparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AToler = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%EqAIDmult = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackinducedvelparms

 SUBROUTINE AD_Copyrotor( SrcrotorData, DstrotorData, CtrlCode, ErrStat, ErrMsg )
   TYPE(rotor), INTENT(INOUT) :: SrcrotorData
   TYPE(rotor), INTENT(INOUT) :: DstrotorData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstrotorData%AVGINFL = SrcrotorData%AVGINFL
   DstrotorData%CTILT = SrcrotorData%CTILT
   DstrotorData%CYaw = SrcrotorData%CYaw
   DstrotorData%REVS = SrcrotorData%REVS
   DstrotorData%STILT = SrcrotorData%STILT
   DstrotorData%SYaw = SrcrotorData%SYaw
   DstrotorData%TILT = SrcrotorData%TILT
   DstrotorData%YawAng = SrcrotorData%YawAng
   DstrotorData%YawVEL = SrcrotorData%YawVEL
 END SUBROUTINE AD_Copyrotor

 SUBROUTINE AD_Destroyrotor( rotorData, ErrStat, ErrMsg )
  TYPE(rotor), INTENT(INOUT) :: rotorData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroyrotor

 SUBROUTINE AD_Packrotor( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(rotor),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! AVGINFL
  Re_BufSz   = Re_BufSz   + 1  ! CTILT
  Re_BufSz   = Re_BufSz   + 1  ! CYaw
  Re_BufSz   = Re_BufSz   + 1  ! REVS
  Re_BufSz   = Re_BufSz   + 1  ! STILT
  Re_BufSz   = Re_BufSz   + 1  ! SYaw
  Re_BufSz   = Re_BufSz   + 1  ! TILT
  Re_BufSz   = Re_BufSz   + 1  ! YawAng
  Re_BufSz   = Re_BufSz   + 1  ! YawVEL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%AVGINFL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CTILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%REVS )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%STILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SYaw )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TILT )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawAng )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%YawVEL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packrotor

 SUBROUTINE AD_UnPackrotor( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(rotor), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%AVGINFL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CTILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%REVS = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%STILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SYaw = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TILT = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawAng = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%YawVEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackrotor

 SUBROUTINE AD_Copyrotorparms( SrcrotorparmsData, DstrotorparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(rotorparms), INTENT(INOUT) :: SrcrotorparmsData
   TYPE(rotorparms), INTENT(INOUT) :: DstrotorparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstrotorparmsData%HH = SrcrotorparmsData%HH
 END SUBROUTINE AD_Copyrotorparms

 SUBROUTINE AD_Destroyrotorparms( rotorparmsData, ErrStat, ErrMsg )
  TYPE(rotorparms), INTENT(INOUT) :: rotorparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroyrotorparms

 SUBROUTINE AD_Packrotorparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(rotorparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! HH
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HH )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packrotorparms

 SUBROUTINE AD_UnPackrotorparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(rotorparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%HH = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackrotorparms

 SUBROUTINE AD_Copytwrpropsparms( SrctwrpropsparmsData, DsttwrpropsparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(twrpropsparms), INTENT(INOUT) :: SrctwrpropsparmsData
   TYPE(twrpropsparms), INTENT(INOUT) :: DsttwrpropsparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrctwrpropsparmsData%TwrHtFr)) THEN
   i1_l = LBOUND(SrctwrpropsparmsData%TwrHtFr,1)
   i1_u = UBOUND(SrctwrpropsparmsData%TwrHtFr,1)
   IF (.NOT.ALLOCATED(DsttwrpropsparmsData%TwrHtFr)) THEN 
      ALLOCATE(DsttwrpropsparmsData%TwrHtFr(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copytwrpropsparms: Error allocating DsttwrpropsparmsData%TwrHtFr.'
         RETURN
      END IF
   END IF
   DsttwrpropsparmsData%TwrHtFr = SrctwrpropsparmsData%TwrHtFr
ENDIF
IF (ALLOCATED(SrctwrpropsparmsData%TwrWid)) THEN
   i1_l = LBOUND(SrctwrpropsparmsData%TwrWid,1)
   i1_u = UBOUND(SrctwrpropsparmsData%TwrWid,1)
   IF (.NOT.ALLOCATED(DsttwrpropsparmsData%TwrWid)) THEN 
      ALLOCATE(DsttwrpropsparmsData%TwrWid(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copytwrpropsparms: Error allocating DsttwrpropsparmsData%TwrWid.'
         RETURN
      END IF
   END IF
   DsttwrpropsparmsData%TwrWid = SrctwrpropsparmsData%TwrWid
ENDIF
IF (ALLOCATED(SrctwrpropsparmsData%TwrCD)) THEN
   i1_l = LBOUND(SrctwrpropsparmsData%TwrCD,1)
   i1_u = UBOUND(SrctwrpropsparmsData%TwrCD,1)
   i2_l = LBOUND(SrctwrpropsparmsData%TwrCD,2)
   i2_u = UBOUND(SrctwrpropsparmsData%TwrCD,2)
   IF (.NOT.ALLOCATED(DsttwrpropsparmsData%TwrCD)) THEN 
      ALLOCATE(DsttwrpropsparmsData%TwrCD(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copytwrpropsparms: Error allocating DsttwrpropsparmsData%TwrCD.'
         RETURN
      END IF
   END IF
   DsttwrpropsparmsData%TwrCD = SrctwrpropsparmsData%TwrCD
ENDIF
IF (ALLOCATED(SrctwrpropsparmsData%TwrRe)) THEN
   i1_l = LBOUND(SrctwrpropsparmsData%TwrRe,1)
   i1_u = UBOUND(SrctwrpropsparmsData%TwrRe,1)
   IF (.NOT.ALLOCATED(DsttwrpropsparmsData%TwrRe)) THEN 
      ALLOCATE(DsttwrpropsparmsData%TwrRe(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copytwrpropsparms: Error allocating DsttwrpropsparmsData%TwrRe.'
         RETURN
      END IF
   END IF
   DsttwrpropsparmsData%TwrRe = SrctwrpropsparmsData%TwrRe
ENDIF
   DsttwrpropsparmsData%VTwr = SrctwrpropsparmsData%VTwr
   DsttwrpropsparmsData%Tower_Wake_Constant = SrctwrpropsparmsData%Tower_Wake_Constant
IF (ALLOCATED(SrctwrpropsparmsData%NTwrCDCol)) THEN
   i1_l = LBOUND(SrctwrpropsparmsData%NTwrCDCol,1)
   i1_u = UBOUND(SrctwrpropsparmsData%NTwrCDCol,1)
   IF (.NOT.ALLOCATED(DsttwrpropsparmsData%NTwrCDCol)) THEN 
      ALLOCATE(DsttwrpropsparmsData%NTwrCDCol(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copytwrpropsparms: Error allocating DsttwrpropsparmsData%NTwrCDCol.'
         RETURN
      END IF
   END IF
   DsttwrpropsparmsData%NTwrCDCol = SrctwrpropsparmsData%NTwrCDCol
ENDIF
   DsttwrpropsparmsData%NTwrHT = SrctwrpropsparmsData%NTwrHT
   DsttwrpropsparmsData%NTwrRe = SrctwrpropsparmsData%NTwrRe
   DsttwrpropsparmsData%NTwrCD = SrctwrpropsparmsData%NTwrCD
   DsttwrpropsparmsData%TwrPotent = SrctwrpropsparmsData%TwrPotent
   DsttwrpropsparmsData%TwrShadow = SrctwrpropsparmsData%TwrShadow
   DsttwrpropsparmsData%ShadHWid = SrctwrpropsparmsData%ShadHWid
   DsttwrpropsparmsData%TShadC1 = SrctwrpropsparmsData%TShadC1
   DsttwrpropsparmsData%TShadC2 = SrctwrpropsparmsData%TShadC2
   DsttwrpropsparmsData%TwrShad = SrctwrpropsparmsData%TwrShad
   DsttwrpropsparmsData%PJM_Version = SrctwrpropsparmsData%PJM_Version
   DsttwrpropsparmsData%TwrFile = SrctwrpropsparmsData%TwrFile
   DsttwrpropsparmsData%T_Shad_Refpt = SrctwrpropsparmsData%T_Shad_Refpt
   DsttwrpropsparmsData%CalcTwrAero = SrctwrpropsparmsData%CalcTwrAero
   DsttwrpropsparmsData%NumTwrNodes = SrctwrpropsparmsData%NumTwrNodes
IF (ALLOCATED(SrctwrpropsparmsData%TwrNodeWidth)) THEN
   i1_l = LBOUND(SrctwrpropsparmsData%TwrNodeWidth,1)
   i1_u = UBOUND(SrctwrpropsparmsData%TwrNodeWidth,1)
   IF (.NOT.ALLOCATED(DsttwrpropsparmsData%TwrNodeWidth)) THEN 
      ALLOCATE(DsttwrpropsparmsData%TwrNodeWidth(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_Copytwrpropsparms: Error allocating DsttwrpropsparmsData%TwrNodeWidth.'
         RETURN
      END IF
   END IF
   DsttwrpropsparmsData%TwrNodeWidth = SrctwrpropsparmsData%TwrNodeWidth
ENDIF
 END SUBROUTINE AD_Copytwrpropsparms

 SUBROUTINE AD_Destroytwrpropsparms( twrpropsparmsData, ErrStat, ErrMsg )
  TYPE(twrpropsparms), INTENT(INOUT) :: twrpropsparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(twrpropsparmsData%TwrHtFr)) THEN
   DEALLOCATE(twrpropsparmsData%TwrHtFr)
ENDIF
IF (ALLOCATED(twrpropsparmsData%TwrWid)) THEN
   DEALLOCATE(twrpropsparmsData%TwrWid)
ENDIF
IF (ALLOCATED(twrpropsparmsData%TwrCD)) THEN
   DEALLOCATE(twrpropsparmsData%TwrCD)
ENDIF
IF (ALLOCATED(twrpropsparmsData%TwrRe)) THEN
   DEALLOCATE(twrpropsparmsData%TwrRe)
ENDIF
IF (ALLOCATED(twrpropsparmsData%NTwrCDCol)) THEN
   DEALLOCATE(twrpropsparmsData%NTwrCDCol)
ENDIF
IF (ALLOCATED(twrpropsparmsData%TwrNodeWidth)) THEN
   DEALLOCATE(twrpropsparmsData%TwrNodeWidth)
ENDIF
 END SUBROUTINE AD_Destroytwrpropsparms

 SUBROUTINE AD_Packtwrpropsparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(twrpropsparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrHtFr )  ! TwrHtFr 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrWid )  ! TwrWid 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrCD )  ! TwrCD 
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrRe )  ! TwrRe 
  Re_BufSz    = Re_BufSz    + SIZE( InData%VTwr )  ! VTwr 
  Re_BufSz   = Re_BufSz   + 1  ! Tower_Wake_Constant
  Int_BufSz   = Int_BufSz   + SIZE( InData%NTwrCDCol )  ! NTwrCDCol 
  Int_BufSz  = Int_BufSz  + 1  ! NTwrHT
  Int_BufSz  = Int_BufSz  + 1  ! NTwrRe
  Int_BufSz  = Int_BufSz  + 1  ! NTwrCD
  Re_BufSz   = Re_BufSz   + 1  ! ShadHWid
  Re_BufSz   = Re_BufSz   + 1  ! TShadC1
  Re_BufSz   = Re_BufSz   + 1  ! TShadC2
  Re_BufSz   = Re_BufSz   + 1  ! TwrShad
  Re_BufSz   = Re_BufSz   + 1  ! T_Shad_Refpt
  Int_BufSz  = Int_BufSz  + 1  ! NumTwrNodes
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrNodeWidth )  ! TwrNodeWidth 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( ALLOCATED(InData%TwrHtFr) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrHtFr))-1 ) =  PACK(InData%TwrHtFr ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrHtFr)
  ENDIF
  IF ( ALLOCATED(InData%TwrWid) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrWid))-1 ) =  PACK(InData%TwrWid ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrWid)
  ENDIF
  IF ( ALLOCATED(InData%TwrCD) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrCD))-1 ) =  PACK(InData%TwrCD ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrCD)
  ENDIF
  IF ( ALLOCATED(InData%TwrRe) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrRe))-1 ) =  PACK(InData%TwrRe ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrRe)
  ENDIF
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%VTwr))-1 ) =  PACK(InData%VTwr ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%VTwr)
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Tower_Wake_Constant )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(InData%NTwrCDCol) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%NTwrCDCol))-1 ) = PACK(InData%NTwrCDCol ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%NTwrCDCol)
  ENDIF
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrHT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrRe )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NTwrCD )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ShadHWid )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TShadC1 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TShadC2 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwrShad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%T_Shad_Refpt )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumTwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TwrNodeWidth) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrNodeWidth))-1 ) =  PACK(InData%TwrNodeWidth ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrNodeWidth)
  ENDIF
 END SUBROUTINE AD_Packtwrpropsparms

 SUBROUTINE AD_UnPacktwrpropsparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(twrpropsparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  IF ( ALLOCATED(OutData%TwrHtFr) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrHtFr,1))); mask1 = .TRUE.
    OutData%TwrHtFr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrHtFr))-1 ),mask1,OutData%TwrHtFr)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrHtFr)
  ENDIF
  IF ( ALLOCATED(OutData%TwrWid) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrWid,1))); mask1 = .TRUE.
    OutData%TwrWid = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrWid))-1 ),mask1,OutData%TwrWid)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrWid)
  ENDIF
  IF ( ALLOCATED(OutData%TwrCD) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TwrCD,1),SIZE(OutData%TwrCD,2))); mask2 = .TRUE.
    OutData%TwrCD = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrCD))-1 ),mask2,OutData%TwrCD)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrCD)
  ENDIF
  IF ( ALLOCATED(OutData%TwrRe) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrRe,1))); mask1 = .TRUE.
    OutData%TwrRe = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrRe))-1 ),mask1,OutData%TwrRe)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrRe)
  ENDIF
  ALLOCATE(mask1(SIZE(OutData%VTwr,1))); mask1 = .TRUE.
  OutData%VTwr = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%VTwr))-1 ),mask1,OutData%VTwr)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%VTwr)
  OutData%Tower_Wake_Constant = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  IF ( ALLOCATED(OutData%NTwrCDCol) ) THEN
  ALLOCATE(mask1(SIZE(OutData%NTwrCDCol,1))); mask1 = .TRUE.
    OutData%NTwrCDCol = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%NTwrCDCol))-1 ),mask1,OutData%NTwrCDCol)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%NTwrCDCol)
  ENDIF
  OutData%NTwrHT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwrRe = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NTwrCD = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%ShadHWid = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TShadC1 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TShadC2 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TwrShad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%T_Shad_Refpt = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumTwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrNodeWidth) ) THEN
  ALLOCATE(mask1(SIZE(OutData%TwrNodeWidth,1))); mask1 = .TRUE.
    OutData%TwrNodeWidth = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrNodeWidth))-1 ),mask1,OutData%TwrNodeWidth)
  DEALLOCATE(mask1)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrNodeWidth)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPacktwrpropsparms

 SUBROUTINE AD_Copywind( SrcwindData, DstwindData, CtrlCode, ErrStat, ErrMsg )
   TYPE(wind), INTENT(INOUT) :: SrcwindData
   TYPE(wind), INTENT(INOUT) :: DstwindData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstwindData%ANGFLW = SrcwindData%ANGFLW
   DstwindData%CDEL = SrcwindData%CDEL
   DstwindData%VROTORX = SrcwindData%VROTORX
   DstwindData%VROTORY = SrcwindData%VROTORY
   DstwindData%VROTORZ = SrcwindData%VROTORZ
   DstwindData%SDEL = SrcwindData%SDEL
 END SUBROUTINE AD_Copywind

 SUBROUTINE AD_Destroywind( windData, ErrStat, ErrMsg )
  TYPE(wind), INTENT(INOUT) :: windData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroywind

 SUBROUTINE AD_Packwind( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(wind),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! ANGFLW
  Re_BufSz   = Re_BufSz   + 1  ! CDEL
  Re_BufSz   = Re_BufSz   + 1  ! VROTORX
  Re_BufSz   = Re_BufSz   + 1  ! VROTORY
  Re_BufSz   = Re_BufSz   + 1  ! VROTORZ
  Re_BufSz   = Re_BufSz   + 1  ! SDEL
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%ANGFLW )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%CDEL )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORX )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORY )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%VROTORZ )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%SDEL )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packwind

 SUBROUTINE AD_UnPackwind( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(wind), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%ANGFLW = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%CDEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORX = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORY = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%VROTORZ = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%SDEL = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackwind

 SUBROUTINE AD_Copywindparms( SrcwindparmsData, DstwindparmsData, CtrlCode, ErrStat, ErrMsg )
   TYPE(windparms), INTENT(INOUT) :: SrcwindparmsData
   TYPE(windparms), INTENT(INOUT) :: DstwindparmsData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstwindparmsData%Rho = SrcwindparmsData%Rho
   DstwindparmsData%KinVisc = SrcwindparmsData%KinVisc
 END SUBROUTINE AD_Copywindparms

 SUBROUTINE AD_Destroywindparms( windparmsData, ErrStat, ErrMsg )
  TYPE(windparms), INTENT(INOUT) :: windparmsData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroywindparms

 SUBROUTINE AD_Packwindparms( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(windparms),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! Rho
  Re_BufSz   = Re_BufSz   + 1  ! KinVisc
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Rho )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%KinVisc )
  Re_Xferred   = Re_Xferred   + 1
 END SUBROUTINE AD_Packwindparms

 SUBROUTINE AD_UnPackwindparms( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(windparms), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%Rho = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%KinVisc = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackwindparms

 SUBROUTINE AD_Copypositiontype( SrcpositiontypeData, DstpositiontypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(positiontype), INTENT(INOUT) :: SrcpositiontypeData
   TYPE(positiontype), INTENT(INOUT) :: DstpositiontypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstpositiontypeData%Pos = SrcpositiontypeData%Pos
 END SUBROUTINE AD_Copypositiontype

 SUBROUTINE AD_Destroypositiontype( positiontypeData, ErrStat, ErrMsg )
  TYPE(positiontype), INTENT(INOUT) :: positiontypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroypositiontype

 SUBROUTINE AD_Packpositiontype( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(positiontype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Pos )  ! Pos 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Pos))-1 ) =  PACK(InData%Pos ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Pos)
 END SUBROUTINE AD_Packpositiontype

 SUBROUTINE AD_UnPackpositiontype( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(positiontype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask1(SIZE(OutData%Pos,1))); mask1 = .TRUE.
  OutData%Pos = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Pos))-1 ),mask1,OutData%Pos)
  DEALLOCATE(mask1)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Pos)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackpositiontype

 SUBROUTINE AD_Copyorientationtype( SrcorientationtypeData, DstorientationtypeData, CtrlCode, ErrStat, ErrMsg )
   TYPE(orientationtype), INTENT(INOUT) :: SrcorientationtypeData
   TYPE(orientationtype), INTENT(INOUT) :: DstorientationtypeData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstorientationtypeData%Orient = SrcorientationtypeData%Orient
 END SUBROUTINE AD_Copyorientationtype

 SUBROUTINE AD_Destroyorientationtype( orientationtypeData, ErrStat, ErrMsg )
  TYPE(orientationtype), INTENT(INOUT) :: orientationtypeData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
 END SUBROUTINE AD_Destroyorientationtype

 SUBROUTINE AD_Packorientationtype( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(orientationtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz    = Re_BufSz    + SIZE( InData%Orient )  ! Orient 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%Orient))-1 ) =  PACK(InData%Orient ,.TRUE.)
  Re_Xferred   = Re_Xferred   + SIZE(InData%Orient)
 END SUBROUTINE AD_Packorientationtype

 SUBROUTINE AD_UnPackorientationtype( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(orientationtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  ALLOCATE(mask2(SIZE(OutData%Orient,1),SIZE(OutData%Orient,2))); mask2 = .TRUE.
  OutData%Orient = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%Orient))-1 ),mask2,OutData%Orient)
  DEALLOCATE(mask2)
  Re_Xferred   = Re_Xferred   + SIZE(OutData%Orient)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackorientationtype

 SUBROUTINE AD_CopyInitInput( SrcInitInputData, DstInitInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_initinputtype), INTENT(INOUT) :: SrcInitInputData
   TYPE(AD_initinputtype), INTENT(INOUT) :: DstInitInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstInitInputData%Title = SrcInitInputData%Title
   DstInitInputData%OutRootName = SrcInitInputData%OutRootName
   DstInitInputData%ADFileName = SrcInitInputData%ADFileName
   DstInitInputData%WindFileName = SrcInitInputData%WindFileName
   DstInitInputData%WrSumFile = SrcInitInputData%WrSumFile
   DstInitInputData%NumBl = SrcInitInputData%NumBl
   DstInitInputData%BladeLength = SrcInitInputData%BladeLength
   DstInitInputData%LinearizeFlag = SrcInitInputData%LinearizeFlag
      CALL AD_Copyaeroconfig( SrcInitInputData%TurbineComponents, DstInitInputData%TurbineComponents, CtrlCode, ErrStat, ErrMsg )
   DstInitInputData%NumTwrNodes = SrcInitInputData%NumTwrNodes
IF (ALLOCATED(SrcInitInputData%TwrNodeLocs)) THEN
   i1_l = LBOUND(SrcInitInputData%TwrNodeLocs,1)
   i1_u = UBOUND(SrcInitInputData%TwrNodeLocs,1)
   i2_l = LBOUND(SrcInitInputData%TwrNodeLocs,2)
   i2_u = UBOUND(SrcInitInputData%TwrNodeLocs,2)
   IF (.NOT.ALLOCATED(DstInitInputData%TwrNodeLocs)) THEN 
      ALLOCATE(DstInitInputData%TwrNodeLocs(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyInitInput: Error allocating DstInitInputData%TwrNodeLocs.'
         RETURN
      END IF
   END IF
   DstInitInputData%TwrNodeLocs = SrcInitInputData%TwrNodeLocs
ENDIF
      CALL IfW_CopyInitInput( SrcInitInputData%IfW_InitInputs, DstInitInputData%IfW_InitInputs, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyInitInput

 SUBROUTINE AD_DestroyInitInput( InitInputData, ErrStat, ErrMsg )
  TYPE(AD_initinputtype), INTENT(INOUT) :: InitInputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroyaeroconfig( InitInputData%TurbineComponents, ErrStat, ErrMsg )
IF (ALLOCATED(InitInputData%TwrNodeLocs)) THEN
   DEALLOCATE(InitInputData%TwrNodeLocs)
ENDIF
  CALL IfW_DestroyInitInput( InitInputData%IfW_InitInputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyInitInput

 SUBROUTINE AD_PackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_initinputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_InitInputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_InitInputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_InitInputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Re_BufSz   = Re_BufSz   + 1  ! BladeLength
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Db_TurbineComponents_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Int_TurbineComponents_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TurbineComponents_Buf ) ! TurbineComponents
  IF(ALLOCATED(Re_TurbineComponents_Buf))  DEALLOCATE(Re_TurbineComponents_Buf)
  IF(ALLOCATED(Db_TurbineComponents_Buf))  DEALLOCATE(Db_TurbineComponents_Buf)
  IF(ALLOCATED(Int_TurbineComponents_Buf)) DEALLOCATE(Int_TurbineComponents_Buf)
  Int_BufSz  = Int_BufSz  + 1  ! NumTwrNodes
  Re_BufSz    = Re_BufSz    + SIZE( InData%TwrNodeLocs )  ! TwrNodeLocs 
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, InData%IfW_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_InitInputs_Buf  ) ! IfW_InitInputs
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_InitInputs_Buf  ) ! IfW_InitInputs
  IF(ALLOCATED(Int_IfW_InitInputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_InitInputs_Buf ) ! IfW_InitInputs
  IF(ALLOCATED(Re_IfW_InitInputs_Buf))  DEALLOCATE(Re_IfW_InitInputs_Buf)
  IF(ALLOCATED(Db_IfW_InitInputs_Buf))  DEALLOCATE(Db_IfW_InitInputs_Buf)
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) DEALLOCATE(Int_IfW_InitInputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%BladeLength )
  Re_Xferred   = Re_Xferred   + 1
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, OnlySize ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 ) = Re_TurbineComponents_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 ) = Db_TurbineComponents_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 ) = Int_TurbineComponents_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  IF( ALLOCATED(Re_TurbineComponents_Buf) )  DEALLOCATE(Re_TurbineComponents_Buf)
  IF( ALLOCATED(Db_TurbineComponents_Buf) )  DEALLOCATE(Db_TurbineComponents_Buf)
  IF( ALLOCATED(Int_TurbineComponents_Buf) ) DEALLOCATE(Int_TurbineComponents_Buf)
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumTwrNodes )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(InData%TwrNodeLocs) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%TwrNodeLocs))-1 ) =  PACK(InData%TwrNodeLocs ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%TwrNodeLocs)
  ENDIF
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, InData%IfW_InitInputs, ErrStat, ErrMsg, OnlySize ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitInputs_Buf)-1 ) = Re_IfW_InitInputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitInputs_Buf)-1 ) = Db_IfW_InitInputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitInputs_Buf)-1 ) = Int_IfW_InitInputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitInputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_InitInputs_Buf) )  DEALLOCATE(Re_IfW_InitInputs_Buf)
  IF( ALLOCATED(Db_IfW_InitInputs_Buf) )  DEALLOCATE(Db_IfW_InitInputs_Buf)
  IF( ALLOCATED(Int_IfW_InitInputs_Buf) ) DEALLOCATE(Int_IfW_InitInputs_Buf)
 END SUBROUTINE AD_PackInitInput

 SUBROUTINE AD_UnPackInitInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_initinputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_InitInputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_InitInputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_InitInputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%BladeLength = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
 ! first call AD_Packaeroconfig to get correctly sized buffers for unpacking
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    Re_TurbineComponents_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    Db_TurbineComponents_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    Int_TurbineComponents_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  CALL AD_UnPackaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg ) ! TurbineComponents 
  OutData%NumTwrNodes = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  IF ( ALLOCATED(OutData%TwrNodeLocs) ) THEN
  ALLOCATE(mask2(SIZE(OutData%TwrNodeLocs,1),SIZE(OutData%TwrNodeLocs,2))); mask2 = .TRUE.
    OutData%TwrNodeLocs = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%TwrNodeLocs))-1 ),mask2,OutData%TwrNodeLocs)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%TwrNodeLocs)
  ENDIF
 ! first call IfW_PackInitInput to get correctly sized buffers for unpacking
  CALL IfW_PackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, OutData%IfW_InitInputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitInputs 
  IF(ALLOCATED(Re_IfW_InitInputs_Buf)) THEN
    Re_IfW_InitInputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitInputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitInputs_Buf)) THEN
    Db_IfW_InitInputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitInputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitInputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitInputs_Buf)) THEN
    Int_IfW_InitInputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitInputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitInputs_Buf)
  ENDIF
  CALL IfW_UnPackInitInput( Re_IfW_InitInputs_Buf, Db_IfW_InitInputs_Buf, Int_IfW_InitInputs_Buf, OutData%IfW_InitInputs, ErrStat, ErrMsg ) ! IfW_InitInputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInitInput

 SUBROUTINE AD_CopyInitOutput( SrcInitOutputData, DstInitOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_initoutputtype), INTENT(INOUT) :: SrcInitOutputData
   TYPE(AD_initoutputtype), INTENT(INOUT) :: DstInitOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
      CALL NWTC_Library_Copyprogdesc( SrcInitOutputData%Ver, DstInitOutputData%Ver, CtrlCode, ErrStat, ErrMsg )
      CALL IfW_CopyInitOutput( SrcInitOutputData%IfW_InitOutput, DstInitOutputData%IfW_InitOutput, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyInitOutput

 SUBROUTINE AD_DestroyInitOutput( InitOutputData, ErrStat, ErrMsg )
  TYPE(AD_initoutputtype), INTENT(INOUT) :: InitOutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL NWTC_Library_Destroyprogdesc( InitOutputData%Ver, ErrStat, ErrMsg )
  CALL IfW_DestroyInitOutput( InitOutputData%IfW_InitOutput, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyInitOutput

 SUBROUTINE AD_PackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_initoutputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Ver_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_InitOutput_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_InitOutput_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_InitOutput_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Db_Ver_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Ver_Buf  ) ! Ver
  IF(ALLOCATED(Int_Ver_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Ver_Buf ) ! Ver
  IF(ALLOCATED(Re_Ver_Buf))  DEALLOCATE(Re_Ver_Buf)
  IF(ALLOCATED(Db_Ver_Buf))  DEALLOCATE(Db_Ver_Buf)
  IF(ALLOCATED(Int_Ver_Buf)) DEALLOCATE(Int_Ver_Buf)
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, InData%IfW_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_InitOutput_Buf  ) ! IfW_InitOutput
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_InitOutput_Buf  ) ! IfW_InitOutput
  IF(ALLOCATED(Int_IfW_InitOutput_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_InitOutput_Buf ) ! IfW_InitOutput
  IF(ALLOCATED(Re_IfW_InitOutput_Buf))  DEALLOCATE(Re_IfW_InitOutput_Buf)
  IF(ALLOCATED(Db_IfW_InitOutput_Buf))  DEALLOCATE(Db_IfW_InitOutput_Buf)
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) DEALLOCATE(Int_IfW_InitOutput_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, InData%Ver, ErrStat, ErrMsg, OnlySize ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 ) = Re_Ver_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 ) = Db_Ver_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 ) = Int_Ver_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  IF( ALLOCATED(Re_Ver_Buf) )  DEALLOCATE(Re_Ver_Buf)
  IF( ALLOCATED(Db_Ver_Buf) )  DEALLOCATE(Db_Ver_Buf)
  IF( ALLOCATED(Int_Ver_Buf) ) DEALLOCATE(Int_Ver_Buf)
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, InData%IfW_InitOutput, ErrStat, ErrMsg, OnlySize ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitOutput_Buf)-1 ) = Re_IfW_InitOutput_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitOutput_Buf)-1 ) = Db_IfW_InitOutput_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitOutput_Buf)-1 ) = Int_IfW_InitOutput_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitOutput_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_InitOutput_Buf) )  DEALLOCATE(Re_IfW_InitOutput_Buf)
  IF( ALLOCATED(Db_IfW_InitOutput_Buf) )  DEALLOCATE(Db_IfW_InitOutput_Buf)
  IF( ALLOCATED(Int_IfW_InitOutput_Buf) ) DEALLOCATE(Int_IfW_InitOutput_Buf)
 END SUBROUTINE AD_PackInitOutput

 SUBROUTINE AD_UnPackInitOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_initoutputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_Ver_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Ver_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Ver_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_InitOutput_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_InitOutput_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_InitOutput_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
 ! first call NWTC_Library_Packprogdesc to get correctly sized buffers for unpacking
  CALL NWTC_Library_Packprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg, .TRUE. ) ! Ver 
  IF(ALLOCATED(Re_Ver_Buf)) THEN
    Re_Ver_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Ver_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Db_Ver_Buf)) THEN
    Db_Ver_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Ver_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Ver_Buf)
  ENDIF
  IF(ALLOCATED(Int_Ver_Buf)) THEN
    Int_Ver_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Ver_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Ver_Buf)
  ENDIF
  CALL NWTC_Library_UnPackprogdesc( Re_Ver_Buf, Db_Ver_Buf, Int_Ver_Buf, OutData%Ver, ErrStat, ErrMsg ) ! Ver 
 ! first call IfW_PackInitOutput to get correctly sized buffers for unpacking
  CALL IfW_PackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, OutData%IfW_InitOutput, ErrStat, ErrMsg, .TRUE. ) ! IfW_InitOutput 
  IF(ALLOCATED(Re_IfW_InitOutput_Buf)) THEN
    Re_IfW_InitOutput_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_InitOutput_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_InitOutput_Buf)) THEN
    Db_IfW_InitOutput_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_InitOutput_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_InitOutput_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_InitOutput_Buf)) THEN
    Int_IfW_InitOutput_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_InitOutput_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_InitOutput_Buf)
  ENDIF
  CALL IfW_UnPackInitOutput( Re_IfW_InitOutput_Buf, Db_IfW_InitOutput_Buf, Int_IfW_InitOutput_Buf, OutData%IfW_InitOutput, ErrStat, ErrMsg ) ! IfW_InitOutput 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInitOutput

 SUBROUTINE AD_CopyContState( SrcContStateData, DstContStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_continuousstatetype), INTENT(INOUT) :: SrcContStateData
   TYPE(AD_continuousstatetype), INTENT(INOUT) :: DstContStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstContStateData%DummyDiscState = SrcContStateData%DummyDiscState
      CALL IfW_CopyContState( SrcContStateData%IfW_ContStates, DstContStateData%IfW_ContStates, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyContState

 SUBROUTINE AD_DestroyContState( ContStateData, ErrStat, ErrMsg )
  TYPE(AD_continuousstatetype), INTENT(INOUT) :: ContStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyContState( ContStateData%IfW_ContStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyContState

 SUBROUTINE AD_PackContState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_continuousstatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_ContStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_ContStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_ContStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyDiscState
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, InData%IfW_ContStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_ContStates_Buf  ) ! IfW_ContStates
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_ContStates_Buf  ) ! IfW_ContStates
  IF(ALLOCATED(Int_IfW_ContStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_ContStates_Buf ) ! IfW_ContStates
  IF(ALLOCATED(Re_IfW_ContStates_Buf))  DEALLOCATE(Re_IfW_ContStates_Buf)
  IF(ALLOCATED(Db_IfW_ContStates_Buf))  DEALLOCATE(Db_IfW_ContStates_Buf)
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) DEALLOCATE(Int_IfW_ContStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyDiscState )
  Re_Xferred   = Re_Xferred   + 1
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, InData%IfW_ContStates, ErrStat, ErrMsg, OnlySize ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ContStates_Buf)-1 ) = Re_IfW_ContStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ContStates_Buf)-1 ) = Db_IfW_ContStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ContStates_Buf)-1 ) = Int_IfW_ContStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ContStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_ContStates_Buf) )  DEALLOCATE(Re_IfW_ContStates_Buf)
  IF( ALLOCATED(Db_IfW_ContStates_Buf) )  DEALLOCATE(Db_IfW_ContStates_Buf)
  IF( ALLOCATED(Int_IfW_ContStates_Buf) ) DEALLOCATE(Int_IfW_ContStates_Buf)
 END SUBROUTINE AD_PackContState

 SUBROUTINE AD_UnPackContState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_continuousstatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_ContStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_ContStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_ContStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyDiscState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
 ! first call IfW_PackContState to get correctly sized buffers for unpacking
  CALL IfW_PackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, OutData%IfW_ContStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ContStates 
  IF(ALLOCATED(Re_IfW_ContStates_Buf)) THEN
    Re_IfW_ContStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ContStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ContStates_Buf)) THEN
    Db_IfW_ContStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ContStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ContStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ContStates_Buf)) THEN
    Int_IfW_ContStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ContStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ContStates_Buf)
  ENDIF
  CALL IfW_UnPackContState( Re_IfW_ContStates_Buf, Db_IfW_ContStates_Buf, Int_IfW_ContStates_Buf, OutData%IfW_ContStates, ErrStat, ErrMsg ) ! IfW_ContStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackContState

 SUBROUTINE AD_CopyDiscState( SrcDiscStateData, DstDiscStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_discretestatetype), INTENT(INOUT) :: SrcDiscStateData
   TYPE(AD_discretestatetype), INTENT(INOUT) :: DstDiscStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstDiscStateData%DummyDiscState = SrcDiscStateData%DummyDiscState
      CALL IfW_CopyDiscState( SrcDiscStateData%IfW_DiscStates, DstDiscStateData%IfW_DiscStates, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyDiscState

 SUBROUTINE AD_DestroyDiscState( DiscStateData, ErrStat, ErrMsg )
  TYPE(AD_discretestatetype), INTENT(INOUT) :: DiscStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyDiscState( DiscStateData%IfW_DiscStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyDiscState

 SUBROUTINE AD_PackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_discretestatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_DiscStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_DiscStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_DiscStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyDiscState
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, InData%IfW_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_DiscStates_Buf  ) ! IfW_DiscStates
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_DiscStates_Buf  ) ! IfW_DiscStates
  IF(ALLOCATED(Int_IfW_DiscStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_DiscStates_Buf ) ! IfW_DiscStates
  IF(ALLOCATED(Re_IfW_DiscStates_Buf))  DEALLOCATE(Re_IfW_DiscStates_Buf)
  IF(ALLOCATED(Db_IfW_DiscStates_Buf))  DEALLOCATE(Db_IfW_DiscStates_Buf)
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) DEALLOCATE(Int_IfW_DiscStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyDiscState )
  Re_Xferred   = Re_Xferred   + 1
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, InData%IfW_DiscStates, ErrStat, ErrMsg, OnlySize ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_DiscStates_Buf)-1 ) = Re_IfW_DiscStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_DiscStates_Buf)-1 ) = Db_IfW_DiscStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_DiscStates_Buf)-1 ) = Int_IfW_DiscStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_DiscStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_DiscStates_Buf) )  DEALLOCATE(Re_IfW_DiscStates_Buf)
  IF( ALLOCATED(Db_IfW_DiscStates_Buf) )  DEALLOCATE(Db_IfW_DiscStates_Buf)
  IF( ALLOCATED(Int_IfW_DiscStates_Buf) ) DEALLOCATE(Int_IfW_DiscStates_Buf)
 END SUBROUTINE AD_PackDiscState

 SUBROUTINE AD_UnPackDiscState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_discretestatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_DiscStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_DiscStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_DiscStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyDiscState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
 ! first call IfW_PackDiscState to get correctly sized buffers for unpacking
  CALL IfW_PackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, OutData%IfW_DiscStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_DiscStates 
  IF(ALLOCATED(Re_IfW_DiscStates_Buf)) THEN
    Re_IfW_DiscStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_DiscStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_DiscStates_Buf)) THEN
    Db_IfW_DiscStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_DiscStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_DiscStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_DiscStates_Buf)) THEN
    Int_IfW_DiscStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_DiscStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_DiscStates_Buf)
  ENDIF
  CALL IfW_UnPackDiscState( Re_IfW_DiscStates_Buf, Db_IfW_DiscStates_Buf, Int_IfW_DiscStates_Buf, OutData%IfW_DiscStates, ErrStat, ErrMsg ) ! IfW_DiscStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackDiscState

 SUBROUTINE AD_CopyConstrState( SrcConstrStateData, DstConstrStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_constraintstatetype), INTENT(INOUT) :: SrcConstrStateData
   TYPE(AD_constraintstatetype), INTENT(INOUT) :: DstConstrStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstConstrStateData%DummyConstrState = SrcConstrStateData%DummyConstrState
      CALL IfW_CopyConstrState( SrcConstrStateData%IfW_ConstrStates, DstConstrStateData%IfW_ConstrStates, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyConstrState

 SUBROUTINE AD_DestroyConstrState( ConstrStateData, ErrStat, ErrMsg )
  TYPE(AD_constraintstatetype), INTENT(INOUT) :: ConstrStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL IfW_DestroyConstrState( ConstrStateData%IfW_ConstrStates, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyConstrState

 SUBROUTINE AD_PackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_constraintstatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_ConstrStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_ConstrStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_ConstrStates_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! DummyConstrState
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, InData%IfW_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_ConstrStates_Buf  ) ! IfW_ConstrStates
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_ConstrStates_Buf  ) ! IfW_ConstrStates
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_ConstrStates_Buf ) ! IfW_ConstrStates
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf))  DEALLOCATE(Re_IfW_ConstrStates_Buf)
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf))  DEALLOCATE(Db_IfW_ConstrStates_Buf)
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) DEALLOCATE(Int_IfW_ConstrStates_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%DummyConstrState )
  Re_Xferred   = Re_Xferred   + 1
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, InData%IfW_ConstrStates, ErrStat, ErrMsg, OnlySize ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ConstrStates_Buf)-1 ) = Re_IfW_ConstrStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ConstrStates_Buf)-1 ) = Db_IfW_ConstrStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ConstrStates_Buf)-1 ) = Int_IfW_ConstrStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ConstrStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_ConstrStates_Buf) )  DEALLOCATE(Re_IfW_ConstrStates_Buf)
  IF( ALLOCATED(Db_IfW_ConstrStates_Buf) )  DEALLOCATE(Db_IfW_ConstrStates_Buf)
  IF( ALLOCATED(Int_IfW_ConstrStates_Buf) ) DEALLOCATE(Int_IfW_ConstrStates_Buf)
 END SUBROUTINE AD_PackConstrState

 SUBROUTINE AD_UnPackConstrState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_constraintstatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_ConstrStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_ConstrStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_ConstrStates_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyConstrState = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
 ! first call IfW_PackConstrState to get correctly sized buffers for unpacking
  CALL IfW_PackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, OutData%IfW_ConstrStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_ConstrStates 
  IF(ALLOCATED(Re_IfW_ConstrStates_Buf)) THEN
    Re_IfW_ConstrStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_ConstrStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_ConstrStates_Buf)) THEN
    Db_IfW_ConstrStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_ConstrStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_ConstrStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_ConstrStates_Buf)) THEN
    Int_IfW_ConstrStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_ConstrStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_ConstrStates_Buf)
  ENDIF
  CALL IfW_UnPackConstrState( Re_IfW_ConstrStates_Buf, Db_IfW_ConstrStates_Buf, Int_IfW_ConstrStates_Buf, OutData%IfW_ConstrStates, ErrStat, ErrMsg ) ! IfW_ConstrStates 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackConstrState

 SUBROUTINE AD_CopyOtherState( SrcOtherStateData, DstOtherStateData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_otherstatetype), INTENT(INOUT) :: SrcOtherStateData
   TYPE(AD_otherstatetype), INTENT(INOUT) :: DstOtherStateData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstOtherStateData%DummyOtherState = SrcOtherStateData%DummyOtherState
   DstOtherStateData%DT = SrcOtherStateData%DT
IF (ALLOCATED(SrcOtherStateData%ElPrNum)) THEN
   i1_l = LBOUND(SrcOtherStateData%ElPrNum,1)
   i1_u = UBOUND(SrcOtherStateData%ElPrNum,1)
   IF (.NOT.ALLOCATED(DstOtherStateData%ElPrNum)) THEN 
      ALLOCATE(DstOtherStateData%ElPrNum(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyOtherState: Error allocating DstOtherStateData%ElPrNum.'
         RETURN
      END IF
   END IF
   DstOtherStateData%ElPrNum = SrcOtherStateData%ElPrNum
ENDIF
   DstOtherStateData%Time = SrcOtherStateData%Time
   DstOtherStateData%OldTime = SrcOtherStateData%OldTime
   DstOtherStateData%HubLoss = SrcOtherStateData%HubLoss
   DstOtherStateData%Loss = SrcOtherStateData%Loss
   DstOtherStateData%TipLoss = SrcOtherStateData%TipLoss
   DstOtherStateData%TLpt7 = SrcOtherStateData%TLpt7
   DstOtherStateData%FirstPassGTL = SrcOtherStateData%FirstPassGTL
   DstOtherStateData%SuperSonic = SrcOtherStateData%SuperSonic
   DstOtherStateData%AFLAGVinderr = SrcOtherStateData%AFLAGVinderr
   DstOtherStateData%AFLAGTwrInflu = SrcOtherStateData%AFLAGTwrInflu
   DstOtherStateData%OnePassDynDbg = SrcOtherStateData%OnePassDynDbg
   DstOtherStateData%NoLoadsCalculated = SrcOtherStateData%NoLoadsCalculated
   DstOtherStateData%NERRORS = SrcOtherStateData%NERRORS
      CALL IfW_CopyOtherState( SrcOtherStateData%IfW_OtherStates, DstOtherStateData%IfW_OtherStates, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyairfoil( SrcOtherStateData%AirFoil, DstOtherStateData%AirFoil, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copybeddoes( SrcOtherStateData%Beddoes, DstOtherStateData%Beddoes, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copydyninflow( SrcOtherStateData%DynInflow, DstOtherStateData%DynInflow, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyelement( SrcOtherStateData%Element, DstOtherStateData%Element, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyrotor( SrcOtherStateData%Rotor, DstOtherStateData%Rotor, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copywind( SrcOtherStateData%Wind, DstOtherStateData%Wind, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyinducedvel( SrcOtherStateData%InducedVel, DstOtherStateData%InducedVel, CtrlCode, ErrStat, ErrMsg )
IF (ALLOCATED(SrcOtherStateData%StoredForces)) THEN
   i1_l = LBOUND(SrcOtherStateData%StoredForces,1)
   i1_u = UBOUND(SrcOtherStateData%StoredForces,1)
   i2_l = LBOUND(SrcOtherStateData%StoredForces,2)
   i2_u = UBOUND(SrcOtherStateData%StoredForces,2)
   i3_l = LBOUND(SrcOtherStateData%StoredForces,3)
   i3_u = UBOUND(SrcOtherStateData%StoredForces,3)
   IF (.NOT.ALLOCATED(DstOtherStateData%StoredForces)) THEN 
      ALLOCATE(DstOtherStateData%StoredForces(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyOtherState: Error allocating DstOtherStateData%StoredForces.'
         RETURN
      END IF
   END IF
   DstOtherStateData%StoredForces = SrcOtherStateData%StoredForces
ENDIF
IF (ALLOCATED(SrcOtherStateData%StoredMoments)) THEN
   i1_l = LBOUND(SrcOtherStateData%StoredMoments,1)
   i1_u = UBOUND(SrcOtherStateData%StoredMoments,1)
   i2_l = LBOUND(SrcOtherStateData%StoredMoments,2)
   i2_u = UBOUND(SrcOtherStateData%StoredMoments,2)
   i3_l = LBOUND(SrcOtherStateData%StoredMoments,3)
   i3_u = UBOUND(SrcOtherStateData%StoredMoments,3)
   IF (.NOT.ALLOCATED(DstOtherStateData%StoredMoments)) THEN 
      ALLOCATE(DstOtherStateData%StoredMoments(i1_l:i1_u,i2_l:i2_u,i3_l:i3_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyOtherState: Error allocating DstOtherStateData%StoredMoments.'
         RETURN
      END IF
   END IF
   DstOtherStateData%StoredMoments = SrcOtherStateData%StoredMoments
ENDIF
   DstOtherStateData%FirstWarn = SrcOtherStateData%FirstWarn
      CALL AD_Copyeloutparms( SrcOtherStateData%ElOut, DstOtherStateData%ElOut, CtrlCode, ErrStat, ErrMsg )
   DstOtherStateData%Skew = SrcOtherStateData%Skew
   DstOtherStateData%DynInit = SrcOtherStateData%DynInit
 END SUBROUTINE AD_CopyOtherState

 SUBROUTINE AD_DestroyOtherState( OtherStateData, ErrStat, ErrMsg )
  TYPE(AD_otherstatetype), INTENT(INOUT) :: OtherStateData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OtherStateData%ElPrNum)) THEN
   DEALLOCATE(OtherStateData%ElPrNum)
ENDIF
  CALL IfW_DestroyOtherState( OtherStateData%IfW_OtherStates, ErrStat, ErrMsg )
  CALL AD_Destroyairfoil( OtherStateData%AirFoil, ErrStat, ErrMsg )
  CALL AD_Destroybeddoes( OtherStateData%Beddoes, ErrStat, ErrMsg )
  CALL AD_Destroydyninflow( OtherStateData%DynInflow, ErrStat, ErrMsg )
  CALL AD_Destroyelement( OtherStateData%Element, ErrStat, ErrMsg )
  CALL AD_Destroyrotor( OtherStateData%Rotor, ErrStat, ErrMsg )
  CALL AD_Destroywind( OtherStateData%Wind, ErrStat, ErrMsg )
  CALL AD_Destroyinducedvel( OtherStateData%InducedVel, ErrStat, ErrMsg )
IF (ALLOCATED(OtherStateData%StoredForces)) THEN
   DEALLOCATE(OtherStateData%StoredForces)
ENDIF
IF (ALLOCATED(OtherStateData%StoredMoments)) THEN
   DEALLOCATE(OtherStateData%StoredMoments)
ENDIF
  CALL AD_Destroyeloutparms( OtherStateData%ElOut, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyOtherState

 SUBROUTINE AD_PackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_otherstatetype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_OtherStates_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_OtherStates_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_OtherStates_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_ElOut_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_ElOut_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_ElOut_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Int_BufSz  = Int_BufSz  + 1  ! DummyOtherState
  Db_BufSz   = Db_BufSz   + 1  ! DT
  Int_BufSz   = Int_BufSz   + SIZE( InData%ElPrNum )  ! ElPrNum 
  Db_BufSz   = Db_BufSz   + 1  ! Time
  Db_BufSz   = Db_BufSz   + 1  ! OldTime
  Re_BufSz   = Re_BufSz   + 1  ! HubLoss
  Re_BufSz   = Re_BufSz   + 1  ! Loss
  Re_BufSz   = Re_BufSz   + 1  ! TipLoss
  Re_BufSz   = Re_BufSz   + 1  ! TLpt7
  Int_BufSz  = Int_BufSz  + 1  ! NERRORS
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, InData%IfW_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_OtherStates_Buf  ) ! IfW_OtherStates
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_OtherStates_Buf  ) ! IfW_OtherStates
  IF(ALLOCATED(Int_IfW_OtherStates_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_OtherStates_Buf ) ! IfW_OtherStates
  IF(ALLOCATED(Re_IfW_OtherStates_Buf))  DEALLOCATE(Re_IfW_OtherStates_Buf)
  IF(ALLOCATED(Db_IfW_OtherStates_Buf))  DEALLOCATE(Db_IfW_OtherStates_Buf)
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) DEALLOCATE(Int_IfW_OtherStates_Buf)
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Db_AirFoil_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Int_AirFoil_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AirFoil_Buf ) ! AirFoil
  IF(ALLOCATED(Re_AirFoil_Buf))  DEALLOCATE(Re_AirFoil_Buf)
  IF(ALLOCATED(Db_AirFoil_Buf))  DEALLOCATE(Db_AirFoil_Buf)
  IF(ALLOCATED(Int_AirFoil_Buf)) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Db_Beddoes_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Int_Beddoes_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Beddoes_Buf ) ! Beddoes
  IF(ALLOCATED(Re_Beddoes_Buf))  DEALLOCATE(Re_Beddoes_Buf)
  IF(ALLOCATED(Db_Beddoes_Buf))  DEALLOCATE(Db_Beddoes_Buf)
  IF(ALLOCATED(Int_Beddoes_Buf)) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Db_DynInflow_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Int_DynInflow_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DynInflow_Buf ) ! DynInflow
  IF(ALLOCATED(Re_DynInflow_Buf))  DEALLOCATE(Re_DynInflow_Buf)
  IF(ALLOCATED(Db_DynInflow_Buf))  DEALLOCATE(Db_DynInflow_Buf)
  IF(ALLOCATED(Int_DynInflow_Buf)) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Element_Buf  ) ! Element
  IF(ALLOCATED(Db_Element_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Element_Buf  ) ! Element
  IF(ALLOCATED(Int_Element_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Element_Buf ) ! Element
  IF(ALLOCATED(Re_Element_Buf))  DEALLOCATE(Re_Element_Buf)
  IF(ALLOCATED(Db_Element_Buf))  DEALLOCATE(Db_Element_Buf)
  IF(ALLOCATED(Int_Element_Buf)) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Db_Rotor_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Int_Rotor_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Rotor_Buf ) ! Rotor
  IF(ALLOCATED(Re_Rotor_Buf))  DEALLOCATE(Re_Rotor_Buf)
  IF(ALLOCATED(Db_Rotor_Buf))  DEALLOCATE(Db_Rotor_Buf)
  IF(ALLOCATED(Int_Rotor_Buf)) DEALLOCATE(Int_Rotor_Buf)
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Db_Wind_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Int_Wind_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Wind_Buf ) ! Wind
  IF(ALLOCATED(Re_Wind_Buf))  DEALLOCATE(Re_Wind_Buf)
  IF(ALLOCATED(Db_Wind_Buf))  DEALLOCATE(Db_Wind_Buf)
  IF(ALLOCATED(Int_Wind_Buf)) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Db_InducedVel_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Int_InducedVel_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InducedVel_Buf ) ! InducedVel
  IF(ALLOCATED(Re_InducedVel_Buf))  DEALLOCATE(Re_InducedVel_Buf)
  IF(ALLOCATED(Db_InducedVel_Buf))  DEALLOCATE(Db_InducedVel_Buf)
  IF(ALLOCATED(Int_InducedVel_Buf)) DEALLOCATE(Int_InducedVel_Buf)
  Re_BufSz    = Re_BufSz    + SIZE( InData%StoredForces )  ! StoredForces 
  Re_BufSz    = Re_BufSz    + SIZE( InData%StoredMoments )  ! StoredMoments 
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, InData%ElOut, ErrStat, ErrMsg, .TRUE. ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_ElOut_Buf  ) ! ElOut
  IF(ALLOCATED(Db_ElOut_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_ElOut_Buf  ) ! ElOut
  IF(ALLOCATED(Int_ElOut_Buf))Int_BufSz = Int_BufSz + SIZE( Int_ElOut_Buf ) ! ElOut
  IF(ALLOCATED(Re_ElOut_Buf))  DEALLOCATE(Re_ElOut_Buf)
  IF(ALLOCATED(Db_ElOut_Buf))  DEALLOCATE(Db_ElOut_Buf)
  IF(ALLOCATED(Int_ElOut_Buf)) DEALLOCATE(Int_ElOut_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DummyOtherState )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DT )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(InData%ElPrNum) ) THEN
    IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(SIZE(InData%ElPrNum))-1 ) = PACK(InData%ElPrNum ,.TRUE.)
    Int_Xferred   = Int_Xferred   + SIZE(InData%ElPrNum)
  ENDIF
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%Time )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%OldTime )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubLoss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%Loss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TipLoss )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TLpt7 )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NERRORS )
  Int_Xferred   = Int_Xferred   + 1
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, InData%IfW_OtherStates, ErrStat, ErrMsg, OnlySize ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_OtherStates_Buf)-1 ) = Re_IfW_OtherStates_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_OtherStates_Buf)-1 ) = Db_IfW_OtherStates_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_OtherStates_Buf)-1 ) = Int_IfW_OtherStates_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_OtherStates_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_OtherStates_Buf) )  DEALLOCATE(Re_IfW_OtherStates_Buf)
  IF( ALLOCATED(Db_IfW_OtherStates_Buf) )  DEALLOCATE(Db_IfW_OtherStates_Buf)
  IF( ALLOCATED(Int_IfW_OtherStates_Buf) ) DEALLOCATE(Int_IfW_OtherStates_Buf)
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, OnlySize ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 ) = Re_AirFoil_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 ) = Db_AirFoil_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 ) = Int_AirFoil_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  IF( ALLOCATED(Re_AirFoil_Buf) )  DEALLOCATE(Re_AirFoil_Buf)
  IF( ALLOCATED(Db_AirFoil_Buf) )  DEALLOCATE(Db_AirFoil_Buf)
  IF( ALLOCATED(Int_AirFoil_Buf) ) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, OnlySize ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 ) = Re_Beddoes_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 ) = Db_Beddoes_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 ) = Int_Beddoes_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  IF( ALLOCATED(Re_Beddoes_Buf) )  DEALLOCATE(Re_Beddoes_Buf)
  IF( ALLOCATED(Db_Beddoes_Buf) )  DEALLOCATE(Db_Beddoes_Buf)
  IF( ALLOCATED(Int_Beddoes_Buf) ) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, OnlySize ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 ) = Re_DynInflow_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 ) = Db_DynInflow_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 ) = Int_DynInflow_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  IF( ALLOCATED(Re_DynInflow_Buf) )  DEALLOCATE(Re_DynInflow_Buf)
  IF( ALLOCATED(Db_DynInflow_Buf) )  DEALLOCATE(Db_DynInflow_Buf)
  IF( ALLOCATED(Int_DynInflow_Buf) ) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, OnlySize ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 ) = Re_Element_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 ) = Db_Element_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 ) = Int_Element_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  IF( ALLOCATED(Re_Element_Buf) )  DEALLOCATE(Re_Element_Buf)
  IF( ALLOCATED(Db_Element_Buf) )  DEALLOCATE(Db_Element_Buf)
  IF( ALLOCATED(Int_Element_Buf) ) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, OnlySize ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 ) = Re_Rotor_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 ) = Db_Rotor_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 ) = Int_Rotor_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  IF( ALLOCATED(Re_Rotor_Buf) )  DEALLOCATE(Re_Rotor_Buf)
  IF( ALLOCATED(Db_Rotor_Buf) )  DEALLOCATE(Db_Rotor_Buf)
  IF( ALLOCATED(Int_Rotor_Buf) ) DEALLOCATE(Int_Rotor_Buf)
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, OnlySize ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 ) = Re_Wind_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 ) = Db_Wind_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 ) = Int_Wind_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  IF( ALLOCATED(Re_Wind_Buf) )  DEALLOCATE(Re_Wind_Buf)
  IF( ALLOCATED(Db_Wind_Buf) )  DEALLOCATE(Db_Wind_Buf)
  IF( ALLOCATED(Int_Wind_Buf) ) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, OnlySize ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 ) = Re_InducedVel_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 ) = Db_InducedVel_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 ) = Int_InducedVel_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  IF( ALLOCATED(Re_InducedVel_Buf) )  DEALLOCATE(Re_InducedVel_Buf)
  IF( ALLOCATED(Db_InducedVel_Buf) )  DEALLOCATE(Db_InducedVel_Buf)
  IF( ALLOCATED(Int_InducedVel_Buf) ) DEALLOCATE(Int_InducedVel_Buf)
  IF ( ALLOCATED(InData%StoredForces) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StoredForces))-1 ) =  PACK(InData%StoredForces ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StoredForces)
  ENDIF
  IF ( ALLOCATED(InData%StoredMoments) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%StoredMoments))-1 ) =  PACK(InData%StoredMoments ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%StoredMoments)
  ENDIF
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, InData%ElOut, ErrStat, ErrMsg, OnlySize ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ElOut_Buf)-1 ) = Re_ElOut_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Db_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ElOut_Buf)-1 ) = Db_ElOut_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Int_ElOut_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ElOut_Buf)-1 ) = Int_ElOut_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_ElOut_Buf)
  ENDIF
  IF( ALLOCATED(Re_ElOut_Buf) )  DEALLOCATE(Re_ElOut_Buf)
  IF( ALLOCATED(Db_ElOut_Buf) )  DEALLOCATE(Db_ElOut_Buf)
  IF( ALLOCATED(Int_ElOut_Buf) ) DEALLOCATE(Int_ElOut_Buf)
 END SUBROUTINE AD_PackOtherState

 SUBROUTINE AD_UnPackOtherState( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_otherstatetype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_OtherStates_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_OtherStates_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_OtherStates_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_ElOut_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_ElOut_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_ElOut_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%DummyOtherState = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DT = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  IF ( ALLOCATED(OutData%ElPrNum) ) THEN
  ALLOCATE(mask1(SIZE(OutData%ElPrNum,1))); mask1 = .TRUE.
    OutData%ElPrNum = UNPACK(IntKiBuf( Int_Xferred:Re_Xferred+(SIZE(OutData%ElPrNum))-1 ),mask1,OutData%ElPrNum)
  DEALLOCATE(mask1)
    Int_Xferred   = Int_Xferred   + SIZE(OutData%ElPrNum)
  ENDIF
  OutData%Time = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%OldTime = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubLoss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%Loss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TipLoss = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%TLpt7 = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NERRORS = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call IfW_PackOtherState to get correctly sized buffers for unpacking
  CALL IfW_PackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, OutData%IfW_OtherStates, ErrStat, ErrMsg, .TRUE. ) ! IfW_OtherStates 
  IF(ALLOCATED(Re_IfW_OtherStates_Buf)) THEN
    Re_IfW_OtherStates_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_OtherStates_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_OtherStates_Buf)) THEN
    Db_IfW_OtherStates_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_OtherStates_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_OtherStates_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_OtherStates_Buf)) THEN
    Int_IfW_OtherStates_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_OtherStates_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_OtherStates_Buf)
  ENDIF
  CALL IfW_UnPackOtherState( Re_IfW_OtherStates_Buf, Db_IfW_OtherStates_Buf, Int_IfW_OtherStates_Buf, OutData%IfW_OtherStates, ErrStat, ErrMsg ) ! IfW_OtherStates 
 ! first call AD_Packairfoil to get correctly sized buffers for unpacking
  CALL AD_Packairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    Re_AirFoil_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    Db_AirFoil_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    Int_AirFoil_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  CALL AD_UnPackairfoil( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg ) ! AirFoil 
 ! first call AD_Packbeddoes to get correctly sized buffers for unpacking
  CALL AD_Packbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    Re_Beddoes_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    Db_Beddoes_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    Int_Beddoes_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  CALL AD_UnPackbeddoes( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg ) ! Beddoes 
 ! first call AD_Packdyninflow to get correctly sized buffers for unpacking
  CALL AD_Packdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    Re_DynInflow_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    Db_DynInflow_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    Int_DynInflow_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  CALL AD_UnPackdyninflow( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg ) ! DynInflow 
 ! first call AD_Packelement to get correctly sized buffers for unpacking
  CALL AD_Packelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    Re_Element_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    Db_Element_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    Int_Element_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  CALL AD_UnPackelement( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg ) ! Element 
 ! first call AD_Packrotor to get correctly sized buffers for unpacking
  CALL AD_Packrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    Re_Rotor_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    Db_Rotor_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    Int_Rotor_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  CALL AD_UnPackrotor( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg ) ! Rotor 
 ! first call AD_Packwind to get correctly sized buffers for unpacking
  CALL AD_Packwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    Re_Wind_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    Db_Wind_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    Int_Wind_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  CALL AD_UnPackwind( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg ) ! Wind 
 ! first call AD_Packinducedvel to get correctly sized buffers for unpacking
  CALL AD_Packinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    Re_InducedVel_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    Db_InducedVel_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    Int_InducedVel_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  CALL AD_UnPackinducedvel( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg ) ! InducedVel 
  IF ( ALLOCATED(OutData%StoredForces) ) THEN
  ALLOCATE(mask3(SIZE(OutData%StoredForces,1),SIZE(OutData%StoredForces,2),SIZE(OutData%StoredForces,3))); mask3 = .TRUE.
    OutData%StoredForces = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StoredForces))-1 ),mask3,OutData%StoredForces)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StoredForces)
  ENDIF
  IF ( ALLOCATED(OutData%StoredMoments) ) THEN
  ALLOCATE(mask3(SIZE(OutData%StoredMoments,1),SIZE(OutData%StoredMoments,2),SIZE(OutData%StoredMoments,3))); mask3 = .TRUE.
    OutData%StoredMoments = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%StoredMoments))-1 ),mask3,OutData%StoredMoments)
  DEALLOCATE(mask3)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%StoredMoments)
  ENDIF
 ! first call AD_Packeloutparms to get correctly sized buffers for unpacking
  CALL AD_Packeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, OutData%ElOut, ErrStat, ErrMsg, .TRUE. ) ! ElOut 
  IF(ALLOCATED(Re_ElOut_Buf)) THEN
    Re_ElOut_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_ElOut_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Db_ElOut_Buf)) THEN
    Db_ElOut_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_ElOut_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_ElOut_Buf)
  ENDIF
  IF(ALLOCATED(Int_ElOut_Buf)) THEN
    Int_ElOut_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_ElOut_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_ElOut_Buf)
  ENDIF
  CALL AD_UnPackeloutparms( Re_ElOut_Buf, Db_ElOut_Buf, Int_ElOut_Buf, OutData%ElOut, ErrStat, ErrMsg ) ! ElOut 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOtherState

 SUBROUTINE AD_CopyParam( SrcParamData, DstParamData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_parametertype), INTENT(INOUT) :: SrcParamData
   TYPE(AD_parametertype), INTENT(INOUT) :: DstParamData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
   DstParamData%Title = SrcParamData%Title
   DstParamData%WindFileName = SrcParamData%WindFileName
   DstParamData%SIUnit = SrcParamData%SIUnit
   DstParamData%Echo = SrcParamData%Echo
   DstParamData%MultiTab = SrcParamData%MultiTab
   DstParamData%LinearizeFlag = SrcParamData%LinearizeFlag
   DstParamData%OutputPlottingInfo = SrcParamData%OutputPlottingInfo
   DstParamData%Initialized = SrcParamData%Initialized
   DstParamData%TwoPiNB = SrcParamData%TwoPiNB
   DstParamData%NumBl = SrcParamData%NumBl
   DstParamData%NBlInpSt = SrcParamData%NBlInpSt
   DstParamData%ElemPrn = SrcParamData%ElemPrn
   DstParamData%DStall = SrcParamData%DStall
   DstParamData%PMoment = SrcParamData%PMoment
   DstParamData%Reynolds = SrcParamData%Reynolds
   DstParamData%DynInfl = SrcParamData%DynInfl
   DstParamData%Wake = SrcParamData%Wake
   DstParamData%Swirl = SrcParamData%Swirl
   DstParamData%DtAero = SrcParamData%DtAero
   DstParamData%HubRad = SrcParamData%HubRad
   DstParamData%UnEc = SrcParamData%UnEc
   DstParamData%UnElem = SrcParamData%UnElem
   DstParamData%UnADPlt = SrcParamData%UnADPlt
   DstParamData%UnADin = SrcParamData%UnADin
   DstParamData%UnWind = SrcParamData%UnWind
   DstParamData%UnADopt = SrcParamData%UnADopt
   DstParamData%UnAirfl = SrcParamData%UnAirfl
   DstParamData%UnWndOut = SrcParamData%UnWndOut
   DstParamData%MAXICOUNT = SrcParamData%MAXICOUNT
   DstParamData%WrOptFile = SrcParamData%WrOptFile
   DstParamData%DEFAULT_Wind = SrcParamData%DEFAULT_Wind
      CALL AD_Copyairfoilparms( SrcParamData%AirFoil, DstParamData%AirFoil, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copybladeparms( SrcParamData%Blade, DstParamData%Blade, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copybeddoesparms( SrcParamData%Beddoes, DstParamData%Beddoes, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copydyninflowparms( SrcParamData%DynInflow, DstParamData%DynInflow, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyelementparms( SrcParamData%Element, DstParamData%Element, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copytwrpropsparms( SrcParamData%TwrProps, DstParamData%TwrProps, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyinducedvelparms( SrcParamData%InducedVel, DstParamData%InducedVel, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copywindparms( SrcParamData%Wind, DstParamData%Wind, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyrotorparms( SrcParamData%Rotor, DstParamData%Rotor, CtrlCode, ErrStat, ErrMsg )
      CALL IfW_CopyParam( SrcParamData%IfW_Params, DstParamData%IfW_Params, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyParam

 SUBROUTINE AD_DestroyParam( ParamData, ErrStat, ErrMsg )
  TYPE(AD_parametertype), INTENT(INOUT) :: ParamData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
  CALL AD_Destroyairfoilparms( ParamData%AirFoil, ErrStat, ErrMsg )
  CALL AD_Destroybladeparms( ParamData%Blade, ErrStat, ErrMsg )
  CALL AD_Destroybeddoesparms( ParamData%Beddoes, ErrStat, ErrMsg )
  CALL AD_Destroydyninflowparms( ParamData%DynInflow, ErrStat, ErrMsg )
  CALL AD_Destroyelementparms( ParamData%Element, ErrStat, ErrMsg )
  CALL AD_Destroytwrpropsparms( ParamData%TwrProps, ErrStat, ErrMsg )
  CALL AD_Destroyinducedvelparms( ParamData%InducedVel, ErrStat, ErrMsg )
  CALL AD_Destroywindparms( ParamData%Wind, ErrStat, ErrMsg )
  CALL AD_Destroyrotorparms( ParamData%Rotor, ErrStat, ErrMsg )
  CALL IfW_DestroyParam( ParamData%IfW_Params, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyParam

 SUBROUTINE AD_PackParam( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_parametertype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TwrProps_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TwrProps_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TwrProps_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Params_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Params_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Params_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  Re_BufSz   = Re_BufSz   + 1  ! TwoPiNB
  Int_BufSz  = Int_BufSz  + 1  ! NumBl
  Int_BufSz  = Int_BufSz  + 1  ! NBlInpSt
  Db_BufSz   = Db_BufSz   + 1  ! DtAero
  Re_BufSz   = Re_BufSz   + 1  ! HubRad
  Int_BufSz  = Int_BufSz  + 1  ! UnEc
  Int_BufSz  = Int_BufSz  + 1  ! UnElem
  Int_BufSz  = Int_BufSz  + 1  ! UnADPlt
  Int_BufSz  = Int_BufSz  + 1  ! UnADin
  Int_BufSz  = Int_BufSz  + 1  ! UnWind
  Int_BufSz  = Int_BufSz  + 1  ! UnADopt
  Int_BufSz  = Int_BufSz  + 1  ! UnAirfl
  Int_BufSz  = Int_BufSz  + 1  ! UnWndOut
  Int_BufSz  = Int_BufSz  + 1  ! MAXICOUNT
  Int_BufSz  = Int_BufSz  + 1  ! DEFAULT_Wind
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Db_AirFoil_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_AirFoil_Buf  ) ! AirFoil
  IF(ALLOCATED(Int_AirFoil_Buf))Int_BufSz = Int_BufSz + SIZE( Int_AirFoil_Buf ) ! AirFoil
  IF(ALLOCATED(Re_AirFoil_Buf))  DEALLOCATE(Re_AirFoil_Buf)
  IF(ALLOCATED(Db_AirFoil_Buf))  DEALLOCATE(Db_AirFoil_Buf)
  IF(ALLOCATED(Int_AirFoil_Buf)) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade, ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Db_Blade_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Blade_Buf  ) ! Blade
  IF(ALLOCATED(Int_Blade_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Blade_Buf ) ! Blade
  IF(ALLOCATED(Re_Blade_Buf))  DEALLOCATE(Re_Blade_Buf)
  IF(ALLOCATED(Db_Blade_Buf))  DEALLOCATE(Db_Blade_Buf)
  IF(ALLOCATED(Int_Blade_Buf)) DEALLOCATE(Int_Blade_Buf)
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Db_Beddoes_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Beddoes_Buf  ) ! Beddoes
  IF(ALLOCATED(Int_Beddoes_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Beddoes_Buf ) ! Beddoes
  IF(ALLOCATED(Re_Beddoes_Buf))  DEALLOCATE(Re_Beddoes_Buf)
  IF(ALLOCATED(Db_Beddoes_Buf))  DEALLOCATE(Db_Beddoes_Buf)
  IF(ALLOCATED(Int_Beddoes_Buf)) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Db_DynInflow_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_DynInflow_Buf  ) ! DynInflow
  IF(ALLOCATED(Int_DynInflow_Buf))Int_BufSz = Int_BufSz + SIZE( Int_DynInflow_Buf ) ! DynInflow
  IF(ALLOCATED(Re_DynInflow_Buf))  DEALLOCATE(Re_DynInflow_Buf)
  IF(ALLOCATED(Db_DynInflow_Buf))  DEALLOCATE(Db_DynInflow_Buf)
  IF(ALLOCATED(Int_DynInflow_Buf)) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Element_Buf  ) ! Element
  IF(ALLOCATED(Db_Element_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Element_Buf  ) ! Element
  IF(ALLOCATED(Int_Element_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Element_Buf ) ! Element
  IF(ALLOCATED(Re_Element_Buf))  DEALLOCATE(Re_Element_Buf)
  IF(ALLOCATED(Db_Element_Buf))  DEALLOCATE(Db_Element_Buf)
  IF(ALLOCATED(Int_Element_Buf)) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, InData%TwrProps, ErrStat, ErrMsg, .TRUE. ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TwrProps_Buf  ) ! TwrProps
  IF(ALLOCATED(Db_TwrProps_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TwrProps_Buf  ) ! TwrProps
  IF(ALLOCATED(Int_TwrProps_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TwrProps_Buf ) ! TwrProps
  IF(ALLOCATED(Re_TwrProps_Buf))  DEALLOCATE(Re_TwrProps_Buf)
  IF(ALLOCATED(Db_TwrProps_Buf))  DEALLOCATE(Db_TwrProps_Buf)
  IF(ALLOCATED(Int_TwrProps_Buf)) DEALLOCATE(Int_TwrProps_Buf)
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Db_InducedVel_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InducedVel_Buf  ) ! InducedVel
  IF(ALLOCATED(Int_InducedVel_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InducedVel_Buf ) ! InducedVel
  IF(ALLOCATED(Re_InducedVel_Buf))  DEALLOCATE(Re_InducedVel_Buf)
  IF(ALLOCATED(Db_InducedVel_Buf))  DEALLOCATE(Db_InducedVel_Buf)
  IF(ALLOCATED(Int_InducedVel_Buf)) DEALLOCATE(Int_InducedVel_Buf)
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Db_Wind_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Wind_Buf  ) ! Wind
  IF(ALLOCATED(Int_Wind_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Wind_Buf ) ! Wind
  IF(ALLOCATED(Re_Wind_Buf))  DEALLOCATE(Re_Wind_Buf)
  IF(ALLOCATED(Db_Wind_Buf))  DEALLOCATE(Db_Wind_Buf)
  IF(ALLOCATED(Int_Wind_Buf)) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Db_Rotor_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Rotor_Buf  ) ! Rotor
  IF(ALLOCATED(Int_Rotor_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Rotor_Buf ) ! Rotor
  IF(ALLOCATED(Re_Rotor_Buf))  DEALLOCATE(Re_Rotor_Buf)
  IF(ALLOCATED(Db_Rotor_Buf))  DEALLOCATE(Db_Rotor_Buf)
  IF(ALLOCATED(Int_Rotor_Buf)) DEALLOCATE(Int_Rotor_Buf)
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, InData%IfW_Params, ErrStat, ErrMsg, .TRUE. ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Params_Buf  ) ! IfW_Params
  IF(ALLOCATED(Db_IfW_Params_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Params_Buf  ) ! IfW_Params
  IF(ALLOCATED(Int_IfW_Params_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Params_Buf ) ! IfW_Params
  IF(ALLOCATED(Re_IfW_Params_Buf))  DEALLOCATE(Re_IfW_Params_Buf)
  IF(ALLOCATED(Db_IfW_Params_Buf))  DEALLOCATE(Db_IfW_Params_Buf)
  IF(ALLOCATED(Int_IfW_Params_Buf)) DEALLOCATE(Int_IfW_Params_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%TwoPiNB )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NumBl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%NBlInpSt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) DbKiBuf ( Db_Xferred:Db_Xferred+(1)-1 ) =  (InData%DtAero )
  Db_Xferred   = Db_Xferred   + 1
  IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(1)-1 ) =  (InData%HubRad )
  Re_Xferred   = Re_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnEc )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnElem )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnADPlt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnADin )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnWind )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnADopt )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnAirfl )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%UnWndOut )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%MAXICOUNT )
  Int_Xferred   = Int_Xferred   + 1
  IF ( .NOT. OnlySize ) IntKiBuf ( Int_Xferred:Int_Xferred+(1)-1 ) = (InData%DEFAULT_Wind )
  Int_Xferred   = Int_Xferred   + 1
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, InData%AirFoil, ErrStat, ErrMsg, OnlySize ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 ) = Re_AirFoil_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 ) = Db_AirFoil_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 ) = Int_AirFoil_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  IF( ALLOCATED(Re_AirFoil_Buf) )  DEALLOCATE(Re_AirFoil_Buf)
  IF( ALLOCATED(Db_AirFoil_Buf) )  DEALLOCATE(Db_AirFoil_Buf)
  IF( ALLOCATED(Int_AirFoil_Buf) ) DEALLOCATE(Int_AirFoil_Buf)
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, InData%Blade, ErrStat, ErrMsg, OnlySize ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 ) = Re_Blade_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 ) = Db_Blade_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 ) = Int_Blade_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  IF( ALLOCATED(Re_Blade_Buf) )  DEALLOCATE(Re_Blade_Buf)
  IF( ALLOCATED(Db_Blade_Buf) )  DEALLOCATE(Db_Blade_Buf)
  IF( ALLOCATED(Int_Blade_Buf) ) DEALLOCATE(Int_Blade_Buf)
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, InData%Beddoes, ErrStat, ErrMsg, OnlySize ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 ) = Re_Beddoes_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 ) = Db_Beddoes_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 ) = Int_Beddoes_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  IF( ALLOCATED(Re_Beddoes_Buf) )  DEALLOCATE(Re_Beddoes_Buf)
  IF( ALLOCATED(Db_Beddoes_Buf) )  DEALLOCATE(Db_Beddoes_Buf)
  IF( ALLOCATED(Int_Beddoes_Buf) ) DEALLOCATE(Int_Beddoes_Buf)
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, InData%DynInflow, ErrStat, ErrMsg, OnlySize ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 ) = Re_DynInflow_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 ) = Db_DynInflow_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 ) = Int_DynInflow_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  IF( ALLOCATED(Re_DynInflow_Buf) )  DEALLOCATE(Re_DynInflow_Buf)
  IF( ALLOCATED(Db_DynInflow_Buf) )  DEALLOCATE(Db_DynInflow_Buf)
  IF( ALLOCATED(Int_DynInflow_Buf) ) DEALLOCATE(Int_DynInflow_Buf)
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, InData%Element, ErrStat, ErrMsg, OnlySize ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 ) = Re_Element_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 ) = Db_Element_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 ) = Int_Element_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  IF( ALLOCATED(Re_Element_Buf) )  DEALLOCATE(Re_Element_Buf)
  IF( ALLOCATED(Db_Element_Buf) )  DEALLOCATE(Db_Element_Buf)
  IF( ALLOCATED(Int_Element_Buf) ) DEALLOCATE(Int_Element_Buf)
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, InData%TwrProps, ErrStat, ErrMsg, OnlySize ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TwrProps_Buf)-1 ) = Re_TwrProps_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Db_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TwrProps_Buf)-1 ) = Db_TwrProps_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Int_TwrProps_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TwrProps_Buf)-1 ) = Int_TwrProps_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TwrProps_Buf)
  ENDIF
  IF( ALLOCATED(Re_TwrProps_Buf) )  DEALLOCATE(Re_TwrProps_Buf)
  IF( ALLOCATED(Db_TwrProps_Buf) )  DEALLOCATE(Db_TwrProps_Buf)
  IF( ALLOCATED(Int_TwrProps_Buf) ) DEALLOCATE(Int_TwrProps_Buf)
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, InData%InducedVel, ErrStat, ErrMsg, OnlySize ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 ) = Re_InducedVel_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 ) = Db_InducedVel_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 ) = Int_InducedVel_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  IF( ALLOCATED(Re_InducedVel_Buf) )  DEALLOCATE(Re_InducedVel_Buf)
  IF( ALLOCATED(Db_InducedVel_Buf) )  DEALLOCATE(Db_InducedVel_Buf)
  IF( ALLOCATED(Int_InducedVel_Buf) ) DEALLOCATE(Int_InducedVel_Buf)
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, InData%Wind, ErrStat, ErrMsg, OnlySize ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 ) = Re_Wind_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 ) = Db_Wind_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 ) = Int_Wind_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  IF( ALLOCATED(Re_Wind_Buf) )  DEALLOCATE(Re_Wind_Buf)
  IF( ALLOCATED(Db_Wind_Buf) )  DEALLOCATE(Db_Wind_Buf)
  IF( ALLOCATED(Int_Wind_Buf) ) DEALLOCATE(Int_Wind_Buf)
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, InData%Rotor, ErrStat, ErrMsg, OnlySize ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 ) = Re_Rotor_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 ) = Db_Rotor_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 ) = Int_Rotor_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  IF( ALLOCATED(Re_Rotor_Buf) )  DEALLOCATE(Re_Rotor_Buf)
  IF( ALLOCATED(Db_Rotor_Buf) )  DEALLOCATE(Db_Rotor_Buf)
  IF( ALLOCATED(Int_Rotor_Buf) ) DEALLOCATE(Int_Rotor_Buf)
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, InData%IfW_Params, ErrStat, ErrMsg, OnlySize ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Params_Buf)-1 ) = Re_IfW_Params_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Params_Buf)-1 ) = Db_IfW_Params_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Params_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Params_Buf)-1 ) = Int_IfW_Params_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Params_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Params_Buf) )  DEALLOCATE(Re_IfW_Params_Buf)
  IF( ALLOCATED(Db_IfW_Params_Buf) )  DEALLOCATE(Db_IfW_Params_Buf)
  IF( ALLOCATED(Int_IfW_Params_Buf) ) DEALLOCATE(Int_IfW_Params_Buf)
 END SUBROUTINE AD_PackParam

 SUBROUTINE AD_UnPackParam( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_parametertype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_AirFoil_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_AirFoil_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_AirFoil_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Blade_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Blade_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Blade_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Beddoes_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Beddoes_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Beddoes_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_DynInflow_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_DynInflow_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_DynInflow_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Element_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Element_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Element_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TwrProps_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TwrProps_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TwrProps_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_InducedVel_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InducedVel_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InducedVel_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Wind_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Wind_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Wind_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Rotor_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Rotor_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Rotor_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Params_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Params_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Params_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
  OutData%TwoPiNB = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%NumBl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%NBlInpSt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DtAero = DbKiBuf ( Db_Xferred )
  Db_Xferred   = Db_Xferred   + 1
  OutData%HubRad = ReKiBuf ( Re_Xferred )
  Re_Xferred   = Re_Xferred   + 1
  OutData%UnEc = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnElem = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnADPlt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnADin = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnWind = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnADopt = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnAirfl = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%UnWndOut = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%MAXICOUNT = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
  OutData%DEFAULT_Wind = IntKiBuf ( Int_Xferred )
  Int_Xferred   = Int_Xferred   + 1
 ! first call AD_Packairfoilparms to get correctly sized buffers for unpacking
  CALL AD_Packairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg, .TRUE. ) ! AirFoil 
  IF(ALLOCATED(Re_AirFoil_Buf)) THEN
    Re_AirFoil_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_AirFoil_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Db_AirFoil_Buf)) THEN
    Db_AirFoil_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_AirFoil_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_AirFoil_Buf)
  ENDIF
  IF(ALLOCATED(Int_AirFoil_Buf)) THEN
    Int_AirFoil_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_AirFoil_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_AirFoil_Buf)
  ENDIF
  CALL AD_UnPackairfoilparms( Re_AirFoil_Buf, Db_AirFoil_Buf, Int_AirFoil_Buf, OutData%AirFoil, ErrStat, ErrMsg ) ! AirFoil 
 ! first call AD_Packbladeparms to get correctly sized buffers for unpacking
  CALL AD_Packbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade, ErrStat, ErrMsg, .TRUE. ) ! Blade 
  IF(ALLOCATED(Re_Blade_Buf)) THEN
    Re_Blade_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Blade_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Db_Blade_Buf)) THEN
    Db_Blade_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Blade_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Blade_Buf)
  ENDIF
  IF(ALLOCATED(Int_Blade_Buf)) THEN
    Int_Blade_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Blade_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Blade_Buf)
  ENDIF
  CALL AD_UnPackbladeparms( Re_Blade_Buf, Db_Blade_Buf, Int_Blade_Buf, OutData%Blade, ErrStat, ErrMsg ) ! Blade 
 ! first call AD_Packbeddoesparms to get correctly sized buffers for unpacking
  CALL AD_Packbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg, .TRUE. ) ! Beddoes 
  IF(ALLOCATED(Re_Beddoes_Buf)) THEN
    Re_Beddoes_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Beddoes_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Db_Beddoes_Buf)) THEN
    Db_Beddoes_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Beddoes_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Beddoes_Buf)
  ENDIF
  IF(ALLOCATED(Int_Beddoes_Buf)) THEN
    Int_Beddoes_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Beddoes_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Beddoes_Buf)
  ENDIF
  CALL AD_UnPackbeddoesparms( Re_Beddoes_Buf, Db_Beddoes_Buf, Int_Beddoes_Buf, OutData%Beddoes, ErrStat, ErrMsg ) ! Beddoes 
 ! first call AD_Packdyninflowparms to get correctly sized buffers for unpacking
  CALL AD_Packdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg, .TRUE. ) ! DynInflow 
  IF(ALLOCATED(Re_DynInflow_Buf)) THEN
    Re_DynInflow_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_DynInflow_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Db_DynInflow_Buf)) THEN
    Db_DynInflow_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_DynInflow_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_DynInflow_Buf)
  ENDIF
  IF(ALLOCATED(Int_DynInflow_Buf)) THEN
    Int_DynInflow_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_DynInflow_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_DynInflow_Buf)
  ENDIF
  CALL AD_UnPackdyninflowparms( Re_DynInflow_Buf, Db_DynInflow_Buf, Int_DynInflow_Buf, OutData%DynInflow, ErrStat, ErrMsg ) ! DynInflow 
 ! first call AD_Packelementparms to get correctly sized buffers for unpacking
  CALL AD_Packelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg, .TRUE. ) ! Element 
  IF(ALLOCATED(Re_Element_Buf)) THEN
    Re_Element_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Element_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Element_Buf)
  ENDIF
  IF(ALLOCATED(Db_Element_Buf)) THEN
    Db_Element_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Element_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Element_Buf)
  ENDIF
  IF(ALLOCATED(Int_Element_Buf)) THEN
    Int_Element_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Element_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Element_Buf)
  ENDIF
  CALL AD_UnPackelementparms( Re_Element_Buf, Db_Element_Buf, Int_Element_Buf, OutData%Element, ErrStat, ErrMsg ) ! Element 
 ! first call AD_Packtwrpropsparms to get correctly sized buffers for unpacking
  CALL AD_Packtwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, OutData%TwrProps, ErrStat, ErrMsg, .TRUE. ) ! TwrProps 
  IF(ALLOCATED(Re_TwrProps_Buf)) THEN
    Re_TwrProps_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TwrProps_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Db_TwrProps_Buf)) THEN
    Db_TwrProps_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TwrProps_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TwrProps_Buf)
  ENDIF
  IF(ALLOCATED(Int_TwrProps_Buf)) THEN
    Int_TwrProps_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TwrProps_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TwrProps_Buf)
  ENDIF
  CALL AD_UnPacktwrpropsparms( Re_TwrProps_Buf, Db_TwrProps_Buf, Int_TwrProps_Buf, OutData%TwrProps, ErrStat, ErrMsg ) ! TwrProps 
 ! first call AD_Packinducedvelparms to get correctly sized buffers for unpacking
  CALL AD_Packinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg, .TRUE. ) ! InducedVel 
  IF(ALLOCATED(Re_InducedVel_Buf)) THEN
    Re_InducedVel_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InducedVel_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Db_InducedVel_Buf)) THEN
    Db_InducedVel_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InducedVel_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InducedVel_Buf)
  ENDIF
  IF(ALLOCATED(Int_InducedVel_Buf)) THEN
    Int_InducedVel_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InducedVel_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InducedVel_Buf)
  ENDIF
  CALL AD_UnPackinducedvelparms( Re_InducedVel_Buf, Db_InducedVel_Buf, Int_InducedVel_Buf, OutData%InducedVel, ErrStat, ErrMsg ) ! InducedVel 
 ! first call AD_Packwindparms to get correctly sized buffers for unpacking
  CALL AD_Packwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg, .TRUE. ) ! Wind 
  IF(ALLOCATED(Re_Wind_Buf)) THEN
    Re_Wind_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Wind_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Db_Wind_Buf)) THEN
    Db_Wind_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Wind_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Wind_Buf)
  ENDIF
  IF(ALLOCATED(Int_Wind_Buf)) THEN
    Int_Wind_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Wind_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Wind_Buf)
  ENDIF
  CALL AD_UnPackwindparms( Re_Wind_Buf, Db_Wind_Buf, Int_Wind_Buf, OutData%Wind, ErrStat, ErrMsg ) ! Wind 
 ! first call AD_Packrotorparms to get correctly sized buffers for unpacking
  CALL AD_Packrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg, .TRUE. ) ! Rotor 
  IF(ALLOCATED(Re_Rotor_Buf)) THEN
    Re_Rotor_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Rotor_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Db_Rotor_Buf)) THEN
    Db_Rotor_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Rotor_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Rotor_Buf)
  ENDIF
  IF(ALLOCATED(Int_Rotor_Buf)) THEN
    Int_Rotor_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Rotor_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Rotor_Buf)
  ENDIF
  CALL AD_UnPackrotorparms( Re_Rotor_Buf, Db_Rotor_Buf, Int_Rotor_Buf, OutData%Rotor, ErrStat, ErrMsg ) ! Rotor 
 ! first call IfW_PackParam to get correctly sized buffers for unpacking
  CALL IfW_PackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, OutData%IfW_Params, ErrStat, ErrMsg, .TRUE. ) ! IfW_Params 
  IF(ALLOCATED(Re_IfW_Params_Buf)) THEN
    Re_IfW_Params_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Params_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Params_Buf)) THEN
    Db_IfW_Params_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Params_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Params_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Params_Buf)) THEN
    Int_IfW_Params_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Params_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Params_Buf)
  ENDIF
  CALL IfW_UnPackParam( Re_IfW_Params_Buf, Db_IfW_Params_Buf, Int_IfW_Params_Buf, OutData%IfW_Params, ErrStat, ErrMsg ) ! IfW_Params 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackParam

 SUBROUTINE AD_CopyInput( SrcInputData, DstInputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_inputtype), INTENT(INOUT) :: SrcInputData
   TYPE(AD_inputtype), INTENT(INOUT) :: DstInputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcInputData%InputMarkers)) THEN
   i1_l = LBOUND(SrcInputData%InputMarkers,1)
   i1_u = UBOUND(SrcInputData%InputMarkers,1)
   IF (.NOT.ALLOCATED(DstInputData%InputMarkers)) THEN 
      ALLOCATE(DstInputData%InputMarkers(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyInput: Error allocating DstInputData%InputMarkers.'
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcInputData%InputMarkers,1), UBOUND(SrcInputData%InputMarkers,1)
     CALL MeshCopy( SrcInputData%InputMarkers(i1), DstInputData%InputMarkers(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
ENDIF
     CALL MeshCopy( SrcInputData%Twr_InputMarkers, DstInputData%Twr_InputMarkers, CtrlCode, ErrStat, ErrMsg )
      CALL AD_Copyaeroconfig( SrcInputData%TurbineComponents, DstInputData%TurbineComponents, CtrlCode, ErrStat, ErrMsg )
      CALL IfW_CopyInput( SrcInputData%IfW_Inputs, DstInputData%IfW_Inputs, CtrlCode, ErrStat, ErrMsg )
IF (ALLOCATED(SrcInputData%MulTabLoc)) THEN
   i1_l = LBOUND(SrcInputData%MulTabLoc,1)
   i1_u = UBOUND(SrcInputData%MulTabLoc,1)
   i2_l = LBOUND(SrcInputData%MulTabLoc,2)
   i2_u = UBOUND(SrcInputData%MulTabLoc,2)
   IF (.NOT.ALLOCATED(DstInputData%MulTabLoc)) THEN 
      ALLOCATE(DstInputData%MulTabLoc(i1_l:i1_u,i2_l:i2_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyInput: Error allocating DstInputData%MulTabLoc.'
         RETURN
      END IF
   END IF
   DstInputData%MulTabLoc = SrcInputData%MulTabLoc
ENDIF
 END SUBROUTINE AD_CopyInput

 SUBROUTINE AD_DestroyInput( InputData, ErrStat, ErrMsg )
  TYPE(AD_inputtype), INTENT(INOUT) :: InputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(InputData%InputMarkers)) THEN
DO i1 = LBOUND(InputData%InputMarkers,1), UBOUND(InputData%InputMarkers,1)
  CALL MeshDestroy( InputData%InputMarkers(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(InputData%InputMarkers)
ENDIF
  CALL MeshDestroy( InputData%Twr_InputMarkers, ErrStat, ErrMsg )
  CALL AD_Destroyaeroconfig( InputData%TurbineComponents, ErrStat, ErrMsg )
  CALL IfW_DestroyInput( InputData%IfW_Inputs, ErrStat, ErrMsg )
IF (ALLOCATED(InputData%MulTabLoc)) THEN
   DEALLOCATE(InputData%MulTabLoc)
ENDIF
 END SUBROUTINE AD_DestroyInput

 SUBROUTINE AD_PackInput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_inputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_InputMarkers_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_InputMarkers_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_InputMarkers_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_InputMarkers_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_InputMarkers_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_InputMarkers_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Inputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Inputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Inputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%InputMarkers,1), UBOUND(InData%InputMarkers,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg, .TRUE. ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_InputMarkers_Buf  ) ! InputMarkers
  IF(ALLOCATED(Db_InputMarkers_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_InputMarkers_Buf  ) ! InputMarkers
  IF(ALLOCATED(Int_InputMarkers_Buf))Int_BufSz = Int_BufSz + SIZE( Int_InputMarkers_Buf ) ! InputMarkers
  IF(ALLOCATED(Re_InputMarkers_Buf))  DEALLOCATE(Re_InputMarkers_Buf)
  IF(ALLOCATED(Db_InputMarkers_Buf))  DEALLOCATE(Db_InputMarkers_Buf)
  IF(ALLOCATED(Int_InputMarkers_Buf)) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( InData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg, .TRUE. ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_InputMarkers_Buf  ) ! Twr_InputMarkers
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_InputMarkers_Buf  ) ! Twr_InputMarkers
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_InputMarkers_Buf ) ! Twr_InputMarkers
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf))  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf))  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) DEALLOCATE(Int_Twr_InputMarkers_Buf)
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Db_TurbineComponents_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_TurbineComponents_Buf  ) ! TurbineComponents
  IF(ALLOCATED(Int_TurbineComponents_Buf))Int_BufSz = Int_BufSz + SIZE( Int_TurbineComponents_Buf ) ! TurbineComponents
  IF(ALLOCATED(Re_TurbineComponents_Buf))  DEALLOCATE(Re_TurbineComponents_Buf)
  IF(ALLOCATED(Db_TurbineComponents_Buf))  DEALLOCATE(Db_TurbineComponents_Buf)
  IF(ALLOCATED(Int_TurbineComponents_Buf)) DEALLOCATE(Int_TurbineComponents_Buf)
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, InData%IfW_Inputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Inputs_Buf  ) ! IfW_Inputs
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Inputs_Buf  ) ! IfW_Inputs
  IF(ALLOCATED(Int_IfW_Inputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Inputs_Buf ) ! IfW_Inputs
  IF(ALLOCATED(Re_IfW_Inputs_Buf))  DEALLOCATE(Re_IfW_Inputs_Buf)
  IF(ALLOCATED(Db_IfW_Inputs_Buf))  DEALLOCATE(Db_IfW_Inputs_Buf)
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) DEALLOCATE(Int_IfW_Inputs_Buf)
  Re_BufSz    = Re_BufSz    + SIZE( InData%MulTabLoc )  ! MulTabLoc 
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%InputMarkers,1), UBOUND(InData%InputMarkers,1)
  CALL MeshPack( InData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg, OnlySize ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InputMarkers_Buf)-1 ) = Re_InputMarkers_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InputMarkers_Buf)-1 ) = Db_InputMarkers_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InputMarkers_Buf)-1 ) = Int_InputMarkers_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_InputMarkers_Buf)
  ENDIF
  IF( ALLOCATED(Re_InputMarkers_Buf) )  DEALLOCATE(Re_InputMarkers_Buf)
  IF( ALLOCATED(Db_InputMarkers_Buf) )  DEALLOCATE(Db_InputMarkers_Buf)
  IF( ALLOCATED(Int_InputMarkers_Buf) ) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( InData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg, OnlySize ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_InputMarkers_Buf)-1 ) = Re_Twr_InputMarkers_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_InputMarkers_Buf)-1 ) = Db_Twr_InputMarkers_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_InputMarkers_Buf)-1 ) = Int_Twr_InputMarkers_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_InputMarkers_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_InputMarkers_Buf) )  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Db_Twr_InputMarkers_Buf) )  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Int_Twr_InputMarkers_Buf) ) DEALLOCATE(Int_Twr_InputMarkers_Buf)
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, InData%TurbineComponents, ErrStat, ErrMsg, OnlySize ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 ) = Re_TurbineComponents_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 ) = Db_TurbineComponents_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 ) = Int_TurbineComponents_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  IF( ALLOCATED(Re_TurbineComponents_Buf) )  DEALLOCATE(Re_TurbineComponents_Buf)
  IF( ALLOCATED(Db_TurbineComponents_Buf) )  DEALLOCATE(Db_TurbineComponents_Buf)
  IF( ALLOCATED(Int_TurbineComponents_Buf) ) DEALLOCATE(Int_TurbineComponents_Buf)
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, InData%IfW_Inputs, ErrStat, ErrMsg, OnlySize ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Inputs_Buf)-1 ) = Re_IfW_Inputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Inputs_Buf)-1 ) = Db_IfW_Inputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Inputs_Buf)-1 ) = Int_IfW_Inputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Inputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Inputs_Buf) )  DEALLOCATE(Re_IfW_Inputs_Buf)
  IF( ALLOCATED(Db_IfW_Inputs_Buf) )  DEALLOCATE(Db_IfW_Inputs_Buf)
  IF( ALLOCATED(Int_IfW_Inputs_Buf) ) DEALLOCATE(Int_IfW_Inputs_Buf)
  IF ( ALLOCATED(InData%MulTabLoc) ) THEN
    IF ( .NOT. OnlySize ) ReKiBuf ( Re_Xferred:Re_Xferred+(SIZE(InData%MulTabLoc))-1 ) =  PACK(InData%MulTabLoc ,.TRUE.)
    Re_Xferred   = Re_Xferred   + SIZE(InData%MulTabLoc)
  ENDIF
 END SUBROUTINE AD_PackInput

 SUBROUTINE AD_UnPackInput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_inputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_InputMarkers_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_InputMarkers_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_InputMarkers_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_InputMarkers_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_InputMarkers_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_InputMarkers_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_TurbineComponents_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_TurbineComponents_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_TurbineComponents_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Inputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Inputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Inputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%InputMarkers,1), UBOUND(OutData%InputMarkers,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg , .TRUE. ) ! InputMarkers 
  IF(ALLOCATED(Re_InputMarkers_Buf)) THEN
    Re_InputMarkers_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_InputMarkers_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_InputMarkers_Buf)) THEN
    Db_InputMarkers_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_InputMarkers_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_InputMarkers_Buf)) THEN
    Int_InputMarkers_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_InputMarkers_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_InputMarkers_Buf)
  ENDIF
  CALL MeshUnPack( OutData%InputMarkers(i1), Re_InputMarkers_Buf, Db_InputMarkers_Buf, Int_InputMarkers_Buf, ErrStat, ErrMsg ) ! InputMarkers 
  IF( ALLOCATED(Re_InputMarkers_Buf) )  DEALLOCATE(Re_InputMarkers_Buf)
  IF( ALLOCATED(Db_InputMarkers_Buf) )  DEALLOCATE(Db_InputMarkers_Buf)
  IF( ALLOCATED(Int_InputMarkers_Buf) ) DEALLOCATE(Int_InputMarkers_Buf)
ENDDO
  CALL MeshPack( OutData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg , .TRUE. ) ! Twr_InputMarkers 
  IF(ALLOCATED(Re_Twr_InputMarkers_Buf)) THEN
    Re_Twr_InputMarkers_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_InputMarkers_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_InputMarkers_Buf)) THEN
    Db_Twr_InputMarkers_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_InputMarkers_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_InputMarkers_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_InputMarkers_Buf)) THEN
    Int_Twr_InputMarkers_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_InputMarkers_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_InputMarkers_Buf)
  ENDIF
  CALL MeshUnPack( OutData%Twr_InputMarkers, Re_Twr_InputMarkers_Buf, Db_Twr_InputMarkers_Buf, Int_Twr_InputMarkers_Buf, ErrStat, ErrMsg ) ! Twr_InputMarkers 
  IF( ALLOCATED(Re_Twr_InputMarkers_Buf) )  DEALLOCATE(Re_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Db_Twr_InputMarkers_Buf) )  DEALLOCATE(Db_Twr_InputMarkers_Buf)
  IF( ALLOCATED(Int_Twr_InputMarkers_Buf) ) DEALLOCATE(Int_Twr_InputMarkers_Buf)
 ! first call AD_Packaeroconfig to get correctly sized buffers for unpacking
  CALL AD_Packaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg, .TRUE. ) ! TurbineComponents 
  IF(ALLOCATED(Re_TurbineComponents_Buf)) THEN
    Re_TurbineComponents_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_TurbineComponents_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Db_TurbineComponents_Buf)) THEN
    Db_TurbineComponents_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_TurbineComponents_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_TurbineComponents_Buf)
  ENDIF
  IF(ALLOCATED(Int_TurbineComponents_Buf)) THEN
    Int_TurbineComponents_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_TurbineComponents_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_TurbineComponents_Buf)
  ENDIF
  CALL AD_UnPackaeroconfig( Re_TurbineComponents_Buf, Db_TurbineComponents_Buf, Int_TurbineComponents_Buf, OutData%TurbineComponents, ErrStat, ErrMsg ) ! TurbineComponents 
 ! first call IfW_PackInput to get correctly sized buffers for unpacking
  CALL IfW_PackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, OutData%IfW_Inputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Inputs 
  IF(ALLOCATED(Re_IfW_Inputs_Buf)) THEN
    Re_IfW_Inputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Inputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Inputs_Buf)) THEN
    Db_IfW_Inputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Inputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Inputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Inputs_Buf)) THEN
    Int_IfW_Inputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Inputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Inputs_Buf)
  ENDIF
  CALL IfW_UnPackInput( Re_IfW_Inputs_Buf, Db_IfW_Inputs_Buf, Int_IfW_Inputs_Buf, OutData%IfW_Inputs, ErrStat, ErrMsg ) ! IfW_Inputs 
  IF ( ALLOCATED(OutData%MulTabLoc) ) THEN
  ALLOCATE(mask2(SIZE(OutData%MulTabLoc,1),SIZE(OutData%MulTabLoc,2))); mask2 = .TRUE.
    OutData%MulTabLoc = UNPACK(ReKiBuf( Re_Xferred:Re_Xferred+(SIZE(OutData%MulTabLoc))-1 ),mask2,OutData%MulTabLoc)
  DEALLOCATE(mask2)
    Re_Xferred   = Re_Xferred   + SIZE(OutData%MulTabLoc)
  ENDIF
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackInput

 SUBROUTINE AD_CopyOutput( SrcOutputData, DstOutputData, CtrlCode, ErrStat, ErrMsg )
   TYPE(AD_outputtype), INTENT(INOUT) :: SrcOutputData
   TYPE(AD_outputtype), INTENT(INOUT) :: DstOutputData
   INTEGER(IntKi),  INTENT(IN   ) :: CtrlCode
   INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
   CHARACTER(*),    INTENT(  OUT) :: ErrMsg
! Local 
   INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5,j,k
   INTEGER(IntKi)                 :: i1_l,i2_l,i3_l,i4_l,i5_l  ! lower bounds for an array dimension
   INTEGER(IntKi)                 :: i1_u,i2_u,i3_u,i4_u,i5_u  ! upper bounds for an array dimension
! 
   ErrStat = ErrID_None
   ErrMsg  = ""
IF (ALLOCATED(SrcOutputData%OutputLoads)) THEN
   i1_l = LBOUND(SrcOutputData%OutputLoads,1)
   i1_u = UBOUND(SrcOutputData%OutputLoads,1)
   IF (.NOT.ALLOCATED(DstOutputData%OutputLoads)) THEN 
      ALLOCATE(DstOutputData%OutputLoads(i1_l:i1_u),STAT=ErrStat)
      IF (ErrStat /= 0) THEN 
         ErrStat = ErrID_Fatal 
         ErrMsg = 'AD_CopyOutput: Error allocating DstOutputData%OutputLoads.'
         RETURN
      END IF
   END IF
   DO i1 = LBOUND(SrcOutputData%OutputLoads,1), UBOUND(SrcOutputData%OutputLoads,1)
     CALL MeshCopy( SrcOutputData%OutputLoads(i1), DstOutputData%OutputLoads(i1), CtrlCode, ErrStat, ErrMsg )
   ENDDO
ENDIF
     CALL MeshCopy( SrcOutputData%Twr_OutputLoads, DstOutputData%Twr_OutputLoads, CtrlCode, ErrStat, ErrMsg )
      CALL IfW_CopyOutput( SrcOutputData%IfW_Outputs, DstOutputData%IfW_Outputs, CtrlCode, ErrStat, ErrMsg )
 END SUBROUTINE AD_CopyOutput

 SUBROUTINE AD_DestroyOutput( OutputData, ErrStat, ErrMsg )
  TYPE(AD_outputtype), INTENT(INOUT) :: OutputData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5 
! 
  ErrStat = ErrID_None
  ErrMsg  = ""
IF (ALLOCATED(OutputData%OutputLoads)) THEN
DO i1 = LBOUND(OutputData%OutputLoads,1), UBOUND(OutputData%OutputLoads,1)
  CALL MeshDestroy( OutputData%OutputLoads(i1), ErrStat, ErrMsg )
ENDDO
   DEALLOCATE(OutputData%OutputLoads)
ENDIF
  CALL MeshDestroy( OutputData%Twr_OutputLoads, ErrStat, ErrMsg )
  CALL IfW_DestroyOutput( OutputData%IfW_Outputs, ErrStat, ErrMsg )
 END SUBROUTINE AD_DestroyOutput

 SUBROUTINE AD_PackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Indata, ErrStat, ErrMsg, SizeOnly )
  REAL(ReKi),       ALLOCATABLE, INTENT(  OUT) :: ReKiBuf(:)
  REAL(DbKi),       ALLOCATABLE, INTENT(  OUT) :: DbKiBuf(:)
  INTEGER(IntKi),   ALLOCATABLE, INTENT(  OUT) :: IntKiBuf(:)
  TYPE(AD_outputtype),  INTENT(INOUT) :: InData
  INTEGER(IntKi),   INTENT(  OUT) :: ErrStat
  CHARACTER(*),     INTENT(  OUT) :: ErrMsg
  LOGICAL,OPTIONAL, INTENT(IN   ) :: SizeOnly
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i,i1,i2,i3,i4,i5     
  LOGICAL                        :: OnlySize ! if present and true, do not pack, just allocate buffers
 ! buffers to store meshes, if any
  REAL(ReKi),     ALLOCATABLE :: Re_OutputLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_OutputLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_OutputLoads_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_Twr_OutputLoads_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_Twr_OutputLoads_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_Twr_OutputLoads_Buf(:)
  REAL(ReKi),     ALLOCATABLE :: Re_IfW_Outputs_Buf(:)
  REAL(DbKi),     ALLOCATABLE :: Db_IfW_Outputs_Buf(:)
  INTEGER(IntKi), ALLOCATABLE :: Int_IfW_Outputs_Buf(:)
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(InData%OutputLoads,1), UBOUND(InData%OutputLoads,1)
 ! Allocate mesh buffers, if any (we'll also get sizes from these) 
  CALL MeshPack( InData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_OutputLoads_Buf  ) ! OutputLoads
  IF(ALLOCATED(Db_OutputLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_OutputLoads_Buf  ) ! OutputLoads
  IF(ALLOCATED(Int_OutputLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_OutputLoads_Buf ) ! OutputLoads
  IF(ALLOCATED(Re_OutputLoads_Buf))  DEALLOCATE(Re_OutputLoads_Buf)
  IF(ALLOCATED(Db_OutputLoads_Buf))  DEALLOCATE(Db_OutputLoads_Buf)
  IF(ALLOCATED(Int_OutputLoads_Buf)) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( InData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg, .TRUE. ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_Twr_OutputLoads_Buf  ) ! Twr_OutputLoads
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_Twr_OutputLoads_Buf  ) ! Twr_OutputLoads
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf))Int_BufSz = Int_BufSz + SIZE( Int_Twr_OutputLoads_Buf ) ! Twr_OutputLoads
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf))  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf))  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) DEALLOCATE(Int_Twr_OutputLoads_Buf)
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, InData%IfW_Outputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) Re_BufSz  = Re_BufSz  + SIZE( Re_IfW_Outputs_Buf  ) ! IfW_Outputs
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) Db_BufSz  = Db_BufSz  + SIZE( Db_IfW_Outputs_Buf  ) ! IfW_Outputs
  IF(ALLOCATED(Int_IfW_Outputs_Buf))Int_BufSz = Int_BufSz + SIZE( Int_IfW_Outputs_Buf ) ! IfW_Outputs
  IF(ALLOCATED(Re_IfW_Outputs_Buf))  DEALLOCATE(Re_IfW_Outputs_Buf)
  IF(ALLOCATED(Db_IfW_Outputs_Buf))  DEALLOCATE(Db_IfW_Outputs_Buf)
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) DEALLOCATE(Int_IfW_Outputs_Buf)
  IF ( Re_BufSz  .GT. 0 ) ALLOCATE( ReKiBuf(  Re_BufSz  ) )
  IF ( Db_BufSz  .GT. 0 ) ALLOCATE( DbKiBuf(  Db_BufSz  ) )
  IF ( Int_BufSz .GT. 0 ) ALLOCATE( IntKiBuf( Int_BufSz ) )
DO i1 = LBOUND(InData%OutputLoads,1), UBOUND(InData%OutputLoads,1)
  CALL MeshPack( InData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutputLoads_Buf)-1 ) = Re_OutputLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutputLoads_Buf)-1 ) = Db_OutputLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutputLoads_Buf)-1 ) = Int_OutputLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_OutputLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_OutputLoads_Buf) )  DEALLOCATE(Re_OutputLoads_Buf)
  IF( ALLOCATED(Db_OutputLoads_Buf) )  DEALLOCATE(Db_OutputLoads_Buf)
  IF( ALLOCATED(Int_OutputLoads_Buf) ) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( InData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg, OnlySize ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_OutputLoads_Buf)-1 ) = Re_Twr_OutputLoads_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_OutputLoads_Buf)-1 ) = Db_Twr_OutputLoads_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_OutputLoads_Buf)-1 ) = Int_Twr_OutputLoads_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_OutputLoads_Buf)
  ENDIF
  IF( ALLOCATED(Re_Twr_OutputLoads_Buf) )  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Db_Twr_OutputLoads_Buf) )  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Int_Twr_OutputLoads_Buf) ) DEALLOCATE(Int_Twr_OutputLoads_Buf)
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, InData%IfW_Outputs, ErrStat, ErrMsg, OnlySize ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Outputs_Buf)-1 ) = Re_IfW_Outputs_Buf
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Outputs_Buf)-1 ) = Db_IfW_Outputs_Buf
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) THEN
    IF ( .NOT. OnlySize ) IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Outputs_Buf)-1 ) = Int_IfW_Outputs_Buf
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Outputs_Buf)
  ENDIF
  IF( ALLOCATED(Re_IfW_Outputs_Buf) )  DEALLOCATE(Re_IfW_Outputs_Buf)
  IF( ALLOCATED(Db_IfW_Outputs_Buf) )  DEALLOCATE(Db_IfW_Outputs_Buf)
  IF( ALLOCATED(Int_IfW_Outputs_Buf) ) DEALLOCATE(Int_IfW_Outputs_Buf)
 END SUBROUTINE AD_PackOutput

 SUBROUTINE AD_UnPackOutput( ReKiBuf, DbKiBuf, IntKiBuf, Outdata, ErrStat, ErrMsg )
  REAL(ReKi),      ALLOCATABLE, INTENT(IN   ) :: ReKiBuf(:)
  REAL(DbKi),      ALLOCATABLE, INTENT(IN   ) :: DbKiBuf(:)
  INTEGER(IntKi),  ALLOCATABLE, INTENT(IN   ) :: IntKiBuf(:)
  TYPE(AD_outputtype), INTENT(INOUT) :: OutData
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  INTEGER(IntKi)                 :: Re_BufSz
  INTEGER(IntKi)                 :: Re_Xferred
  INTEGER(IntKi)                 :: Re_CurrSz
  INTEGER(IntKi)                 :: Db_BufSz
  INTEGER(IntKi)                 :: Db_Xferred
  INTEGER(IntKi)                 :: Db_CurrSz
  INTEGER(IntKi)                 :: Int_BufSz
  INTEGER(IntKi)                 :: Int_Xferred
  INTEGER(IntKi)                 :: Int_CurrSz
  INTEGER(IntKi)                 :: i, i1, i2, i3, i4, i5
  LOGICAL, ALLOCATABLE           :: mask1(:)
  LOGICAL, ALLOCATABLE           :: mask2(:,:)
  LOGICAL, ALLOCATABLE           :: mask3(:,:,:)
  LOGICAL, ALLOCATABLE           :: mask4(:,:,:,:)
  LOGICAL, ALLOCATABLE           :: mask5(:,:,:,:,:)
 ! buffers to store meshes, if any
  REAL(ReKi),    ALLOCATABLE :: Re_OutputLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_OutputLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_OutputLoads_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_Twr_OutputLoads_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_Twr_OutputLoads_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_Twr_OutputLoads_Buf(:)
  REAL(ReKi),    ALLOCATABLE :: Re_IfW_Outputs_Buf(:)
  REAL(DbKi),    ALLOCATABLE :: Db_IfW_Outputs_Buf(:)
  INTEGER(IntKi),    ALLOCATABLE :: Int_IfW_Outputs_Buf(:)
    !
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
  Re_BufSz  = 0
  Db_BufSz  = 0
  Int_BufSz  = 0
DO i1 = LBOUND(OutData%OutputLoads,1), UBOUND(OutData%OutputLoads,1)
 ! first call MeshPack to get correctly sized buffers for unpacking
  CALL MeshPack( OutData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! OutputLoads 
  IF(ALLOCATED(Re_OutputLoads_Buf)) THEN
    Re_OutputLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_OutputLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_OutputLoads_Buf)) THEN
    Db_OutputLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_OutputLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_OutputLoads_Buf)) THEN
    Int_OutputLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_OutputLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_OutputLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%OutputLoads(i1), Re_OutputLoads_Buf, Db_OutputLoads_Buf, Int_OutputLoads_Buf, ErrStat, ErrMsg ) ! OutputLoads 
  IF( ALLOCATED(Re_OutputLoads_Buf) )  DEALLOCATE(Re_OutputLoads_Buf)
  IF( ALLOCATED(Db_OutputLoads_Buf) )  DEALLOCATE(Db_OutputLoads_Buf)
  IF( ALLOCATED(Int_OutputLoads_Buf) ) DEALLOCATE(Int_OutputLoads_Buf)
ENDDO
  CALL MeshPack( OutData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg , .TRUE. ) ! Twr_OutputLoads 
  IF(ALLOCATED(Re_Twr_OutputLoads_Buf)) THEN
    Re_Twr_OutputLoads_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_Twr_OutputLoads_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Db_Twr_OutputLoads_Buf)) THEN
    Db_Twr_OutputLoads_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_Twr_OutputLoads_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_Twr_OutputLoads_Buf)
  ENDIF
  IF(ALLOCATED(Int_Twr_OutputLoads_Buf)) THEN
    Int_Twr_OutputLoads_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_Twr_OutputLoads_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_Twr_OutputLoads_Buf)
  ENDIF
  CALL MeshUnPack( OutData%Twr_OutputLoads, Re_Twr_OutputLoads_Buf, Db_Twr_OutputLoads_Buf, Int_Twr_OutputLoads_Buf, ErrStat, ErrMsg ) ! Twr_OutputLoads 
  IF( ALLOCATED(Re_Twr_OutputLoads_Buf) )  DEALLOCATE(Re_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Db_Twr_OutputLoads_Buf) )  DEALLOCATE(Db_Twr_OutputLoads_Buf)
  IF( ALLOCATED(Int_Twr_OutputLoads_Buf) ) DEALLOCATE(Int_Twr_OutputLoads_Buf)
 ! first call IfW_PackOutput to get correctly sized buffers for unpacking
  CALL IfW_PackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, OutData%IfW_Outputs, ErrStat, ErrMsg, .TRUE. ) ! IfW_Outputs 
  IF(ALLOCATED(Re_IfW_Outputs_Buf)) THEN
    Re_IfW_Outputs_Buf = ReKiBuf( Re_Xferred:Re_Xferred+SIZE(Re_IfW_Outputs_Buf)-1 )
    Re_Xferred = Re_Xferred + SIZE(Re_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Db_IfW_Outputs_Buf)) THEN
    Db_IfW_Outputs_Buf = DbKiBuf( Db_Xferred:Db_Xferred+SIZE(Db_IfW_Outputs_Buf)-1 )
    Db_Xferred = Db_Xferred + SIZE(Db_IfW_Outputs_Buf)
  ENDIF
  IF(ALLOCATED(Int_IfW_Outputs_Buf)) THEN
    Int_IfW_Outputs_Buf = IntKiBuf( Int_Xferred:Int_Xferred+SIZE(Int_IfW_Outputs_Buf)-1 )
    Int_Xferred = Int_Xferred + SIZE(Int_IfW_Outputs_Buf)
  ENDIF
  CALL IfW_UnPackOutput( Re_IfW_Outputs_Buf, Db_IfW_Outputs_Buf, Int_IfW_Outputs_Buf, OutData%IfW_Outputs, ErrStat, ErrMsg ) ! IfW_Outputs 
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPackOutput

 SUBROUTINE AD_Pack( Re_RetAry, Db_RetAry, Int_RetAry, &
                     InData, ParamData, ContStateData, DiscStateData, &
                     ConstrStateData, OtherStateData, OutData, ErrStat, ErrMsg, &
                     SizeOnly )
  TYPE(AD_InputType),           INTENT(INOUT) :: InData
  TYPE(AD_ParameterType),       INTENT(INOUT) :: ParamData
  TYPE(AD_ContinuousStateType), INTENT(INOUT) :: ContStateData
  TYPE(AD_DiscreteStateType),   INTENT(INOUT) :: DiscStateData
  TYPE(AD_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  TYPE(AD_OtherStateType),      INTENT(INOUT) :: OtherStateData
  TYPE(AD_OutputType),          INTENT(INOUT) :: OutData
  REAL(ReKi), ALLOCATABLE,      INTENT(  OUT) :: Re_RetAry(:)
  REAL(DbKi), ALLOCATABLE,      INTENT(  OUT) :: Db_RetAry(:)
  INTEGER(IntKi), ALLOCATABLE,  INTENT(  OUT) :: Int_RetAry(:)
  INTEGER(IntKi),               INTENT(  OUT) :: ErrStat
  CHARACTER(*),                 INTENT(  OUT) :: ErrMsg
  LOGICAL, OPTIONAL,            INTENT(IN   ) :: SizeOnly
    ! Local variables
  REAL(ReKi), ALLOCATABLE                :: Re_Ary(:)
  REAL(DbKi), ALLOCATABLE                :: Db_Ary(:)
  INTEGER(IntKi), ALLOCATABLE            :: Int_Ary(:)
  INTEGER(IntKi)                         :: Re_BufSz
  INTEGER(IntKi)                         :: Re_Xferred
  INTEGER(IntKi)                         :: Re_CurrSz
  INTEGER(IntKi)                         :: Db_BufSz
  INTEGER(IntKi)                         :: Db_Xferred
  INTEGER(IntKi)                         :: Db_CurrSz
  INTEGER(IntKi)                         :: Int_BufSz
  INTEGER(IntKi)                         :: Int_Xferred
  INTEGER(IntKi)                         :: Int_CurrSz
  INTEGER(IntKi)                         :: ErrStat2
  CHARACTER(Len(ErrMsg))                 :: ErrMsg2
  LOGICAL                                :: OnlySize ! if present and true, do not pack, just allocate buffers
    ! Executable statements
  ErrStat = ErrID_None
  ErrMsg  = ""
  OnlySize = .FALSE.
  IF ( PRESENT(SizeOnly) ) THEN
    OnlySize = SizeOnly
  ENDIF
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
    ! Pack Input
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Param
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ContState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack DiscState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ConstrState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack OtherState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Output
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
  Re_Xferred  = Re_Xferred - 1
  Db_Xferred  = Db_Xferred - 1
  Int_Xferred  = Int_Xferred - 1
  IF ( ALLOCATED( Re_RetAry ) ) DEALLOCATE( Re_RetAry ) ;
  IF ( Re_Xferred .GT. 0) ALLOCATE( Re_RetAry( Re_Xferred ) ) ;
  IF ( ALLOCATED( Db_RetAry ) ) DEALLOCATE( Db_RetAry ) ;
  IF ( Db_Xferred .GT. 0) ALLOCATE( Db_RetAry( Db_Xferred ) ) ;
  IF ( ALLOCATED( Int_RetAry ) ) DEALLOCATE( Int_RetAry ) ;
  IF ( Int_Xferred .GT. 0) ALLOCATE( Int_RetAry( Int_Xferred ) ) ;
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
    ! Pack Input
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Param
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ContState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack DiscState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack ConstrState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack OtherState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
    ! Pack Output
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)=Re_Ary
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
    DEALLOCATE(Re_Ary)
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)=Db_Ary
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
    DEALLOCATE(Db_Ary)
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    IF ( .NOT. OnlySize ) Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)=Int_Ary
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
    DEALLOCATE(Int_Ary)
  ENDIF
  Re_Xferred   = Re_Xferred - 1
  Db_Xferred   = Db_Xferred - 1
  Int_Xferred  = Int_Xferred - 1
 END SUBROUTINE AD_Pack

 SUBROUTINE AD_UnPack( Re_RetAry, Db_RetAry, Int_RetAry, &
                     InData, ParamData, ContStateData, DiscStateData, &
                     ConstrStateData, OtherStateData, OutData, ErrStat, ErrMsg )
  TYPE(AD_InputType),           INTENT(INOUT) :: InData
  TYPE(AD_ParameterType),       INTENT(INOUT) :: ParamData
  TYPE(AD_ContinuousStateType), INTENT(INOUT) :: ContStateData
  TYPE(AD_DiscreteStateType),   INTENT(INOUT) :: DiscStateData
  TYPE(AD_ConstraintStateType), INTENT(INOUT) :: ConstrStateData
  TYPE(AD_OtherStateType),      INTENT(INOUT) :: OtherStateData
  TYPE(AD_OutputType),          INTENT(INOUT) :: OutData
  REAL(ReKi), ALLOCATABLE,      INTENT(IN   ) :: Re_RetAry(:)
  REAL(DbKi), ALLOCATABLE,      INTENT(IN   ) :: Db_RetAry(:)
  INTEGER(IntKi), ALLOCATABLE,   INTENT(IN   ) :: Int_RetAry(:)
  INTEGER(IntKi),  INTENT(  OUT) :: ErrStat
  CHARACTER(*),    INTENT(  OUT) :: ErrMsg
    ! Local variables
  REAL(ReKi), ALLOCATABLE                :: Re_Ary(:)
  REAL(DbKi), ALLOCATABLE                :: Db_Ary(:)
  INTEGER(IntKi), ALLOCATABLE            :: Int_Ary(:)
  INTEGER(IntKi)                         :: Re_BufSz
  INTEGER(IntKi)                         :: Re_Xferred
  INTEGER(IntKi)                         :: Re_CurrSz
  INTEGER(IntKi)                         :: Db_BufSz
  INTEGER(IntKi)                         :: Db_Xferred
  INTEGER(IntKi)                         :: Db_CurrSz
  INTEGER(IntKi)                         :: Int_BufSz
  INTEGER(IntKi)                         :: Int_Xferred
  INTEGER(IntKi)                         :: Int_CurrSz
  INTEGER(IntKi)                         :: ErrStat2
  CHARACTER(Len(ErrMsg))                 :: ErrMsg2
  ErrStat = ErrID_None
  ErrMsg  = ""
  Re_Xferred  = 1
  Db_Xferred  = 1
  Int_Xferred  = 1
    ! UnPack Input
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackInput(Re_Ary,Db_Ary,Int_Ary,InData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack Param
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackParam(Re_Ary,Db_Ary,Int_Ary,ParamData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack ContState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackContState(Re_Ary,Db_Ary,Int_Ary,ContStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack DiscState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackDiscState(Re_Ary,Db_Ary,Int_Ary,DiscStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack ConstrState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackConstrState(Re_Ary,Db_Ary,Int_Ary,ConstrStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack OtherState
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackOtherState(Re_Ary,Db_Ary,Int_Ary,OtherStateData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
    ! UnPack Output
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  CALL AD_PackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2,SizeOnly=.TRUE.)
  IF ( ALLOCATED( Re_Ary ) ) THEN
    Re_Ary = Re_RetAry(Re_Xferred:Re_Xferred+SIZE(Re_Ary)-1)
    Re_Xferred = Re_Xferred + SIZE( Re_Ary )
  ENDIF
  IF ( ALLOCATED( Db_Ary ) ) THEN
    DB_Ary = Db_RetAry(Db_Xferred:Db_Xferred+SIZE(Db_Ary)-1)
    Db_Xferred = Db_Xferred + SIZE( Db_Ary )
  ENDIF
  IF ( ALLOCATED( Int_Ary ) ) THEN
    Int_Ary = Int_RetAry(Int_Xferred:Int_Xferred+SIZE(Int_Ary)-1)
    Int_Xferred = Int_Xferred + SIZE( Int_Ary )
  ENDIF
  CALL AD_UnPackOutput(Re_Ary,Db_Ary,Int_Ary,OutData,ErrStat2,ErrMsg2)
  IF ( ALLOCATED( Re_Ary ) )  DEALLOCATE(Re_Ary)
  IF ( ALLOCATED( Db_Ary ) )  DEALLOCATE(Db_Ary)
  IF ( ALLOCATED( Int_Ary ) )  DEALLOCATE(Int_Ary)
  Re_Xferred   = Re_Xferred-1
  Db_Xferred   = Db_Xferred-1
  Int_Xferred  = Int_Xferred-1
 END SUBROUTINE AD_UnPack


 SUBROUTINE AD_Input_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(AD_inputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(AD_inputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: b3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: c3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: b4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: c4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: b5       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: c5       ! temporary for extrapolation/interpolation
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i11    ! dim1 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i21    ! dim1 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i31    ! dim1 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i41    ! dim1 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i51    ! dim1 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i61    ! dim1 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i71    ! dim1 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i81    ! dim1 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i91    ! dim1 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i02    ! dim2 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i12    ! dim2 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i22    ! dim2 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i32    ! dim2 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i42    ! dim2 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i52    ! dim2 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i62    ! dim2 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i72    ! dim2 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i82    ! dim2 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i92    ! dim2 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i03    ! dim3 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i13    ! dim3 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i23    ! dim3 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i33    ! dim3 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i43    ! dim3 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i53    ! dim3 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i63    ! dim3 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i73    ! dim3 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i83    ! dim3 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i93    ! dim3 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i04    ! dim4 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i14    ! dim4 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i24    ! dim4 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i34    ! dim4 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i44    ! dim4 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i54    ! dim4 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i64    ! dim4 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i74    ! dim4 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i84    ! dim4 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i94    ! dim4 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i05    ! dim5 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i15    ! dim5 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i25    ! dim5 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i35    ! dim5 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i45    ! dim5 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i55    ! dim5 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i65    ! dim5 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i75    ! dim5 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i85    ! dim5 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i95    ! dim5 level 9 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in AD_Input_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshCopy(u(1)%InputMarkers(i01), u_out%InputMarkers(i01), MESH_UPDATECOPY, ErrStat, ErrMsg )
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%Twr_InputMarkers, u_out%Twr_InputMarkers, MESH_UPDATECOPY, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel
  ENDDO
END IF ! check if allocated
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength
      CALL IfW_Input_ExtrapInterp( u%IfW_Inputs, tin, u_out%IfW_Inputs, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  u_out%MulTabLoc = u(1)%MulTabLoc
END IF ! check if allocated
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshExtrapInterp1(u(1)%InputMarkers(i01), u(2)%InputMarkers(i01), tin, u_out%InputMarkers(i01), tin_out, ErrStat, ErrMsg )
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%Twr_InputMarkers, u(2)%Twr_InputMarkers, tin, u_out%Twr_InputMarkers, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%Position - u(2)%TurbineComponents%Blade(i11)%Position)/t(2)
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Blade(i11)%Orientation - u(2)%TurbineComponents%Blade(i11)%Orientation)/t(2)
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%TranslationVel - u(2)%TurbineComponents%Blade(i11)%TranslationVel)/t(2)
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Blade(i11)%RotationVel - u(2)%TurbineComponents%Blade(i11)%RotationVel)/t(2)
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
END IF ! check if allocated
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  b1 = -(u(1)%TurbineComponents%Hub%Position - u(2)%TurbineComponents%Hub%Position)/t(2)
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Hub%Orientation - u(2)%TurbineComponents%Hub%Orientation)/t(2)
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Hub%TranslationVel - u(2)%TurbineComponents%Hub%TranslationVel)/t(2)
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Hub%RotationVel - u(2)%TurbineComponents%Hub%RotationVel)/t(2)
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%Position - u(2)%TurbineComponents%RotorFurl%Position)/t(2)
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%RotorFurl%Orientation - u(2)%TurbineComponents%RotorFurl%Orientation)/t(2)
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%TranslationVel - u(2)%TurbineComponents%RotorFurl%TranslationVel)/t(2)
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%RotorFurl%RotationVel - u(2)%TurbineComponents%RotorFurl%RotationVel)/t(2)
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%Position - u(2)%TurbineComponents%Nacelle%Position)/t(2)
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Nacelle%Orientation - u(2)%TurbineComponents%Nacelle%Orientation)/t(2)
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%TranslationVel - u(2)%TurbineComponents%Nacelle%TranslationVel)/t(2)
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Nacelle%RotationVel - u(2)%TurbineComponents%Nacelle%RotationVel)/t(2)
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%Position - u(2)%TurbineComponents%TailFin%Position)/t(2)
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%TailFin%Orientation - u(2)%TurbineComponents%TailFin%Orientation)/t(2)
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%TranslationVel - u(2)%TurbineComponents%TailFin%TranslationVel)/t(2)
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%TailFin%RotationVel - u(2)%TurbineComponents%TailFin%RotationVel)/t(2)
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  b1 = -(u(1)%TurbineComponents%Tower%Position - u(2)%TurbineComponents%Tower%Position)/t(2)
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Tower%Orientation - u(2)%TurbineComponents%Tower%Orientation)/t(2)
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Tower%TranslationVel - u(2)%TurbineComponents%Tower%TranslationVel)/t(2)
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Tower%RotationVel - u(2)%TurbineComponents%Tower%RotationVel)/t(2)
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%Position - u(2)%TurbineComponents%SubStructure%Position)/t(2)
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%SubStructure%Orientation - u(2)%TurbineComponents%SubStructure%Orientation)/t(2)
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%TranslationVel - u(2)%TurbineComponents%SubStructure%TranslationVel)/t(2)
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%SubStructure%RotationVel - u(2)%TurbineComponents%SubStructure%RotationVel)/t(2)
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%Position - u(2)%TurbineComponents%Foundation%Position)/t(2)
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  b2 = -(u(1)%TurbineComponents%Foundation%Orientation - u(2)%TurbineComponents%Foundation%Orientation)/t(2)
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%TranslationVel - u(2)%TurbineComponents%Foundation%TranslationVel)/t(2)
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  b1 = -(u(1)%TurbineComponents%Foundation%RotationVel - u(2)%TurbineComponents%Foundation%RotationVel)/t(2)
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel + b1 * t_out
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = -(u(1)%TurbineComponents%BladeLength - u(2)%TurbineComponents%BladeLength)/t(2)
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength + b0 * t_out
      CALL IfW_Input_ExtrapInterp( u%IfW_Inputs, tin, u_out%IfW_Inputs, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  ALLOCATE(b2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  ALLOCATE(c2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  b2 = -(u(1)%MulTabLoc - u(2)%MulTabLoc)/t(2)
  u_out%MulTabLoc = u(1)%MulTabLoc + b2 * t_out
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Input_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%InputMarkers) .AND. ALLOCATED(u(1)%InputMarkers)) THEN
  DO i01 = LBOUND(u_out%InputMarkers,1),UBOUND(u_out%InputMarkers,1)
  CALL MeshExtrapInterp2(u(1)%InputMarkers(i01), u(2)%InputMarkers(i01), u(3)%InputMarkers(i01), tin, u_out%InputMarkers(i01), tin_out, ErrStat, ErrMsg )
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%Twr_InputMarkers, u(2)%Twr_InputMarkers, u(3)%Twr_InputMarkers, tin, u_out%Twr_InputMarkers, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%TurbineComponents%Blade) .AND. ALLOCATED(u(1)%TurbineComponents%Blade)) THEN
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%Position - u(2)%TurbineComponents%Blade(i11)%Position) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%Position + u(3)%TurbineComponents%Blade(i11)%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%Position + t(3)*u(2)%TurbineComponents%Blade(i11)%Position - t(2)*u(3)%TurbineComponents%Blade(i11)%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%Position = u(1)%TurbineComponents%Blade(i11)%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,1),SIZE(u_out%TurbineComponents%Blade(i11)%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%Orientation - u(2)%TurbineComponents%Blade(i11)%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%Orientation + u(3)%TurbineComponents%Blade(i11)%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%Orientation + t(3)*u(2)%TurbineComponents%Blade(i11)%Orientation - t(2)*u(3)%TurbineComponents%Blade(i11)%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%Orientation = u(1)%TurbineComponents%Blade(i11)%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%TranslationVel - u(2)%TurbineComponents%Blade(i11)%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%TranslationVel + u(3)%TurbineComponents%Blade(i11)%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%TranslationVel + t(3)*u(2)%TurbineComponents%Blade(i11)%TranslationVel - t(2)*u(3)%TurbineComponents%Blade(i11)%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%TranslationVel = u(1)%TurbineComponents%Blade(i11)%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
  DO i11 = LBOUND(u_out%TurbineComponents%Blade,1),UBOUND(u_out%TurbineComponents%Blade,1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Blade(i11)%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Blade(i11)%RotationVel - u(2)%TurbineComponents%Blade(i11)%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Blade(i11)%RotationVel + u(3)%TurbineComponents%Blade(i11)%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Blade(i11)%RotationVel + t(3)*u(2)%TurbineComponents%Blade(i11)%RotationVel - t(2)*u(3)%TurbineComponents%Blade(i11)%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Blade(i11)%RotationVel = u(1)%TurbineComponents%Blade(i11)%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ENDDO
END IF ! check if allocated
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%Position - u(2)%TurbineComponents%Hub%Position) + t(2)**2*(-u(1)%TurbineComponents%Hub%Position + u(3)%TurbineComponents%Hub%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%Position + t(3)*u(2)%TurbineComponents%Hub%Position - t(2)*u(3)%TurbineComponents%Hub%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%Position = u(1)%TurbineComponents%Hub%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Hub%Orientation,1),SIZE(u_out%TurbineComponents%Hub%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Hub%Orientation - u(2)%TurbineComponents%Hub%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Hub%Orientation + u(3)%TurbineComponents%Hub%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%Orientation + t(3)*u(2)%TurbineComponents%Hub%Orientation - t(2)*u(3)%TurbineComponents%Hub%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%Orientation = u(1)%TurbineComponents%Hub%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%TranslationVel - u(2)%TurbineComponents%Hub%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Hub%TranslationVel + u(3)%TurbineComponents%Hub%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%TranslationVel + t(3)*u(2)%TurbineComponents%Hub%TranslationVel - t(2)*u(3)%TurbineComponents%Hub%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%TranslationVel = u(1)%TurbineComponents%Hub%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Hub%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Hub%RotationVel - u(2)%TurbineComponents%Hub%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Hub%RotationVel + u(3)%TurbineComponents%Hub%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Hub%RotationVel + t(3)*u(2)%TurbineComponents%Hub%RotationVel - t(2)*u(3)%TurbineComponents%Hub%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Hub%RotationVel = u(1)%TurbineComponents%Hub%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%Position - u(2)%TurbineComponents%RotorFurl%Position) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%Position + u(3)%TurbineComponents%RotorFurl%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%Position + t(3)*u(2)%TurbineComponents%RotorFurl%Position - t(2)*u(3)%TurbineComponents%RotorFurl%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%Position = u(1)%TurbineComponents%RotorFurl%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%RotorFurl%Orientation,1),SIZE(u_out%TurbineComponents%RotorFurl%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%Orientation - u(2)%TurbineComponents%RotorFurl%Orientation) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%Orientation + u(3)%TurbineComponents%RotorFurl%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%Orientation + t(3)*u(2)%TurbineComponents%RotorFurl%Orientation - t(2)*u(3)%TurbineComponents%RotorFurl%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%Orientation = u(1)%TurbineComponents%RotorFurl%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%TranslationVel - u(2)%TurbineComponents%RotorFurl%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%TranslationVel + u(3)%TurbineComponents%RotorFurl%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%TranslationVel + t(3)*u(2)%TurbineComponents%RotorFurl%TranslationVel - t(2)*u(3)%TurbineComponents%RotorFurl%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%TranslationVel = u(1)%TurbineComponents%RotorFurl%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%RotorFurl%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%RotorFurl%RotationVel - u(2)%TurbineComponents%RotorFurl%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%RotorFurl%RotationVel + u(3)%TurbineComponents%RotorFurl%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%RotorFurl%RotationVel + t(3)*u(2)%TurbineComponents%RotorFurl%RotationVel - t(2)*u(3)%TurbineComponents%RotorFurl%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%RotorFurl%RotationVel = u(1)%TurbineComponents%RotorFurl%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%Position - u(2)%TurbineComponents%Nacelle%Position) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%Position + u(3)%TurbineComponents%Nacelle%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%Position + t(3)*u(2)%TurbineComponents%Nacelle%Position - t(2)*u(3)%TurbineComponents%Nacelle%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%Position = u(1)%TurbineComponents%Nacelle%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Nacelle%Orientation,1),SIZE(u_out%TurbineComponents%Nacelle%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%Orientation - u(2)%TurbineComponents%Nacelle%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%Orientation + u(3)%TurbineComponents%Nacelle%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%Orientation + t(3)*u(2)%TurbineComponents%Nacelle%Orientation - t(2)*u(3)%TurbineComponents%Nacelle%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%Orientation = u(1)%TurbineComponents%Nacelle%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%TranslationVel - u(2)%TurbineComponents%Nacelle%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%TranslationVel + u(3)%TurbineComponents%Nacelle%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%TranslationVel + t(3)*u(2)%TurbineComponents%Nacelle%TranslationVel - t(2)*u(3)%TurbineComponents%Nacelle%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%TranslationVel = u(1)%TurbineComponents%Nacelle%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Nacelle%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Nacelle%RotationVel - u(2)%TurbineComponents%Nacelle%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Nacelle%RotationVel + u(3)%TurbineComponents%Nacelle%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Nacelle%RotationVel + t(3)*u(2)%TurbineComponents%Nacelle%RotationVel - t(2)*u(3)%TurbineComponents%Nacelle%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Nacelle%RotationVel = u(1)%TurbineComponents%Nacelle%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%Position - u(2)%TurbineComponents%TailFin%Position) + t(2)**2*(-u(1)%TurbineComponents%TailFin%Position + u(3)%TurbineComponents%TailFin%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%Position + t(3)*u(2)%TurbineComponents%TailFin%Position - t(2)*u(3)%TurbineComponents%TailFin%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%Position = u(1)%TurbineComponents%TailFin%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%TailFin%Orientation,1),SIZE(u_out%TurbineComponents%TailFin%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%TailFin%Orientation - u(2)%TurbineComponents%TailFin%Orientation) + t(2)**2*(-u(1)%TurbineComponents%TailFin%Orientation + u(3)%TurbineComponents%TailFin%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%Orientation + t(3)*u(2)%TurbineComponents%TailFin%Orientation - t(2)*u(3)%TurbineComponents%TailFin%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%Orientation = u(1)%TurbineComponents%TailFin%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%TranslationVel - u(2)%TurbineComponents%TailFin%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%TailFin%TranslationVel + u(3)%TurbineComponents%TailFin%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%TranslationVel + t(3)*u(2)%TurbineComponents%TailFin%TranslationVel - t(2)*u(3)%TurbineComponents%TailFin%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%TranslationVel = u(1)%TurbineComponents%TailFin%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%TailFin%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%TailFin%RotationVel - u(2)%TurbineComponents%TailFin%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%TailFin%RotationVel + u(3)%TurbineComponents%TailFin%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%TailFin%RotationVel + t(3)*u(2)%TurbineComponents%TailFin%RotationVel - t(2)*u(3)%TurbineComponents%TailFin%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%TailFin%RotationVel = u(1)%TurbineComponents%TailFin%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%Position - u(2)%TurbineComponents%Tower%Position) + t(2)**2*(-u(1)%TurbineComponents%Tower%Position + u(3)%TurbineComponents%Tower%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%Position + t(3)*u(2)%TurbineComponents%Tower%Position - t(2)*u(3)%TurbineComponents%Tower%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%Position = u(1)%TurbineComponents%Tower%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Tower%Orientation,1),SIZE(u_out%TurbineComponents%Tower%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Tower%Orientation - u(2)%TurbineComponents%Tower%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Tower%Orientation + u(3)%TurbineComponents%Tower%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%Orientation + t(3)*u(2)%TurbineComponents%Tower%Orientation - t(2)*u(3)%TurbineComponents%Tower%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%Orientation = u(1)%TurbineComponents%Tower%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%TranslationVel - u(2)%TurbineComponents%Tower%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Tower%TranslationVel + u(3)%TurbineComponents%Tower%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%TranslationVel + t(3)*u(2)%TurbineComponents%Tower%TranslationVel - t(2)*u(3)%TurbineComponents%Tower%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%TranslationVel = u(1)%TurbineComponents%Tower%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Tower%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Tower%RotationVel - u(2)%TurbineComponents%Tower%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Tower%RotationVel + u(3)%TurbineComponents%Tower%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Tower%RotationVel + t(3)*u(2)%TurbineComponents%Tower%RotationVel - t(2)*u(3)%TurbineComponents%Tower%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Tower%RotationVel = u(1)%TurbineComponents%Tower%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%Position - u(2)%TurbineComponents%SubStructure%Position) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%Position + u(3)%TurbineComponents%SubStructure%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%Position + t(3)*u(2)%TurbineComponents%SubStructure%Position - t(2)*u(3)%TurbineComponents%SubStructure%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%Position = u(1)%TurbineComponents%SubStructure%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%SubStructure%Orientation,1),SIZE(u_out%TurbineComponents%SubStructure%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%Orientation - u(2)%TurbineComponents%SubStructure%Orientation) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%Orientation + u(3)%TurbineComponents%SubStructure%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%Orientation + t(3)*u(2)%TurbineComponents%SubStructure%Orientation - t(2)*u(3)%TurbineComponents%SubStructure%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%Orientation = u(1)%TurbineComponents%SubStructure%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%TranslationVel - u(2)%TurbineComponents%SubStructure%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%TranslationVel + u(3)%TurbineComponents%SubStructure%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%TranslationVel + t(3)*u(2)%TurbineComponents%SubStructure%TranslationVel - t(2)*u(3)%TurbineComponents%SubStructure%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%TranslationVel = u(1)%TurbineComponents%SubStructure%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%SubStructure%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%SubStructure%RotationVel - u(2)%TurbineComponents%SubStructure%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%SubStructure%RotationVel + u(3)%TurbineComponents%SubStructure%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%SubStructure%RotationVel + t(3)*u(2)%TurbineComponents%SubStructure%RotationVel - t(2)*u(3)%TurbineComponents%SubStructure%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%SubStructure%RotationVel = u(1)%TurbineComponents%SubStructure%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%Position,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%Position - u(2)%TurbineComponents%Foundation%Position) + t(2)**2*(-u(1)%TurbineComponents%Foundation%Position + u(3)%TurbineComponents%Foundation%Position))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%Position + t(3)*u(2)%TurbineComponents%Foundation%Position - t(2)*u(3)%TurbineComponents%Foundation%Position ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%Position = u(1)%TurbineComponents%Foundation%Position + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  ALLOCATE(c2(SIZE(u_out%TurbineComponents%Foundation%Orientation,1),SIZE(u_out%TurbineComponents%Foundation%Orientation,2) ))
  b2 = (t(3)**2*(u(1)%TurbineComponents%Foundation%Orientation - u(2)%TurbineComponents%Foundation%Orientation) + t(2)**2*(-u(1)%TurbineComponents%Foundation%Orientation + u(3)%TurbineComponents%Foundation%Orientation))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%Orientation + t(3)*u(2)%TurbineComponents%Foundation%Orientation - t(2)*u(3)%TurbineComponents%Foundation%Orientation ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%Orientation = u(1)%TurbineComponents%Foundation%Orientation + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%TranslationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%TranslationVel - u(2)%TurbineComponents%Foundation%TranslationVel) + t(2)**2*(-u(1)%TurbineComponents%Foundation%TranslationVel + u(3)%TurbineComponents%Foundation%TranslationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%TranslationVel + t(3)*u(2)%TurbineComponents%Foundation%TranslationVel - t(2)*u(3)%TurbineComponents%Foundation%TranslationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%TranslationVel = u(1)%TurbineComponents%Foundation%TranslationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  ALLOCATE(b1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  ALLOCATE(c1(SIZE(u_out%TurbineComponents%Foundation%RotationVel,1)))
  b1 = (t(3)**2*(u(1)%TurbineComponents%Foundation%RotationVel - u(2)%TurbineComponents%Foundation%RotationVel) + t(2)**2*(-u(1)%TurbineComponents%Foundation%RotationVel + u(3)%TurbineComponents%Foundation%RotationVel))/(t(2)*t(3)*(t(2) - t(3)))
  c1 = ( (t(2)-t(3))*u(1)%TurbineComponents%Foundation%RotationVel + t(3)*u(2)%TurbineComponents%Foundation%RotationVel - t(2)*u(3)%TurbineComponents%Foundation%RotationVel ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%Foundation%RotationVel = u(1)%TurbineComponents%Foundation%RotationVel + b1 * t_out + c1 * t_out**2
  DEALLOCATE(b1)
  DEALLOCATE(c1)
  b0 = (t(3)**2*(u(1)%TurbineComponents%BladeLength - u(2)%TurbineComponents%BladeLength) + t(2)**2*(-u(1)%TurbineComponents%BladeLength + u(3)%TurbineComponents%BladeLength))/(t(2)*t(3)*(t(2) - t(3)))
  c0 = ( (t(2)-t(3))*u(1)%TurbineComponents%BladeLength + t(3)*u(2)%TurbineComponents%BladeLength - t(2)*u(3)%TurbineComponents%BladeLength ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%TurbineComponents%BladeLength = u(1)%TurbineComponents%BladeLength + b0 * t_out + c0 * t_out**2
      CALL IfW_Input_ExtrapInterp( u%IfW_Inputs, tin, u_out%IfW_Inputs, tin_out, ErrStat, ErrMsg )
IF (ALLOCATED(u_out%MulTabLoc) .AND. ALLOCATED(u(1)%MulTabLoc)) THEN
  ALLOCATE(b2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  ALLOCATE(c2(SIZE(u_out%MulTabLoc,1),SIZE(u_out%MulTabLoc,2) ))
  b2 = (t(3)**2*(u(1)%MulTabLoc - u(2)%MulTabLoc) + t(2)**2*(-u(1)%MulTabLoc + u(3)%MulTabLoc))/(t(2)*t(3)*(t(2) - t(3)))
  c2 = ( (t(2)-t(3))*u(1)%MulTabLoc + t(3)*u(2)%MulTabLoc - t(2)*u(3)%MulTabLoc ) / (t(2)*t(3)*(t(2) - t(3)))
  u_out%MulTabLoc = u(1)%MulTabLoc + b2 * t_out + c2 * t_out**2
  DEALLOCATE(b2)
  DEALLOCATE(c2)
END IF ! check if allocated
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in AD_Input_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE AD_Input_ExtrapInterp


 SUBROUTINE AD_Output_ExtrapInterp(u, tin, u_out, tin_out, ErrStat, ErrMsg )
!
! This subroutine calculates a extrapolated (or interpolated) input u_out at time t_out, from previous/future time
! values of u (which has values associated with times in t).  Order of the interpolation is given by the size of u
!
!  expressions below based on either
!
!  f(t) = a
!  f(t) = a + b * t, or
!  f(t) = a + b * t + c * t**2
!
!  where a, b and c are determined as the solution to
!  f(t1) = u1, f(t2) = u2, f(t3) = u3  (as appropriate)
!
!..................................................................................................................................

 TYPE(AD_outputtype), INTENT(INOUT)  :: u(:)      ! Inputs at t1 > t2 > t3
 REAL(DbKi),         INTENT(IN   )  :: tin(:)      ! Times associated with the inputs
 TYPE(AD_outputtype), INTENT(INOUT)  :: u_out     ! Inputs at tin_out
 REAL(DbKi),         INTENT(IN   )  :: tin_out     ! time to be extrap/interp'd to
 INTEGER(IntKi),     INTENT(  OUT)  :: ErrStat   ! Error status of the operation
 CHARACTER(*),       INTENT(  OUT)  :: ErrMsg    ! Error message if ErrStat /= ErrID_None
   ! local variables
 REAL(DbKi) :: t(SIZE(tin))    ! Times associated with the inputs
 REAL(DbKi) :: t_out           ! Time to which to be extrap/interpd
 INTEGER(IntKi)                 :: order    ! order of polynomial fit (max 2)
 REAL(DbKi)                                 :: b0       ! temporary for extrapolation/interpolation
 REAL(DbKi)                                 :: c0       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: b1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:)        :: c1       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: b2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:)      :: c2       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: b3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:)    :: c3       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: b4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:)  :: c4       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: b5       ! temporary for extrapolation/interpolation
 REAL(DbKi),ALLOCATABLE,DIMENSION(:,:,:,:,:):: c5       ! temporary for extrapolation/interpolation
 INTEGER                                    :: i01    ! dim1 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i11    ! dim1 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i21    ! dim1 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i31    ! dim1 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i41    ! dim1 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i51    ! dim1 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i61    ! dim1 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i71    ! dim1 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i81    ! dim1 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i91    ! dim1 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i02    ! dim2 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i12    ! dim2 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i22    ! dim2 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i32    ! dim2 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i42    ! dim2 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i52    ! dim2 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i62    ! dim2 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i72    ! dim2 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i82    ! dim2 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i92    ! dim2 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i03    ! dim3 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i13    ! dim3 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i23    ! dim3 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i33    ! dim3 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i43    ! dim3 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i53    ! dim3 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i63    ! dim3 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i73    ! dim3 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i83    ! dim3 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i93    ! dim3 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i04    ! dim4 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i14    ! dim4 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i24    ! dim4 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i34    ! dim4 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i44    ! dim4 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i54    ! dim4 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i64    ! dim4 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i74    ! dim4 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i84    ! dim4 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i94    ! dim4 level 9 counter variable for arrays of ddts
 INTEGER                                    :: i05    ! dim5 level 0 counter variable for arrays of ddts
 INTEGER                                    :: i15    ! dim5 level 1 counter variable for arrays of ddts
 INTEGER                                    :: i25    ! dim5 level 2 counter variable for arrays of ddts
 INTEGER                                    :: i35    ! dim5 level 3 counter variable for arrays of ddts
 INTEGER                                    :: i45    ! dim5 level 4 counter variable for arrays of ddts
 INTEGER                                    :: i55    ! dim5 level 5 counter variable for arrays of ddts
 INTEGER                                    :: i65    ! dim5 level 6 counter variable for arrays of ddts
 INTEGER                                    :: i75    ! dim5 level 7 counter variable for arrays of ddts
 INTEGER                                    :: i85    ! dim5 level 8 counter variable for arrays of ddts
 INTEGER                                    :: i95    ! dim5 level 9 counter variable for arrays of ddts
    ! Initialize ErrStat
 ErrStat = ErrID_None
 ErrMsg  = ""
    ! we'll subtract a constant from the times to resolve some 
    ! numerical issues when t gets large (and to simplify the equations)
 t = tin - tin(1)
 t_out = tin_out - tin(1)

 if ( size(t) .ne. size(u)) then
    ErrStat = ErrID_Fatal
    ErrMsg = ' Error in AD_Output_ExtrapInterp: size(t) must equal size(u) '
    RETURN
 endif
 if (size(u) .gt. 3) then
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: size(u) must be less than 4 '
    RETURN
 endif
 order = SIZE(u) - 1
 IF ( order .eq. 0 ) THEN
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshCopy(u(1)%OutputLoads(i01), u_out%OutputLoads(i01), MESH_UPDATECOPY, ErrStat, ErrMsg )
  ENDDO
END IF ! check if allocated
  CALL MeshCopy(u(1)%Twr_OutputLoads, u_out%Twr_OutputLoads, MESH_UPDATECOPY, ErrStat, ErrMsg )
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat, ErrMsg )
 ELSE IF ( order .eq. 1 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshExtrapInterp1(u(1)%OutputLoads(i01), u(2)%OutputLoads(i01), tin, u_out%OutputLoads(i01), tin_out, ErrStat, ErrMsg )
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp1(u(1)%Twr_OutputLoads, u(2)%Twr_OutputLoads, tin, u_out%Twr_OutputLoads, tin_out, ErrStat, ErrMsg )
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat, ErrMsg )
 ELSE IF ( order .eq. 2 ) THEN
  IF ( EqualRealNos( t(1), t(2) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(2) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(2), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(2) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
  IF ( EqualRealNos( t(1), t(3) ) ) THEN
    ErrStat = ErrID_Fatal
    ErrMsg  = ' Error in AD_Output_ExtrapInterp: t(1) must not equal t(3) to avoid a division-by-zero error.'
    RETURN
  END IF
IF (ALLOCATED(u_out%OutputLoads) .AND. ALLOCATED(u(1)%OutputLoads)) THEN
  DO i01 = LBOUND(u_out%OutputLoads,1),UBOUND(u_out%OutputLoads,1)
  CALL MeshExtrapInterp2(u(1)%OutputLoads(i01), u(2)%OutputLoads(i01), u(3)%OutputLoads(i01), tin, u_out%OutputLoads(i01), tin_out, ErrStat, ErrMsg )
  ENDDO
END IF ! check if allocated
  CALL MeshExtrapInterp2(u(1)%Twr_OutputLoads, u(2)%Twr_OutputLoads, u(3)%Twr_OutputLoads, tin, u_out%Twr_OutputLoads, tin_out, ErrStat, ErrMsg )
      CALL IfW_Output_ExtrapInterp( u%IfW_Outputs, tin, u_out%IfW_Outputs, tin_out, ErrStat, ErrMsg )
 ELSE 
   ErrStat = ErrID_Fatal
   ErrMsg = ' order must be less than 3 in AD_Output_ExtrapInterp '
   RETURN
 ENDIF 
 END SUBROUTINE AD_Output_ExtrapInterp

END MODULE AeroDyn_Types
!ENDOFREGISTRYGENERATEDFILE
